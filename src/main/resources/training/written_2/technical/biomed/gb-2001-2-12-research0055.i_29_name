
  
    
      
        Background
        Affymetrix oligonucleotide arrays (referred to here as
        oligonucleotide arrays) are widely used to measure the
        abundance of <ENAMEX TYPE="DISEASE">mRNA</ENAMEX> molecules in biological samples [ <ENAMEX TYPE="LAW">1</ENAMEX>]. The
        investigator isolates total and/or <ENAMEX TYPE="SUBSTANCE">polyadenylated RNA</ENAMEX> from
        cells or tissues, generates the corresponding complementary
        <ENAMEX TYPE="PERSON">DNA (</ENAMEX>cDNA), <ENAMEX TYPE="SUBSTANCE">transcribes complementary RNA</ENAMEX> (cRNA) from the
        cDNA template, and then hybridizes the cRNA to the array [
        <NUMEX TYPE="CARDINAL">2</NUMEX>]. There is a significant amount of assay noise associated
        with readouts from oligonucleotide arrays (for example [ <ENAMEX TYPE="CONTACT_INFO">3,</ENAMEX>
        <NUMEX TYPE="CARDINAL">4</NUMEX>]). For these arrays we have found <ENAMEX TYPE="SUBSTANCE">additive</ENAMEX> and
        multiplicative noise affecting individual gene readouts
        (typically <NUMEX TYPE="PERCENT">5-20%</NUMEX>), as well as multiplicative noise
        affecting entire arrays (often <NUMEX TYPE="PERCENT">above 20%</NUMEX>). As defined here,
        normalization attempts to correct for only the latter type
        of noise. The primary sources of this array-level noise are
        between-array variation in overall performance (due to
        inconsistencies in array fabrication, staining and
        <ENAMEX TYPE="ORGANIZATION">scanning</ENAMEX>), and <NUMEX TYPE="CARDINAL">between-cRNA</NUMEX> variation (as independently
        prepared cRNAs have variable purity and/or
        fluorescently-labeled mass fractions). Because these
        <ENAMEX TYPE="PER_DESC">sources</ENAMEX> of variation contribute so significantly to array
        readouts, normalization is a critical <NUMEX TYPE="ORDINAL">first</NUMEX> step in any
        analysis of gene expression data.
        Most current normalization procedures for
        oligonucleotide arrays are global approaches, based on
        normalization of the overall mean or median array intensity
        to a common standard (for example [ <ENAMEX TYPE="LAW">5, 6, 7</ENAMEX>]). Spiked
        standards have also been used to normalize cDNA [ <ENAMEX TYPE="LAW">8</ENAMEX>] and
        <ENAMEX TYPE="ORGANIZATION">oligonucleotide</ENAMEX> [ <ENAMEX TYPE="LAW">9, 10, 11</ENAMEX>] <ENAMEX TYPE="PRODUCT_DESC">arrays</ENAMEX>. All these techniques
        are inherently linear; there have been recent reports of
        nonlinear normalizations for cDNA [ <TIMEX TYPE="DATE">12</TIMEX>], oligonucleotide [
        <TIMEX TYPE="DATE">13, 14</TIMEX>] and other [ <TIMEX TYPE="DATE">15</TIMEX>] <ENAMEX TYPE="PRODUCT_DESC">arrays</ENAMEX>. Few detailed comparisons of
        oligonucleotide-array normalization procedures have been
        reported, however [ <TIMEX TYPE="DATE">13</TIMEX>].
        For oligonucleotide arrays, the normalization
        implemented in the <ENAMEX TYPE="PRODUCT">Affymetrix GeneChipâ„¢</ENAMEX> software
        (<ENAMEX TYPE="ORGANIZATION">Affymetrix</ENAMEX>, <ENAMEX TYPE="GPE">Santa Clara</ENAMEX>, CA) is by far the most commonly
        used (for example [ <ENAMEX TYPE="LAW">1, 16</ENAMEX>]). In this approach, the mean
        hybridization intensities (the 'average differences' (<ENAMEX TYPE="ORGANIZATION">AD</ENAMEX>))
        of all <ENAMEX TYPE="PRODUCT_DESC">probe sets</ENAMEX> on each array are scaled to an arbitrary,
        fixed level [ <TIMEX TYPE="DATE">17</TIMEX>]. In the rest of this <ENAMEX TYPE="ORG_DESC">paper</ENAMEX>, we refer to
        this procedure as 'global <ENAMEX TYPE="PER_DESC">normalization</ENAMEX>' or scaled average
        difference (AD s). In practice, there are at least three
        limitations to this method. Of these, the <NUMEX TYPE="ORDINAL">first</NUMEX> <NUMEX TYPE="CARDINAL">two</NUMEX> relate
        to the normalization itself, and the last relates to the
        practical utility of the normalized readouts.
        First, global normalization makes no attempt to
        absolutely quantify mRNA abundances. Readouts are
        <ENAMEX TYPE="ORGANIZATION">normalized</ENAMEX> to an arbitrary scale, which may vary from one
        <ENAMEX TYPE="PER_DESC">operator</ENAMEX> to another or between experiments. In contrast,
        previous experiments with spiked controls [ <ENAMEX TYPE="LAW">1</ENAMEX>] and
        comparisons with serial analysis of gene expression (<ENAMEX TYPE="ORGANIZATION">SAGE</ENAMEX>)
        [ <TIMEX TYPE="DATE">18</TIMEX>] have shown that array response can be proportional to
        true transcript abundance, suggesting that absolute
        quantitation of transcripts is feasible. If sufficiently
        accurate, such an absolute scale for all array readouts
        could facilitate comparisons across large, diverse gene
        expression databases.
        <NUMEX TYPE="ORDINAL">Second</NUMEX>, global normalization implicitly assumes that the
        mean expression level of all monitored mRNAs is constant.
        The validity of this assumption depends on the number and
        biological characteristics of genes monitored by an array.
        For smaller arrays that monitor a limited set of mRNAs,
        this assumption is invalid and may result in erroneous
        <ENAMEX TYPE="ORGANIZATION">normalization</ENAMEX>. Ideally, a quantitation method for arrays
        would be effective even in cases where this 'constant mean'
        <ENAMEX TYPE="ORGANIZATION">hypothesis</ENAMEX> does not hold.
        <NUMEX TYPE="ORDINAL">Third</NUMEX>, as typically applied, global normalization does
        not deal well with transcripts expressed at low copy
        numbers. In a typical Affymetrix GeneChip assay, many
        low-abundance transcripts are present at levels below the
        sensitivity of detection of the array (typically about
        <NUMEX TYPE="CARDINAL">1</NUMEX>:100,000 mRNAs). Measurements for such mRNAs are not only
        noisy but are sometimes negative, due to
        <ENAMEX TYPE="ORGANIZATION">cross</ENAMEX>-hybridization to mismatch probes [ <ENAMEX TYPE="LAW">1</ENAMEX>]. Negative
        intensity values are meaningless and problematic because
        they cannot be log-transformed, a manipulation that is a
        common prelude to downstream analysis of array data. Simply
        discarding negative values is objectionable as it can lead
        to missed observations of biologically significant
        <ENAMEX TYPE="ORGANIZATION">upregulation</ENAMEX>. An automated normalization method that
        handles noisy and negative measurements and responds to
        variable array sensitivity is desirable, especially in a
        high-throughput setting.
        The primary criterion for any alternative to global
        <ENAMEX TYPE="ORGANIZATION">normalization</ENAMEX> is that it should expand the <ENAMEX TYPE="PER_DESC">investigator</ENAMEX>'s
        ability to compare diverse array experiments done at
        different times in different <ENAMEX TYPE="FAC_DESC">laboratories</ENAMEX>. In this <ENAMEX TYPE="ORG_DESC">paper</ENAMEX>,
        we describe alternative procedures that seek to quantitate
        array results in terms of transcripts per unit cRNA. We
        chose cRNA quantitation because it meets the primary
        <ENAMEX TYPE="PERSON">criterion</ENAMEX>, and for several additional reasons.
        First, cRNA quantitation is easily applied to array
        experiments using small amounts of starting total <ENAMEX TYPE="SUBSTANCE">RNA</ENAMEX> that
        are difficult to quantitate accurately. <NUMEX TYPE="ORDINAL">Second</NUMEX>, the spike
        <ENAMEX TYPE="ORGANIZATION">reagents</ENAMEX> described here for cRNA quantitation can be used
        to specifically monitor the performance of individual
        <ENAMEX TYPE="ORGANIZATION">arrays</ENAMEX>. <NUMEX TYPE="ORDINAL">Third</NUMEX>, in our experience, the reproducibility,
        accuracy and scientific value of cRNA quantitation are at
        least as good as those of alternative techniques, such as
        procedures to quantitate transcripts per <ENAMEX TYPE="FAC_DESC">cell</ENAMEX>, transcripts
        per mass of input material, transcripts per total <ENAMEX TYPE="SUBSTANCE">RNA</ENAMEX> or
        transcripts per polyadenylated <ENAMEX TYPE="SUBSTANCE">RNA</ENAMEX>.
        We evaluated <NUMEX TYPE="CARDINAL">two</NUMEX> alternatives to the standard global
        <ENAMEX TYPE="PERSON">normalization</ENAMEX> scheme which we term 'frequency' (<ENAMEX TYPE="PRODUCT">F</ENAMEX>) and
        'scaled frequency' (F s) normalization. These normalization
        procedures are based on the presence of a common pool of
        biotin-labeled transcripts of known concentrations spiked
        into each hybridization. Constructs for generating the
        <ENAMEX TYPE="ORGANIZATION">control</ENAMEX> <ENAMEX TYPE="ORG_DESC">reagents</ENAMEX> are available through the <ENAMEX TYPE="ORGANIZATION">American Type</ENAMEX>
        <ENAMEX TYPE="PRODUCT">Culture Collection</ENAMEX> (ATCC); accession numbers are given in
        <ENAMEX TYPE="PRODUCT">Table 1</ENAMEX>. We describe how scaled frequency normalization can
        be used to estimate message abundance in cRNA, compute a
        chip sensitivity metric and provide a natural scale for
        damping spurious signals from below-sensitivity mRNAs.
        Using previously published replicated experimental
        <ENAMEX TYPE="ORGANIZATION">hybridizations</ENAMEX> and new simulated data, we compare the
        <ENAMEX TYPE="ORGANIZATION">reproducibility</ENAMEX> and accuracy of frequency, scaled frequency
        and global normalization. Our results suggest that scaled
        frequency normalization is a useful strategy for
        oligonucleotide array data and has important advantages
        over current approaches.
      
      
        Results and discussion
        
          The constant-mean assumption
          A key assumption underlying global normalization is
          that the mean expression level on an array should be the
          same for all samples and all arrays. This assumption is
          distinct from the additional implicit assumption that the
          fraction of polyadenylated mRNA per total <ENAMEX TYPE="SUBSTANCE">RNA</ENAMEX> is
          <ENAMEX TYPE="PERSON">constant</ENAMEX>. One can certainly construct special cases where
          the constant-mean assumption is invalid. <NUMEX TYPE="CARDINAL">One</NUMEX> example
          would be using a small array containing only <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> from a
          single pathway in an experiment that studies variable
          induction of that pathway. However, it is unclear how
          well even more general array experiments satisfy this
          assumption.
          To evaluate the constant-mean assumption we examined
          the coefficient of variation (CV) of the mean expression
          level of variable-sized mRNA sets across samples covering
          widely divergent developmental stages of the nematode 
          Caenorhabditis elegans. We
          constructed the largest possible subset of our data that
          included only matched triplets of the <ENAMEX TYPE="ORGANIZATION">A</ENAMEX>, B and C array
          designs (see <ENAMEX TYPE="PRODUCT">Materials</ENAMEX> and methods). The subset comprised
          <ENAMEX TYPE="PRODUCT">39</ENAMEX> chip hybridzations, <NUMEX TYPE="CARDINAL">13</NUMEX> of each design, covering all
          developmental stages. This dataset represents a
          relatively strong test of the constant mean assumption,
          because very large biological modulation of many mRNAs
          occurs across the dataset. As the 
          <ENAMEX TYPE="ORGANIZATION">C.</ENAMEX> elegans arrays monitor around
          <NUMEX TYPE="PERCENT">98%</NUMEX> of all predicted 
          <ENAMEX TYPE="ORGANIZATION">C.</ENAMEX> elegans mRNAs, and the sum of
          the relative expression levels of all expressed genes
          must be constant by definition, global normalization is
          well justified for the dataset as a whole. Thus, the <NUMEX TYPE="CARDINAL">13</NUMEX>
          experimental hybridizations of each array design were
          globally normalized, and subsets of the <NUMEX TYPE="CARDINAL">19,031</NUMEX> total
          <ENAMEX TYPE="PER_DESC">mRNAs</ENAMEX> monitored by the arrays were selected at random.
          For each subset, the <ENAMEX TYPE="ORGANIZATION">CV</ENAMEX> of the mean expression level of
          the subset across all <NUMEX TYPE="CARDINAL">13</NUMEX> hybridizations was computed.
          <ENAMEX TYPE="SUBSTANCE">Subsets</ENAMEX> ranged in size from <NUMEX TYPE="CARDINAL">10 to 19,031</NUMEX> <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> (<NUMEX TYPE="PERCENT">0.05%</NUMEX> to
          <NUMEX TYPE="PERCENT">100%</NUMEX> of this transcriptome) (Figure <NUMEX TYPE="CARDINAL">1</NUMEX>). The <ENAMEX TYPE="ORGANIZATION">CV</ENAMEX> of the
          mean expression level is below <NUMEX TYPE="PERCENT">7%</NUMEX> for any set of mRNAs
          larger than <NUMEX TYPE="PERCENT">roughly 10%</NUMEX> of the total. As this <ENAMEX TYPE="ORGANIZATION">CV</ENAMEX> is no
          larger than the typical contribution of other noise
          <ENAMEX TYPE="PER_DESC">sources</ENAMEX> in the readout, we conclude that the
          constant-mean assumption can be supported for arrays that
          monitor on the order of <NUMEX TYPE="PERCENT">20-100%</NUMEX> of a transcriptome. This
          is typical of current commercial arrays for several
          <ENAMEX TYPE="SUBSTANCE">bacteria</ENAMEX>, <ENAMEX TYPE="SUBSTANCE">yeast</ENAMEX>, <ENAMEX TYPE="ANIMAL">mouse</ENAMEX> and human.
          These results only apply when genes monitored by an
          array are randomly selected with respect to their
          expression characteristics. The example noted above (all
          genes on an array from a single pathway) is an extreme
          case of <ENAMEX TYPE="SUBSTANCE">nonrandom</ENAMEX> selection. Other common ways of
          <ENAMEX TYPE="SUBSTANCE">selecting genes</ENAMEX> for arrays may also violate this
          assumption, including selection based on matches in
          specific cDNA <ENAMEX TYPE="ORG_DESC">libraries</ENAMEX>.
          <ENAMEX TYPE="SUBSTANCE">Nonrandom</ENAMEX> selection of even large mRNA sets for
          individual <ENAMEX TYPE="PER_DESC">arrays</ENAMEX> can also lead to <NUMEX TYPE="CARDINAL">between</NUMEX>-array
          inconsistencies in mean expression level. For example,
          consider the case of <NUMEX TYPE="CARDINAL">two</NUMEX> arrays, each monitoring a large,
          equal percentage (> <NUMEX TYPE="PERCENT">20%</NUMEX>) of a transcriptome, where the
          <NUMEX TYPE="ORDINAL">first</NUMEX> array monitors mRNAs with confirmed cDNA library
          matches, and the other array <ENAMEX TYPE="PER_DESC">monitors mRNAs</ENAMEX> whose
          sequences are based on lower-quality expressed sequence
          <ENAMEX TYPE="PERSON">tag</ENAMEX> (<TIMEX TYPE="TIME">EST</TIMEX>) sequence matches or computational gene
          predictions. While the constant mean assumption is
          justified for each array in isolation, comparison of
          globally normalized expression levels between the two
          <ENAMEX TYPE="ORGANIZATION">arrays</ENAMEX> will give erroneous results because the mean
          expression level of transcripts on the first array is
          higher than that on the <NUMEX TYPE="ORDINAL">second</NUMEX>.
        
        
          <ENAMEX TYPE="PERSON">Spike</ENAMEX>-in based normalization
          The limitations of global normalization suggest the
          use of spiked transcripts to normalize array data. Our
          <ENAMEX TYPE="PER_DESC">'spike</ENAMEX>-in' normalization method, which we call 'frequency
          <ENAMEX TYPE="ORGANIZATION">normalization'</ENAMEX>, uses spiked transcripts for <NUMEX TYPE="CARDINAL">two</NUMEX> purposes.
          First, they allow us to calibrate the arrays,
          <ENAMEX TYPE="ORGANIZATION">transforming AD</ENAMEX> to cRNA frequency (<ENAMEX TYPE="PRODUCT">F</ENAMEX>) estimates quoted in
          transcripts per <NUMEX TYPE="CARDINAL">million</NUMEX>. <NUMEX TYPE="ORDINAL">Second</NUMEX>, the spiked transcripts
          enable us to estimate the minimum detectable frequency on
          the array (the 'array sensitivity' value). The array
          <ENAMEX TYPE="PERSON">sensitivity</ENAMEX> is useful as a quality-control metric for
          individual <ENAMEX TYPE="PER_DESC">hybridizations</ENAMEX> and is also used to adjust
          signals from low-level transcripts. Specifically,
          frequency values below the array sensitivity are averaged
          with the sensitivity estimate to generate 'damped'
          frequencies that lie <NUMEX TYPE="PERCENT">between 50% and 100%</NUMEX> of the array
          sensitivity. This adjustment introduces a small
          systematic error into the damped data, but in return it
          eliminates problematic negative values and retains
          low-level readings that can be biologically informative
          in the context of additional experiments.
          Figure 2shows a typical plot of the spiked transcript
          readout from a single hybridization containing <NUMEX TYPE="QUANTITY">2 Î¼g</NUMEX> of
          <ENAMEX TYPE="ORGANIZATION">cRNA</ENAMEX> and a corresponding amount of <ENAMEX TYPE="PER_DESC">spike</ENAMEX>-in transcripts.
          The specific hybridization intensity (<ENAMEX TYPE="ORGANIZATION">AD</ENAMEX>) value for each
          of the <NUMEX TYPE="CARDINAL">11</NUMEX> <ENAMEX TYPE="PER_DESC">spike</ENAMEX>-in controls is plotted as a function of
          transcript frequency in units of transcripts per <NUMEX TYPE="CARDINAL">million</NUMEX>.
          The points are fitted with a generalized linear model
          that is then used as a calibration curve to compute
          frequencies from the <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX> values of the other <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> on the
          array. Using logistic regression, we define the chip
          sensitivity as the frequency where we estimate a gene to
          have a <NUMEX TYPE="PERCENT">70%</NUMEX> probability of being called <ENAMEX TYPE="FAC">'Present'</ENAMEX>. We will
          use the capitalized terms <ENAMEX TYPE="WORK_OF_ART">'Absolute Decision', 'Present'</ENAMEX>,
          <ENAMEX TYPE="ORGANIZATION">'Absent</ENAMEX>' and 'Marginal' when referring to a specific
          value that is calculated by the <ENAMEX TYPE="NATIONALITY">Affymetrix</ENAMEX> GeneChip
          software (described in <ENAMEX TYPE="PRODUCT">Materials</ENAMEX> and methods). In Figure
          <NUMEX TYPE="CARDINAL">2</NUMEX>, the vertical line at a frequency of <NUMEX TYPE="CARDINAL">4.5</NUMEX> indicates the
          computed sensitivity estimate for this array.
          Fitting a power law model (<ENAMEX TYPE="ORGANIZATION">AD</ENAMEX> = k 
          F 
          <ENAMEX TYPE="ORGANIZATION">n</ENAMEX> ) to the data in Figure 2yields
          the exponent 
          <ENAMEX TYPE="ORGANIZATION">n</ENAMEX> = <NUMEX TYPE="CARDINAL">0.93</NUMEX>. This indicates mild
          <ENAMEX TYPE="ORGANIZATION">curvature</ENAMEX> in the response, consistent with progressive
          saturation of array readout for the highest abundance
          <ENAMEX TYPE="ORGANIZATION">mRNAs</ENAMEX>. Experiments using <NUMEX TYPE="CARDINAL">0.1 to 10</NUMEX> Î¼g cRNA per
          hybridization with corresponding amounts of <ENAMEX TYPE="PER_DESC">spike</ENAMEX>-in
          <ENAMEX TYPE="PERSON">transcripts</ENAMEX>, as well as high and low gain settings on the
          <ENAMEX TYPE="ORGANIZATION">scanner</ENAMEX>, indicated that readout saturation (not
          hybridization saturation) accounted for most of the
          observed curvature in the <ENAMEX TYPE="PER_DESC">spike</ENAMEX>-in response. The use of
          <NUMEX TYPE="PERCENT">approximately</NUMEX> <TIMEX TYPE="DATE">1 Î</TIMEX>¼g cRNA in each hybridization, or reduced
          <ENAMEX TYPE="ORGANIZATION">scanner</ENAMEX> gain, largely eliminated saturation with no
          penalty in sensitivity.
        
        
          Scaled frequency normalization
          Frequency normalization is appealing theoretically and
          effective even when the constant-mean assumption is known
          to be invalid. However, our experience suggests that
          frequency estimates might be biased by experimental
          limitations on the accuracy with which control
          transcripts can be spiked into cRNA. Specifically,
          because of the combination of small fluid-handling
          uncertainties and potentially larger variation in the
          purity of cRNA preparations, the actual ratio of the
          spiked transcripts to cDNA-<NUMEX TYPE="CARDINAL">template</NUMEX>-derived cRNAs might
          be significantly skewed from one array to another. One
          source of variable impurities in cRNA preparations could
          be oligo(dT)-primer-dependent cRNA product [ <TIMEX TYPE="DATE">19</TIMEX>]. Such
          cRNA impurities would result in erroneous normalization
          in which all readouts from one array would be
          systematically higher or lower than those from another
          array. We use the term 'spike-<ENAMEX TYPE="PER_DESC">skew</ENAMEX>' to denote this
          multiplicative skew in frequency values among multiple
          <ENAMEX TYPE="ORGANIZATION">hybridizations</ENAMEX>. <NUMEX TYPE="CARDINAL">One</NUMEX> expected symptom of <ENAMEX TYPE="PERSON">spike-skew would</ENAMEX>
          be replicate hybridization readouts that are highly
          correlated but have widely divergent mean expression
          levels.
          We developed the hybrid scaled frequency (F s)
          normalization method to mitigate the effects of
          <ENAMEX TYPE="PERSON">spike</ENAMEX>-skew. F snormalization is based on the principle of
          removing technical variation in the ratio of spiked
          transcripts to cDNA-<NUMEX TYPE="CARDINAL">template</NUMEX>-derived cRNAs, by averaging
          the response to spiked cRNAs over multiple
          <ENAMEX TYPE="ORGANIZATION">hybridizations</ENAMEX>. To compute F svalues, globally scaled
          average differences are first computed for all arrays in
          a set. This initial step implicitly makes the
          constant-mean assumption. A calibration function is then
          computed by fitting a single <ENAMEX TYPE="PRODUCT_DESC">linear model</ENAMEX> to the scaled
          average differences of all spiked cRNAs on all the arrays
          in the dataset, pooled together. Individual array
          sensitivities are still computed as described above, and
          the same damping of low-end frequencies is carried out
          using the sensitivity values for each array.
          To compare F and <ENAMEX TYPE="PRODUCT">F</ENAMEX> smetrics, consider an experimental
          set of <NUMEX TYPE="CARDINAL">ten</NUMEX> arrays. To compute F values, <NUMEX TYPE="CARDINAL">ten</NUMEX> linear models
          are fitted to the <NUMEX TYPE="CARDINAL">ten</NUMEX> distinct, unscaled AD responses to
          the spiked cRNAs, yielding <NUMEX TYPE="CARDINAL">ten</NUMEX> different calibration
          factors, one for each array. In contrast, when computing
          F svalues, a single <ENAMEX TYPE="PRODUCT_DESC">linear model</ENAMEX> is fitted to the pooled
          spike response curve consisting of <NUMEX TYPE="CARDINAL">10</NUMEX> Ã— <TIMEX TYPE="DATE">11</TIMEX>= <NUMEX TYPE="CARDINAL">121</NUMEX> globally
          scaled AD values, and a single calibration factor
          generated for all <NUMEX TYPE="CARDINAL">ten</NUMEX> arrays. If there was no technical
          variation in the ratio of spiked transcripts to
          cDNA-<NUMEX TYPE="CARDINAL">template</NUMEX>-derived cRNAs in the <NUMEX TYPE="CARDINAL">ten</NUMEX> experiments, both
          approaches would give the same quantitation, up to a
          <ENAMEX TYPE="ORGANIZATION">random</ENAMEX> error term arising from the difference between
          fitting <NUMEX TYPE="CARDINAL">ten 11-point</NUMEX> responses versus a single <NUMEX TYPE="CARDINAL">121</NUMEX>-point
          response. If, in one of the <NUMEX TYPE="CARDINAL">ten</NUMEX> arrays, the ratio of
          spiked transcripts to cDNA-<NUMEX TYPE="CARDINAL">template</NUMEX>-derived cRNAs is
          different for technical reasons, then spike response for
          that array will be skewed, and the <ENAMEX TYPE="PRODUCT">F-</ENAMEX>metric readout for
          that array will be skewed relative to the other <NUMEX TYPE="CARDINAL">nine</NUMEX>
          <ENAMEX TYPE="ORGANIZATION">arrays</ENAMEX>. In contrast, such a skewed array will only affect
          the F smetric to the extent that the single skewed
          response shifts the fit to the pooled spike response. The
          skew for the single problematic array will be removed
          because all arrays in the <ENAMEX TYPE="FAC_DESC">set</ENAMEX> will be scaled and
          calibrated with a single factor. In other words, F
          svalues are estimates of transcript abundance in cRNA,
          based on the average response to the spiked cRNAs over
          <ENAMEX TYPE="DISEASE">multiple hybridizations</ENAMEX> and on the sensitivity of each
          individual array. F values provide the same estimate, but
          based solely on the response to spiked cRNAs in a single
          array hybridization.
        
        
          Comparison of normalization methods:
          reproducibility
          We compared the performance of <NUMEX TYPE="CARDINAL">four</NUMEX> metrics: <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX>;
          globally normalized <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX> (AD s); frequency (<ENAMEX TYPE="PRODUCT">F</ENAMEX>); and scaled
          <ENAMEX TYPE="PERSON">frequency</ENAMEX> (F s). The basis for comparison was
          experimental data consisting of <NUMEX TYPE="CARDINAL">four</NUMEX> sets of replicated
          <ENAMEX TYPE="ORGANIZATION">hybridizations</ENAMEX> (each 
          <ENAMEX TYPE="ORGANIZATION">n</ENAMEX> = <NUMEX TYPE="CARDINAL">3</NUMEX> or <NUMEX TYPE="MONEY">4</NUMEX>) of the same array
          design (the 
          <ENAMEX TYPE="ORGANIZATION">C.</ENAMEX> elegans A array). Performance of
          each metric was measured by the median absolute
          coefficient of variation (MEDACV) of <ENAMEX TYPE="PRODUCT_DESC">probe sets</ENAMEX> across
          the replicated hybridizations. <ENAMEX TYPE="ORGANIZATION">MEDACV</ENAMEX> is a measure of
          reproducibility for which a value of <NUMEX TYPE="CARDINAL">zero</NUMEX> indicates
          perfect agreement of all transcript readouts in a set of
          replicated hybridizations. We compared <ENAMEX TYPE="ORGANIZATION">MEDACV</ENAMEX> for <TIMEX TYPE="TIME">two</TIMEX>
          classes of mRNAs: those called Present in <NUMEX TYPE="PERCENT">at least 50%</NUMEX> of
          replicated hybridizations (referred to as 'Present'
          <ENAMEX TYPE="ORGANIZATION">mRNAs</ENAMEX>), and those Present in <NUMEX TYPE="PERCENT">fewer than 50%</NUMEX> of the
          replicated hybridizations (referred to as 'Absent'
          <ENAMEX TYPE="ORGANIZATION">mRNAs</ENAMEX>). All metrics showed higher (worse) <ENAMEX TYPE="ORGANIZATION">MEDACVs</ENAMEX> for the
          <ENAMEX TYPE="PERSON">low-abundance Absent</ENAMEX> mRNAs than for the higher-abundance
          Present mRNAs (Figure <NUMEX TYPE="CARDINAL">3</NUMEX>), as expected from the presence
          of background noise on the arrays. For Present genes, <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX>
          swas more reproducible than AD, as expected. Scaled
          <ENAMEX TYPE="PERSON">frequency</ENAMEX> (F s) was as reproducible as AD sfor Present
          genes in all replicate sets, and yielded trivially higher
          reproducibility than <ENAMEX TYPE="ANIMAL">AD sfor Absent mRNAs</ENAMEX>, owing to
          damping of background noise. Frequency appeared
          equivalent to F sand AD sin the <NUMEX TYPE="ORDINAL">first</NUMEX> set of experiments
          (<TIMEX TYPE="TIME">the 0-hour</TIMEX> <TIMEX TYPE="DATE">timepoint</TIMEX>) but had a higher MEDACV than F sin
          the other <NUMEX TYPE="CARDINAL">three</NUMEX> replicate sets. We also computed <ENAMEX TYPE="ORGANIZATION">Pearson</ENAMEX>
          correlation coefficients for the same replicate readouts.
          Unlike <ENAMEX TYPE="ORGANIZATION">MEDACV</ENAMEX>, correlation coefficients between replicate
          readouts were similar for all metrics (in the range from
          <NUMEX TYPE="CARDINAL">0.978</NUMEX>-<NUMEX TYPE="CARDINAL">0.996</NUMEX>).
          To better understand the reasons for the markedly
          different MEDACV performances of the <NUMEX TYPE="CARDINAL">four</NUMEX> metrics on
          experimental <ENAMEX TYPE="SUBSTANCE">replicates</ENAMEX>, we performed simulations. These
          simulations incorporated several adjustable noise
          parameters. We estimated values for these parameters
          iteratively, based on experimental data (see Materials
          and methods). The similarity in the CV distributions of
          experimental and simulated data indicated that, for our
          purposes, the simulations recapitulated the major error
          properties of real array data (Figure <NUMEX TYPE="CARDINAL">4</NUMEX>).
          We tested if spike-skew could account for the
          relatively high CV of frequency in <NUMEX TYPE="CARDINAL">three</NUMEX> of the <NUMEX TYPE="CARDINAL">four</NUMEX>
          replicate sets (Figure <NUMEX TYPE="CARDINAL">3</NUMEX>) by comparing experimental data
          to simulated data with known levels of <NUMEX TYPE="QUANTITY">spike-skew</NUMEX>. To
          <ENAMEX TYPE="PERSON">approximate spike-skew</ENAMEX>, the concentration of the <ENAMEX TYPE="PER_DESC">spike</ENAMEX>-in
          transcripts in simulations was multiplied by a random
          noise term. Over a series of simulations, we varied the
          standard deviation of the noise term from <NUMEX TYPE="PERCENT">0 to 40%</NUMEX> to
          model the effect of increasing spike-skew. <ENAMEX TYPE="ORGANIZATION">MEDACV</ENAMEX> values
          were then computed from the simulation results in the
          same way as for the experimental data in Figure <NUMEX TYPE="CARDINAL">3</NUMEX>.
          As expected, only frequency was sensitive to
          <ENAMEX TYPE="PERSON">spike-skew</ENAMEX> (Figure <NUMEX TYPE="CARDINAL">5</NUMEX>). The F smetric, which uses a single
          standard curve pooled from each dataset to normalize all
          <ENAMEX TYPE="ORGANIZATION">arrays</ENAMEX> in that dataset, effectively eliminated spike-skew
          effects. In the simulations, a spike-skew level of <NUMEX TYPE="PERCENT">20%</NUMEX>
          led to <ENAMEX TYPE="ORGANIZATION">MEDACV</ENAMEX> values for frequency in simulated
          replicates that were much higher than those of AD sor F
          <ENAMEX TYPE="PERSON">s.</ENAMEX> These results were highly reminiscent of the <NUMEX TYPE="CARDINAL">36</NUMEX>, <NUMEX TYPE="CARDINAL">48</NUMEX>
          and <TIMEX TYPE="TIME">60 hour</TIMEX> experimental replicate sets (compare Figures
          5and <NUMEX TYPE="CARDINAL">3</NUMEX>).
          Taken together, the experimental data and the
          simulations suggest that spike-skews of <NUMEX TYPE="PERCENT">roughly 20%</NUMEX> can
          explain the sometimes inferior <ENAMEX TYPE="ORGANIZATION">MEDACV</ENAMEX> (but consistently
          high inter-replicate correlation coefficients) of the
          frequency metric.
        
        
          Comparisons across array designs
          We next considered the reproducibility of readouts of
          the same mRNA on different array designs. For this
          analysis, we selected the <NUMEX TYPE="CARDINAL">three</NUMEX> mRNAs that were monitored
          by identical probe sets on each of the <ENAMEX TYPE="ORGANIZATION">A</ENAMEX>, B, and C array
          designs and were called Present in all hybridizations of
          the <TIMEX TYPE="TIME">0 hour</TIMEX> cRNA sample. The observed <ENAMEX TYPE="ORGANIZATION">CV of the AD</ENAMEX> smetric
          was in all cases larger than that of the <ENAMEX TYPE="PRODUCT">F</ENAMEX> or F smetric,
          and was greater than <NUMEX TYPE="MONEY">0.55</NUMEX> for <NUMEX TYPE="CARDINAL">all three</NUMEX> mRNAs, indicating
          very poor agreement of readouts from different array
          designs when global normalization was used (Figure <NUMEX TYPE="CARDINAL">6</NUMEX>). In
          contrast, the <ENAMEX TYPE="ORGANIZATION">CVs</ENAMEX> of both F and <ENAMEX TYPE="PRODUCT">F</ENAMEX> <ENAMEX TYPE="PRODUCT_DESC">smetrics</ENAMEX> were lower,
          with <ENAMEX TYPE="ORGANIZATION">CVs</ENAMEX> for F sin particular averaging <NUMEX TYPE="CARDINAL">0.19</NUMEX> (range
          <NUMEX TYPE="CARDINAL">0.13</NUMEX>-<NUMEX TYPE="CARDINAL">0.29</NUMEX>). The mRNA <ENAMEX TYPE="PRODUCT">K11C4.5</ENAMEX> was expressed at >
          <NUMEX TYPE="CARDINAL">10-fold</NUMEX> lower levels than either of the other <NUMEX TYPE="CARDINAL">two</NUMEX> mRNAs,
          and thus had higher <ENAMEX TYPE="ORGANIZATION">CV</ENAMEX> values for both F and <ENAMEX TYPE="PRODUCT">F</ENAMEX> sthan the
          other <NUMEX TYPE="CARDINAL">two</NUMEX> mRNAs. Comparison of the across-array-design
          <ENAMEX TYPE="ORGANIZATION">CVs</ENAMEX> to the within-array-design CVs for the three
          transcripts in Figure <TIMEX TYPE="DATE">6indicates</TIMEX> that the reproducibility
          of AD swas substantially poorer when comparing across
          array designs rather than within <TIMEX TYPE="DATE">arrays</TIMEX>. Specifically, <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX>
          sacross-array <ENAMEX TYPE="ORGANIZATION">CV</ENAMEX> was <NUMEX TYPE="CARDINAL">3.2- to 6.4</NUMEX>-fold higher than the
          within-array <ENAMEX TYPE="ORGANIZATION">CV</ENAMEX>. In contrast, the across-array <ENAMEX TYPE="ORGANIZATION">CV</ENAMEX> for F
          swas <NUMEX TYPE="CARDINAL">only 1.3- to 1.6</NUMEX>-fold higher than the corresponding
          within-array <ENAMEX TYPE="ORGANIZATION">CV</ENAMEX> (<ENAMEX TYPE="PRODUCT">Table 2</ENAMEX>).
          The reason for the poor agreement of AD sreadouts
          across distinct designs was that the <ENAMEX TYPE="PER_DESC">mRNAs</ENAMEX> monitored by
          the A array are, on average, expressed at higher levels
          than those on the B or C array, as confirmed by <TIMEX TYPE="TIME">two</TIMEX>
          independent lines of evidence. First, the mRNAs on the <ENAMEX TYPE="ORGANIZATION">A</ENAMEX>
          array were intentionally selected because they were
          represented in 
          <ENAMEX TYPE="ORGANIZATION">C.</ENAMEX> elegans cDNA <ENAMEX TYPE="ORG_DESC">libraries</ENAMEX>, whereas
          the B and C array <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> (many of them computational
          predictions) were generally not represented in cDNA
          <ENAMEX TYPE="PERSON">libraries</ENAMEX>. <NUMEX TYPE="ORDINAL">Second</NUMEX>, A array mRNAs were more likely than B
          or C array mRNAs to be detected in the developmental time
          course by the <ENAMEX TYPE="LAW">Affymetrix Absolute Decision metric [ 10</ENAMEX>].
          Because of this systematic difference between gene sets,
          the mean AD of all A array <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> was substantially higher
          than that of the genes on the B or C arrays. The <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX>
          smetric scales data under the assumption that mean
          expression levels for all arrays should be equal.
          Therefore, AD svalues for <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> on the B and C arrays
          were inappropriately inflated relative to AD svalues from
          the A array.
        
        
          Comparison of normalization methods:
          accuracy
          Normalization methods should accurately measure true
          biological variation. We tested the accuracy of the <NUMEX TYPE="CARDINAL">four</NUMEX>
          methods using simulated data. As a baseline we chose the
          experimental data from one of the <TIMEX TYPE="TIME">0-hour</TIMEX> replicates on
          the A array. We generated <NUMEX TYPE="MONEY">19</NUMEX> simulated experimental
          conditions to produce <NUMEX TYPE="CARDINAL">20</NUMEX> raw average difference values
          for each of <NUMEX TYPE="CARDINAL">6,617</NUMEX> <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX>. For each of the <NUMEX TYPE="CARDINAL">four</NUMEX> metrics,
          <ENAMEX TYPE="PER_DESC">computed</ENAMEX> fold-changes between the modulated condition and
          the baseline (considering only messages called <ENAMEX TYPE="PRODUCT">Present</ENAMEX>)
          were compared to the true fold-changes. Accuracy was
          defined as the fraction of <ENAMEX TYPE="PER_DESC">computed</ENAMEX> fold-changes that
          were accurate within <TIMEX TYPE="DATE">twofold</TIMEX>, and determined for assumed
          levels of <NUMEX TYPE="QUANTITY">spike-skew</NUMEX> from <NUMEX TYPE="PERCENT">10-40%</NUMEX> (percentage is the ratio
          of standard deviation (SD) to mean of the random
          <ENAMEX TYPE="PERSON">spike</ENAMEX>-skew term in the simulation). <NUMEX TYPE="CARDINAL">Three</NUMEX> simulations
          were carried out at each level of assumed spike-skew. <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX>
          sand F smetrics performed equally well and best overall,
          with accuracies above <NUMEX TYPE="PERCENT">99%</NUMEX> regardless of <NUMEX TYPE="QUANTITY">spike-skew</NUMEX>. As
          expected, frequency was the only metric with a
          significant dependence on the level of <NUMEX TYPE="QUANTITY">spike-skew</NUMEX>. At <NUMEX TYPE="PERCENT">10%</NUMEX>
          <ENAMEX TYPE="PERSON">spike-skew</ENAMEX>, frequency accuracy was (mean Â± SD) <NUMEX TYPE="CARDINAL">0.9951</NUMEX> Â±
          <NUMEX TYPE="CARDINAL">0.0006</NUMEX>, at <NUMEX TYPE="PERCENT">20%</NUMEX>, <NUMEX TYPE="MONEY">0.96 Â± 0.02</NUMEX>, and at <NUMEX TYPE="PERCENT">40%</NUMEX>, <NUMEX TYPE="MONEY">0.82 Â± 0.06</NUMEX>. For
          comparison, the accuracy of <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX> was <NUMEX TYPE="MONEY">0.88 Â± 0.07</NUMEX> at <NUMEX TYPE="PERCENT">10%</NUMEX>
          <ENAMEX TYPE="PERSON">spike-skew</ENAMEX>, and did not change significantly at higher
          <ENAMEX TYPE="PERSON">spike</ENAMEX>-skew levels.
          We stress that the overall accuracy levels reported
          here are highly dependent on adjustable parameters in our
          <ENAMEX TYPE="PRODUCT">simulation</ENAMEX> <ENAMEX TYPE="PRODUCT_DESC">model</ENAMEX> (see <ENAMEX TYPE="PRODUCT">Materials</ENAMEX> and methods).
          Nevertheless, the simulations demonstrate that at levels
          of spike-skew consistent with our experience, scaled
          frequency is as accurate as globally normalized AD s;
          this observation is robust to changes in the model
          parameters.
        
        
          Absolute quantitation of cRNA and cellular
          <ENAMEX TYPE="SUBSTANCE">RNA</ENAMEX>
          There are several potential <ENAMEX TYPE="PER_DESC">sources</ENAMEX> of inaccuracy in
          the cRNA quantitiation given by the scaled frequency
          metric.
          Our results suggest that there is significant
          uncertainty in the molar ratio of <ENAMEX TYPE="PER_DESC">spike</ENAMEX>-in mRNAs to
          template-derived cRNAs in any hybridization (the
          <ENAMEX TYPE="PERSON">spike</ENAMEX>-skew effect). The <ENAMEX TYPE="ORGANIZATION">MEDACV</ENAMEX> for the F metric in Figure
          3is likely one measure of this uncertainty, as it
          probably arises primarily from cRNA purity variation.
          This uncertainty leads to proportional differences
          between frequency metric readouts and true cRNA
          transcript abundances. However, in the scaled frequency
          method, the simultaneous normalization of larger datasets
          reduces these differences through averaging. We
          anticipate that inaccuracies of cRNA <ENAMEX TYPE="PER_DESC">quantitation</ENAMEX> arising
          from this effect will be reduced by improved methods for
          quantitation of cRNA preparations.
          For <ENAMEX TYPE="PRODUCT">F</ENAMEX> and F s, heterogeneity in probe response will
          lead to gene-specific biases in quantitation. Our data
          contains <NUMEX TYPE="CARDINAL">two</NUMEX> observations that allow us to estimate the
          degree of heterogeneity among spiked <ENAMEX TYPE="PRODUCT_DESC">probe sets</ENAMEX>. Cursory
          examination of the calibration curve (Figure <NUMEX TYPE="CARDINAL">2</NUMEX>) suggests
          relative responses of the <NUMEX TYPE="CARDINAL">11</NUMEX> distinct probe sets shown do
          not vary <NUMEX TYPE="CARDINAL">more than two</NUMEX>-fold: no observations fall more
          than about a factor of <NUMEX TYPE="CARDINAL">two</NUMEX> from the fitted line. A more
          rigorous evaluation of <ENAMEX TYPE="PRODUCT_DESC">probe</ENAMEX> set heterogeneity can be
          done by comparing the ratio of <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX> values from two
          distinct <ENAMEX TYPE="PRODUCT_DESC">probe sets</ENAMEX> that monitor the same transcript in a
          single hybridization. This ratio estimates the difference
          in readout that would be observed for a single transcript
          if a different <ENAMEX TYPE="PRODUCT_DESC">probe</ENAMEX> set were selected. This comparison
          was made for the <NUMEX TYPE="CARDINAL">11</NUMEX> spiked transcripts (each array
          contained <NUMEX TYPE="CARDINAL">two</NUMEX> <ENAMEX TYPE="PRODUCT_DESC">probe sets</ENAMEX> for each of these mRNAs). On the
          basis of <NUMEX TYPE="CARDINAL">138</NUMEX> ratio measurements from the 
          <ENAMEX TYPE="ORGANIZATION">C.</ENAMEX> elegans arrays, the <NUMEX TYPE="ORDINAL">10th</NUMEX>-90th
          <ENAMEX TYPE="ORGANIZATION">percentile</ENAMEX> range for the ratio was <NUMEX TYPE="CARDINAL">0.39</NUMEX>-<NUMEX TYPE="CARDINAL">1.44</NUMEX> [ <TIMEX TYPE="DATE">10</TIMEX>],
          indicating that for the set of control transcripts, the
          uncertainty in cRNA quantitation due to heterogeneity in
          probe set responses for <NUMEX TYPE="PERCENT">80%</NUMEX> of transcripts was less than
          <ENAMEX TYPE="PERSON">threefold</ENAMEX>.
          In addition to these factors leading to inaccuracies
          in cRNA quantitation, there are <NUMEX TYPE="CARDINAL">at least two</NUMEX> important
          factors leading to differences between cRNA abundances
          and cellular <ENAMEX TYPE="SUBSTANCE">RNA abundances</ENAMEX> in the starting biological
          material.
          First, because cRNA is generated from the
          polyadenylated fraction of total cellular <ENAMEX TYPE="SUBSTANCE">RNA</ENAMEX> by a linear
          amplification process, frequency estimates will not
          reflect sample-specific changes in <TIMEX TYPE="TIME">the fraction of</TIMEX>
          polyadenylated <ENAMEX TYPE="SUBSTANCE">RNA</ENAMEX> in total cellular <ENAMEX TYPE="SUBSTANCE">RNA</ENAMEX>. This may be a
          desirable feature of frequency estimates, in cases where
          per-total-<ENAMEX TYPE="SUBSTANCE">RNA abundance</ENAMEX> is less relevant than
          per-<NUMEX TYPE="CARDINAL">polyadenylated</NUMEX>-<ENAMEX TYPE="SUBSTANCE">RNA abundance</ENAMEX>.
          <NUMEX TYPE="ORDINAL">Second</NUMEX>, any gene-specific biases in the cRNA
          amplification procedure will lead to gene-specific
          differences between cRNA and per-total-<ENAMEX TYPE="SUBSTANCE">RNA</ENAMEX>
          <ENAMEX TYPE="ORGANIZATION">quantifications</ENAMEX>. Evidence to date suggests that these
          biases are small [ <ENAMEX TYPE="LAW">1</ENAMEX>] and reproducible [ <TIMEX TYPE="DATE">19</TIMEX>].
          Taken together, the above-noted <ENAMEX TYPE="PER_DESC">sources</ENAMEX> of inaccuracy
          suggest that there can typically be around <NUMEX TYPE="CARDINAL">two</NUMEX>- to
          threefold differences between scaled frequency per-cRNA
          estimates and <NUMEX TYPE="QUANTITY">per-polyadenylated</NUMEX>-<ENAMEX TYPE="SUBSTANCE">RNA abundances</ENAMEX> in the
          starting material. These differences could be reduced by
          improved cRNA process control and quantitation, and by
          improved probe selection algorithms.
        
      
      
        Conclusions
        We have shown that cRNAs spiked into hybridization
        solutions at known concentrations covering <NUMEX TYPE="CARDINAL">two to three</NUMEX>
        orders of magnitude can be used to normalize array data and
        to estimate array sensitivity. However, frequency
        <ENAMEX TYPE="ORGANIZATION">normalization</ENAMEX> based solely on these control transcripts can
        be adversely affected by variations in the 'purity' of cRNA
        preparations. These observations underline the need for
        meticulous quality control during the production of cRNA
        <ENAMEX TYPE="SUBSTANCE">samples</ENAMEX> and accurate quantitation of the resulting
        material. With better control of these processes, the
        frequency metric may provide a robust spike-based
        normalization that, unlike all the other metrics described
        here, does not rely on the constant-mean assumption.
        In the presence of variation in cRNA purity, the F
        <ENAMEX TYPE="ORGANIZATION">smetric</ENAMEX> provides a compromise between the robustness of the
        AD smetric and the more absolute quantitation scale of the
        frequency metric, in cases where the constant-mean
        assumption is valid. In addition, the <ENAMEX TYPE="PRODUCT">F</ENAMEX> <ENAMEX TYPE="ANIMAL">smetric</ENAMEX> provides a
        common scale for comparing data from distinct array
        designs. This is an important advantage over other metrics.
        For example, the <ENAMEX TYPE="PRODUCT">F</ENAMEX> smetric allows comparison of the
        expression levels of all <ENAMEX TYPE="ANIMAL">worm</ENAMEX> mRNAs on <NUMEX TYPE="CARDINAL">all three</NUMEX> of our
        array designs with comparable confidence to
        within-array-design comparisons. This is not possible with
        globally normalized average differences. We believe that
        cRNA quantitation and the damping of low-amplitude signals
        provided by the <ENAMEX TYPE="PRODUCT">F</ENAMEX> <ENAMEX TYPE="SUBSTANCE">snormalization</ENAMEX> make this metric a
        valuable format for reporting diverse gene expression array
        results.
      
      
        Materials and methods
        
          Experiments and arrays
          Array experiments used the <ENAMEX TYPE="ORGANIZATION">Genetics Institute</ENAMEX> 
          <ENAMEX TYPE="ORGANIZATION">C. elegans Affymetrix GeneChipâ„</ENAMEX>¢
          oligonucleotide arrays, a set of <NUMEX TYPE="MONEY">three arrays</NUMEX> (<ENAMEX TYPE="DISEASE">denoted A</ENAMEX>,
          B and <ENAMEX TYPE="PRODUCT">C</ENAMEX>) which in aggregate monitor <NUMEX TYPE="PERCENT">approximately 98%</NUMEX> of
          the <NUMEX TYPE="CARDINAL">19,099</NUMEX> predicted <ENAMEX TYPE="ANIMAL">worm</ENAMEX> mRNAs in the <TIMEX TYPE="DATE">October 1998</TIMEX> worm
          genome sequence release [ <TIMEX TYPE="DATE">20</TIMEX>]. The total number of probe
          sets on each array was <NUMEX TYPE="MONEY">6,617</NUMEX> (A array), <NUMEX TYPE="CARDINAL">5,768</NUMEX> (<ENAMEX TYPE="ORGANIZATION">B</ENAMEX>), and
          <NUMEX TYPE="CARDINAL">6,646</NUMEX> (C). Each <ENAMEX TYPE="PRODUCT_DESC">probe</ENAMEX> set consists of <NUMEX TYPE="CARDINAL">20</NUMEX> distinct probe
          <ENAMEX TYPE="PERSON">pairs</ENAMEX> (each <ENAMEX TYPE="PRODUCT_DESC">probe</ENAMEX> is a <NUMEX TYPE="ORDINAL">25mer</NUMEX>) designed to monitor a
          single transcript. On the 
          <ENAMEX TYPE="ORGANIZATION">C.</ENAMEX> elegans arrays described here,
          probe sets monitoring the spiked transcripts were each
          tiled twice with a different set of oligonucleotide
          probes. On arrays that are commercially available from
          Affymetrix, one probe set is tiled to monitor each of the
          <ENAMEX TYPE="PERSON">spike</ENAMEX>-in transcripts. The probe sets are not fully
          randomly distributed across the arrays, although on the 
          <ENAMEX TYPE="ORGANIZATION">C.</ENAMEX> elegans arrays the different
          <ENAMEX TYPE="PRODUCT_DESC">probe sets</ENAMEX> are tiled in widely different regions of the
          <ENAMEX TYPE="ORGANIZATION">arrays</ENAMEX>. Experimental array data described here were taken
          from the developmental time course dataset reported in [
          <NUMEX TYPE="CARDINAL">10</NUMEX>]. Specifically, we examined individual replicate
          hybridizations of the A array from the <ENAMEX TYPE="ANIMAL">worm</ENAMEX> developmental
          <ENAMEX TYPE="ORGANIZATION">time</ENAMEX> course at each of <NUMEX TYPE="MONEY">0</NUMEX> ( 
          <ENAMEX TYPE="ORGANIZATION">n</ENAMEX> = <NUMEX TYPE="CARDINAL">4</NUMEX>), <TIMEX TYPE="DATE">36</TIMEX> ( 
          <ENAMEX TYPE="ORGANIZATION">n</ENAMEX> = <NUMEX TYPE="CARDINAL">3</NUMEX>), <TIMEX TYPE="DATE">48</TIMEX> ( 
          <ENAMEX TYPE="ORGANIZATION">n</ENAMEX> = <NUMEX TYPE="CARDINAL">4</NUMEX>) and <TIMEX TYPE="DATE">60</TIMEX> ( 
          <ENAMEX TYPE="ORGANIZATION">n</ENAMEX> = <NUMEX TYPE="CARDINAL">4</NUMEX>) <TIMEX TYPE="TIME">hours</TIMEX> after synchronization
          of <ENAMEX TYPE="SUBSTANCE">worm eggs</ENAMEX> by <ENAMEX TYPE="SUBSTANCE">bleach</ENAMEX>, as well as a larger set of <NUMEX TYPE="CARDINAL">13</NUMEX>
          hybridizations of <NUMEX TYPE="CARDINAL">all three</NUMEX> arrays to samples ranging
          from oocytes to <NUMEX TYPE="CARDINAL">2</NUMEX><ENAMEX TYPE="ANIMAL">-week-old worms</ENAMEX>. Replicate
          <ENAMEX TYPE="ORGANIZATION">hybridizations</ENAMEX> in the datasets included independently
          generated complementary <ENAMEX TYPE="SUBSTANCE">RNA</ENAMEX> (cRNA) preparations from the
          same starting total <ENAMEX TYPE="SUBSTANCE">RNA</ENAMEX>. Primary data for all transcripts
          on all arrays (including all replicates of <NUMEX TYPE="CARDINAL">all three</NUMEX>
          array designs) is contained in the supplementary <ENAMEX TYPE="ORGANIZATION">Excel</ENAMEX>
          <ENAMEX TYPE="PERSON">spreadsheet</ENAMEX> (see Additional data files).
        
        
          <ENAMEX TYPE="PERSON">Spike</ENAMEX>-in transcript pool
          A pool of biotin-labeled spike-in control transcripts
          was derived by 
          in vitro transcription of <NUMEX TYPE="CARDINAL">11</NUMEX> cloned
          
          <ENAMEX TYPE="SUBSTANCE">Bacillus subtilis genes</ENAMEX>, using the
          methods described in [ <TIMEX TYPE="DATE">21</TIMEX>]. The <ENAMEX TYPE="PER_DESC">spike</ENAMEX>-in pool was added
          into <ENAMEX TYPE="PRODUCT_DESC">hybridization cocktails</ENAMEX> in proportion to the
          UV-quantitated cRNA mass in the hybridization, so as to
          achieve the desired final concentration of <ENAMEX TYPE="SUBSTANCE">spike-ins</ENAMEX>. The
          spiked transcripts and their final concentrations in the
          hybridization <ENAMEX TYPE="PRODUCT_DESC">cocktails</ENAMEX> are listed in <ENAMEX TYPE="PRODUCT">Table 1</ENAMEX>. Final
          concentrations in pmol and parts per <NUMEX TYPE="MONEY">million</NUMEX> (ppm) for
          each spiked transcript were computed from the known
          length of each <ENAMEX TYPE="PER_DESC">spike</ENAMEX>-in, assuming a total mass of <NUMEX TYPE="QUANTITY">2 Î</NUMEX>¼g
          <ENAMEX TYPE="ANIMAL">worm cRNA</ENAMEX> in a <NUMEX TYPE="QUANTITY">200 Î¼l</NUMEX> hybridization volume, and an
          average length of <NUMEX TYPE="CARDINAL">1,000</NUMEX> <ENAMEX TYPE="FAC_DESC">bases</ENAMEX> for 
          in <ENAMEX TYPE="ANIMAL">vitro transcribed worm</ENAMEX>
          <ENAMEX TYPE="ORGANIZATION">cRNAs</ENAMEX>.
        
        
          Metrics for transcript abundance
          Average difference (<ENAMEX TYPE="ORGANIZATION">AD</ENAMEX>) is the basic measure of
          transcript abundance that is calculated by the Affymetrix
          GeneChip <NUMEX TYPE="CARDINAL">3.1</NUMEX> software. The calculation of <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX> is described
          in detail in the <ENAMEX TYPE="ORGANIZATION">Affymetrix GeneChip User Guide</ENAMEX> [ <TIMEX TYPE="DATE">17</TIMEX>].
          Briefly, a background intensity is computed for each of
          16 rectangular <ENAMEX TYPE="ORG_DESC">sectors</ENAMEX> on the array. This local
          background is subtracted from the intensity values of
          each probe <ENAMEX TYPE="FAC_DESC">cell</ENAMEX> in all sectors. After background
          <ENAMEX TYPE="PERSON">subtraction</ENAMEX>, the difference between perfect match (PM)
          and mismatch (MM) feature intensity is calculated for all
          probe pairs in each <ENAMEX TYPE="PRODUCT_DESC">probe</ENAMEX> set (in our case, <NUMEX TYPE="CARDINAL">20</NUMEX> probe
          pairs in total). The <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX> for each <ENAMEX TYPE="PRODUCT_DESC">probe</ENAMEX> set is the average
          of the PM - MM differences, after outlying values are
          removed.
          A <NUMEX TYPE="ORDINAL">second</NUMEX> important metric generated by the GeneChip
          software is the <ENAMEX TYPE="FAC">Absolute Decision</ENAMEX>. The <ENAMEX TYPE="ORGANIZATION">Absolute Decision</ENAMEX>
          is a categorical call for each transcript: either
          Present, <ENAMEX TYPE="WORK_OF_ART">Absent, or Marginal</ENAMEX>. The <ENAMEX TYPE="FAC">Absolute Decision</ENAMEX> is a
          heuristic metric based on the number of <ENAMEX TYPE="PRODUCT_DESC">probe</ENAMEX> pairs for a
          given transcript that show strong specific hybridization
          signals. See the <ENAMEX TYPE="ORGANIZATION">Affymetrix GeneChip User Guide</ENAMEX> [ <TIMEX TYPE="DATE">17</TIMEX>] for
          a detailed description of this metric.
          Because of array-to-array variation in overall signal
          strength, AD values from different arrays are usually
          <ENAMEX TYPE="ORGANIZATION">normalized</ENAMEX> to a common scale. We reproduced the scaled AD
          normalization of the <ENAMEX TYPE="PRODUCT">Affymetrix GeneChip 3.1</ENAMEX> software.
          The calculation is described in detail in the Affymetrix
          <ENAMEX TYPE="ORGANIZATION">GeneChip User Guide</ENAMEX> [ <TIMEX TYPE="DATE">17</TIMEX>]. <ENAMEX TYPE="PERSON">Scaling</ENAMEX> is done by equalizing
          the average intensity of all arrays in <TIMEX TYPE="DATE">a given dataset</TIMEX>,
          where the average intensity is defined as the trimmed
          average of the <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX> values of every <ENAMEX TYPE="PRODUCT_DESC">probe</ENAMEX> set on the array,
          excluding the highest <NUMEX TYPE="PERCENT">2%</NUMEX> and lowest <NUMEX TYPE="PERCENT">2%</NUMEX> of the values.
          This normalization works on the assumption that the
          summed expression level of all genes on the array is
          constant across experiments, and that differences in
          expression levels between <ENAMEX TYPE="PER_DESC">arrays</ENAMEX> can be corrected by
          array-specific scaling factors. We denote the normalized
          <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX> values as scaled average difference (AD s).
          The calculation of frequency (<ENAMEX TYPE="PRODUCT">F</ENAMEX>) values involved two
          steps: <NUMEX TYPE="ORDINAL">first</NUMEX>, conversion of <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX> values to frequencies by
          use of the calibration curve, and <NUMEX TYPE="ORDINAL">second</NUMEX>, estimation of
          the chip sensitivity of detection and 'damping' of
          frequency values below this sensitivity.
          The calibration curve for each hybridization was
          constructed from the <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX> values for each of the <NUMEX TYPE="CARDINAL">11</NUMEX> control
          <ENAMEX TYPE="PERSON">transcripts</ENAMEX> and their known frequencies (<ENAMEX TYPE="PRODUCT">Table 1</ENAMEX>). <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX>
          values that were negative, or associated with <ENAMEX TYPE="PERSON">Absent</ENAMEX> or
          Marginal <ENAMEX TYPE="PERSON">Absolute Decisions</ENAMEX>, were removed from the curve
          in order to improve the robustness of the fit. This
          calibration curve was fitted by a linear function with
          zero intercept, using a generalized linear model [ <TIMEX TYPE="DATE">22</TIMEX>]
          fitting procedure in the statistical software S-PLUS
          (<ENAMEX TYPE="ORGANIZATION">Insightful Corp.</ENAMEX>, <ENAMEX TYPE="GPE">Seattle</ENAMEX>, <ENAMEX TYPE="ORGANIZATION">WA</ENAMEX>). The fitting procedure
          assumed a <ENAMEX TYPE="SUBSTANCE">gamma</ENAMEX> error structure, appropriate for data
          with constant coefficient of variation, and utilized
          iterative reweighting of errors. The single coefficient
          of this linear fit was multiplied with the average
          difference values for each gene on the array to yield
          initial frequency estimates. Calibration curves for the
          <ENAMEX TYPE="ORGANIZATION">hybridizations</ENAMEX> described here were examined visually to
          rule out poor curve fits.
          Chip sensitivity of detection was estimated from the
          Absolute Decisions (<ENAMEX TYPE="WORK_OF_ART">Present, Marginal, or Absent</ENAMEX>) for the
          <TIMEX TYPE="TIME">11 spike</TIMEX>-in transcripts in one of <NUMEX TYPE="CARDINAL">two</NUMEX> ways. In the
          general case, <ENAMEX TYPE="PERSON">Absolute Decisions</ENAMEX> were considered as a
          <ENAMEX TYPE="ORGANIZATION">binary</ENAMEX> response: <ENAMEX TYPE="ORGANIZATION">Absent</ENAMEX> = <NUMEX TYPE="CARDINAL">0</NUMEX>, Present = <NUMEX TYPE="CARDINAL">1</NUMEX>, with <ENAMEX TYPE="ORGANIZATION">Marginal</ENAMEX>
          calls treated as <ENAMEX TYPE="ORGANIZATION">Absent</ENAMEX> to be conservative. This response
          was regressed against the log-transformed known
          <ENAMEX TYPE="PERSON">frequencies</ENAMEX>, using a generalized linear <ENAMEX TYPE="PRODUCT_DESC">model</ENAMEX> with a
          <ENAMEX TYPE="ORGANIZATION">logit</ENAMEX> link function. The chip sensitivity was then
          defined as the frequency at which the predicted odds of a
          Present call were <NUMEX TYPE="PERCENT">70%</NUMEX>. In the special case where all
          <ENAMEX TYPE="PERSON">spike</ENAMEX>-in mRNAs called <ENAMEX TYPE="PRODUCT">Absent</ENAMEX> were lower-abundance
          messages than all <ENAMEX TYPE="SUBSTANCE">spike-ins</ENAMEX> called <ENAMEX TYPE="PRODUCT">Present</ENAMEX>, the
          <ENAMEX TYPE="PERSON">sensitivity</ENAMEX> was defined by linear interpolation as the
          frequency <NUMEX TYPE="PERCENT">70%</NUMEX> of the distance between the highest Absent
          call frequency and the lowest Present call frequency.
          Frequency values for all genes on the array that fell
          below the sensitivity were damped as follows. Negative
          <ENAMEX TYPE="PERSON">frequencies</ENAMEX> (corresponding to negative AD values) were
          adjusted to <NUMEX TYPE="CARDINAL">one-half</NUMEX> of the chip sensitivity. Frequencies
          between <NUMEX TYPE="CARDINAL">zero</NUMEX> and the chip sensitivity were adjusted to
          the average of the frequency and the chip sensitivity.
          The rationale for this adjustment was threefold. First,
          one-half the chip sensitivity was a reasonable 
          a priori estimate of abundance for
          many genes that were not reliably detected. <NUMEX TYPE="ORDINAL">Second</NUMEX>, the
          adjusted frequencies were guaranteed to be
          positive-valued, making downstream analyses of frequency
          values (for example, log transformation) significantly
          easier. <NUMEX TYPE="ORDINAL">Third</NUMEX>, retaining the adjusted low-level frequency
          estimates was preferable to discarding them, because
          discarding the values would make it impossible to detect
          potentially important regulation of these genes in future
          experiments.
          Frequency normalization could be adversely affected by
          technical uncertainties in cRNA preparation (see Results
          and discussion). To attenuate these effects, an
          additional frequency <ENAMEX TYPE="PER_DESC">variant</ENAMEX> termed scaled frequency (F
          <ENAMEX TYPE="ORGANIZATION">s</ENAMEX>) was introduced. F swas a hybrid of ADs and frequency,
          and was computed as follows. AD swas first computed for a
          set of <NUMEX TYPE="CARDINAL">two</NUMEX> or more arrays exactly as described above.
          Then a linear model (with <NUMEX TYPE="CARDINAL">zero</NUMEX> intercept) was fitted to
          the pooled AD svalues for the <NUMEX TYPE="CARDINAL">11</NUMEX> <ENAMEX TYPE="PER_DESC">spike</ENAMEX>-in transcripts
          from all arrays, ignoring negative AD svalues or those
          <ENAMEX TYPE="ORGANIZATION">associated</ENAMEX> with <ENAMEX TYPE="PRODUCT">Marginal/Absent Absolute Decisions</ENAMEX>. The
          slope of this linear model was the single calibration
          factor for the entire dataset. This slope was multiplied
          with the AD svalues from all arrays to yield F svalues.
          Per-array sensitivity values were computed exactly as
          described for <ENAMEX TYPE="PRODUCT">F</ENAMEX>, and <ENAMEX TYPE="PRODUCT">F</ENAMEX> svalues on any array that were
          below the array sensitivity were adjusted as described
          above.
        
        
          Simulated data
          Array data was simulated as follows. First, a single
          experimental <ENAMEX TYPE="SUBSTANCE">dataset</ENAMEX>, one of the <TIMEX TYPE="TIME">0-hour</TIMEX> <TIMEX TYPE="DATE">replicates</TIMEX>, was
          chosen as a baseline for generation of all simulated
          <ENAMEX TYPE="ORGANIZATION">data</ENAMEX>. To this baseline dataset, several random noise
          <ENAMEX TYPE="PER_DESC">sources</ENAMEX> were added to reproduce key <ENAMEX TYPE="PER_DESC">sources</ENAMEX> of
          <ENAMEX TYPE="ORGANIZATION">variability</ENAMEX> in array data. The relation describing the
          simulated data was:
          
          <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX> 
          
            ij 
           = 
          b 
          
            ij 
           <ENAMEX TYPE="CONTACT_INFO">+</ENAMEX> 
          ADB 
          
            i 
           ( 
          a 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           
          <ENAMEX TYPE="ORGANIZATION">m</ENAMEX> 
          
            ij 
           
          <ENAMEX TYPE="ORGANIZATION">s</ENAMEX> 
          
            ij 
           
          r 
          
            ij 
           )
          where
          
          <ENAMEX TYPE="ORGANIZATION">AD</ENAMEX> 
          
            ij 
           = simulated AD for the 
          i th mRNA on the 
          <ENAMEX TYPE="ORGANIZATION">j th</ENAMEX> array
          
          ADB 
          
            i 
           = baseline gene expression data for the 
          i th mRNA
          
          b 
          
            ij 
           = background noise for the 
          i th mRNA on the 
          <ENAMEX TYPE="ORGANIZATION">j th</ENAMEX> array
          
          a 
          
            i 
           = array intensity offset for the 
          <ENAMEX TYPE="ORGANIZATION">j th</ENAMEX> array
          
          <ENAMEX TYPE="ORGANIZATION">m</ENAMEX> 
          
            ij 
           = multiplicative noise for the 
          i th mRNA on the 
          <ENAMEX TYPE="ORGANIZATION">j th</ENAMEX> array
          
          <ENAMEX TYPE="ORGANIZATION">s</ENAMEX> 
          
            ij 
           <ENAMEX TYPE="PERSON">= spike</ENAMEX>-skew factor for the 
          i th mRNA on the 
          <ENAMEX TYPE="ORGANIZATION">j th</ENAMEX> array (unity for all nonspiked
          <ENAMEX TYPE="ORGANIZATION">mRNAs</ENAMEX>)
          
          r 
          
            ij 
           = regulation factor for the 
          i th gene on the 
          <ENAMEX TYPE="ORGANIZATION">j th</ENAMEX> array (unity for all spiked
          <ENAMEX TYPE="ORGANIZATION">mRNAs</ENAMEX>)
          Background 
          b 
          
            ij 
           was <ENAMEX TYPE="PERSON">Gaussian</ENAMEX> with a standard deviation (SD) that
          varied randomly from one array to another. The background
          <ENAMEX TYPE="ORGANIZATION">noise SD</ENAMEX> had a mean of <NUMEX TYPE="CARDINAL">20</NUMEX> AD <ENAMEX TYPE="ORG_DESC">units</ENAMEX>, and a standard
          deviation of <NUMEX TYPE="CARDINAL">5</NUMEX> AD <ENAMEX TYPE="ORG_DESC">units</ENAMEX>. Array intensity offsets a 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           were <ENAMEX TYPE="ORGANIZATION">Gaussian</ENAMEX> with a mean of <NUMEX TYPE="CARDINAL">one</NUMEX> and <ENAMEX TYPE="ORGANIZATION">SD</ENAMEX> of <NUMEX TYPE="CARDINAL">0.3</NUMEX>.
          Multiplicative noise, 
          <ENAMEX TYPE="ORGANIZATION">m</ENAMEX> 
          
            ij 
           , was drawn from a normally distributed <NUMEX TYPE="CARDINAL">zero</NUMEX>-mean
          noise <ENAMEX TYPE="PER_DESC">source</ENAMEX> with a constant <ENAMEX TYPE="ORGANIZATION">CV</ENAMEX> of <NUMEX TYPE="CARDINAL">0.1</NUMEX>. <ENAMEX TYPE="PERSON">Spike</ENAMEX>-skew factor
          
          <ENAMEX TYPE="ORGANIZATION">s</ENAMEX> 
          
            ij 
           was a single random factor for all spiked cRNAs on a
          given array, and unity for all other messages. The
          <ENAMEX TYPE="PERSON">spike</ENAMEX>-skew factor for the spiked cRNAs was <ENAMEX TYPE="PERSON">Gaussian</ENAMEX> with
          mean <NUMEX TYPE="CARDINAL">1</NUMEX> and a <ENAMEX TYPE="ORGANIZATION">SD</ENAMEX> that was adjusted from <NUMEX TYPE="MONEY">0.1 to 0.4</NUMEX> (in
          percentage terms, <NUMEX TYPE="PERCENT">10-40%</NUMEX>). Regulation factors r 
          
            ij 
           were generated by a procedure in which the base-<NUMEX TYPE="CARDINAL">10</NUMEX>
          <ENAMEX TYPE="PERSON">log</ENAMEX> (fold-change) for each gene was selected from a
          normal distribution with mean <NUMEX TYPE="MONEY">0 and SD 0.5</NUMEX>. Extreme
          <ENAMEX TYPE="ORGANIZATION">random</ENAMEX> regulation factors were limited so that the
          regulated gene expression values had the same range as
          baseline data. After multiplication of each gene by its
          regulation factor, the mean expression level of all genes
          was adjusted so that the overall mean expression level
          was unchanged by regulation.
        
      
      
        Additional data files
        Primary data for all experimental <ENAMEX TYPE="SUBSTANCE">hybridizations</ENAMEX> are
        available as an <ENAMEX TYPE="PRODUCT">Excel</ENAMEX> spreadsheet(<NUMEX TYPE="CARDINAL">20,325</NUMEX> <ENAMEX TYPE="ORGANIZATION">Kb</ENAMEX>).
        Additional data file 1
        Primary data for all experimental hybridizations
        Primary data for all experimental hybridizations
        Click here for additional data file
      
    
  
