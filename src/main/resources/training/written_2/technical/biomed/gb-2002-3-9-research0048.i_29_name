
  
    
      
        Background
        
          <ENAMEX TYPE="ORGANIZATION">Linear</ENAMEX> normalization methods
          <ENAMEX TYPE="ORGANIZATION">Linear</ENAMEX> methods are the predominant means of microarray
          <ENAMEX TYPE="ORGANIZATION">normalization</ENAMEX>. <ENAMEX TYPE="PERSON">Scaling</ENAMEX>, the simplest linear approach,
          assumes a linear relationship passing through the origin.
          Forcing array distributions to have the same central
          <ENAMEX TYPE="PERSON">tendency</ENAMEX> (arithmetic mean, geometric mean, median) can be
          accomplished by a scaling factor and has been the method
          chosen by <ENAMEX TYPE="ORGANIZATION">Affymetrix</ENAMEX> and others [ <ENAMEX TYPE="LAW">5</ENAMEX>]. <ENAMEX TYPE="ORGANIZATION">Linear</ENAMEX> regression [
          <ENAMEX TYPE="LAW">6, 7</ENAMEX>] and general linear modeling such as <ENAMEX TYPE="ORGANIZATION">ANOVA</ENAMEX> [ <ENAMEX TYPE="LAW">8, 9</ENAMEX>]
          provide offsets, scaling factors and other parameters,
          but again assume linear relationships and properties of
          the data or log data distributions, such as normality,
          that are not always true. In all cases, linear approaches
          will fall short when the signal bias is not linear.
          Approaches for <NUMEX TYPE="CARDINAL">two</NUMEX>-channel cDNA arrays apply scaling
          in order to <NUMEX TYPE="CARDINAL">zero</NUMEX> a central tendency of the log expression
          ratios [ <TIMEX TYPE="DATE">10, 11, 12</TIMEX>]. These approaches may also be
          <ENAMEX TYPE="ORGANIZATION">applied</ENAMEX> to pairs of single-channel oligonucleotide
          <ENAMEX TYPE="ORGANIZATION">arrays</ENAMEX>. Applying an <ENAMEX TYPE="SUBSTANCE">additive</ENAMEX> offset to the log data is
          equivalent to a multiplicative scaling of <NUMEX TYPE="CARDINAL">one</NUMEX> channel
          before taking the log. Moving the median or mode of the
          log-ratios to <NUMEX TYPE="CARDINAL">zero</NUMEX> makes the assumption that the majority
          of genes are not differentially regulated. Additional
          steps may scale the log-ratios by a measure of dispersion
          such as the standard deviation or median absolute
          <ENAMEX TYPE="PERSON">deviation</ENAMEX> (<ENAMEX TYPE="ORGANIZATION">MAD</ENAMEX>), possibly grouping spots according to the
          printing-tip. This is equivalent to raising both channels
          to a power before taking the log and is therefore a
          <ENAMEX TYPE="PERSON">non-linear</ENAMEX> transformation of the original signals though
          giving rise to a linear transformation of the
          log-signals. Unfortunately, systematic biases are not
          always linear in log-space either.
        
        
          Non-linear normalization methods
          Non-linear normalization methods have been shown to
          <ENAMEX TYPE="ORGANIZATION">control signal-dependent</ENAMEX> non-linear bias between <TIMEX TYPE="DATE">Cy5</TIMEX> and
          Cy3 <ENAMEX TYPE="ORG_DESC">channels</ENAMEX> of cDNA arrays [ <TIMEX TYPE="DATE">11, 13</TIMEX>]. The promising
          approach of <ENAMEX TYPE="PERSON">Yang</ENAMEX> 
          et al. [ <TIMEX TYPE="DATE">11</TIMEX>] uses lowess local
          <ENAMEX TYPE="ORGANIZATION">regression</ENAMEX> [ <TIMEX TYPE="DATE">14</TIMEX>] directly to paired data as a function of
          <ENAMEX TYPE="ORGANIZATION">signal</ENAMEX> intensity. For the cDNA data used by <ENAMEX TYPE="PERSON">Yang</ENAMEX> 
          <ENAMEX TYPE="ORGANIZATION">et al.</ENAMEX> and Tseng 
          et al. [ <TIMEX TYPE="DATE">11, 13</TIMEX>], lowess was used
          for local linear regression of log( 
          R )-log( 
          <ENAMEX TYPE="ORGANIZATION">G</ENAMEX> ) versus <NUMEX TYPE="MONEY">1/2</NUMEX>(log( 
          R ) + log( 
          <ENAMEX TYPE="ORGANIZATION">G</ENAMEX> )) where 
          R , and 
          G are the intensities of the Cy5
          and <NUMEX TYPE="CARDINAL">Cy3</NUMEX> channels respectively. Rather than regressing
          <ENAMEX TYPE="PERSON">log</ENAMEX>( 
          R ) directly to log( 
          <ENAMEX TYPE="ORGANIZATION">G</ENAMEX> ), these approaches correctly
          attribute uncertainty to both <ENAMEX TYPE="ORG_DESC">channels</ENAMEX> by regressing to
          the geometric mean of the intensity. Even so, standard
          regression techniques can be sensitive to outliers, which
          are likely to occur in microarray data. Robust regression
          techniques, as found in the <ENAMEX TYPE="NATIONALITY">R</ENAMEX> version of <ENAMEX TYPE="SUBSTANCE">lowess</ENAMEX> [ <TIMEX TYPE="DATE">15</TIMEX>],
          are relatively insensitive to outliers. Robust regression
          techniques incur significant computational costs and, in
          practice, a small random sample of data must be used for
          <TIMEX TYPE="DATE">today</TIMEX>'s oligonucleotide arrays. The approach taken by
          Tseng 
          et al. [ <TIMEX TYPE="DATE">13</TIMEX>] and Schadt 
          et al. [ <ENAMEX TYPE="LAW">4</ENAMEX>] addresses the outlier
          issue by selecting non-regulated features based on a rank
          invariant criterion where all signals from both arrays
          are sorted and signals with ranks deviating by less than
          a threshold are included. Normalization of replicate
          <ENAMEX TYPE="ORGANIZATION">arrays</ENAMEX> raises the question of which signals should be
          excluded when none of the genes are differentially
          expressed. In the method we will describe, no data need
          to be excluded for curve fitting and it is therefore
          global and unbiased by subset selection.
        
        
          <ENAMEX TYPE="ORGANIZATION">Signal-dependent</ENAMEX> non-linear normalization
          The goal of signal-dependent normalization is to make
          <ENAMEX TYPE="ORGANIZATION">signal</ENAMEX> distributions comparable across the intensity
          range. This suggests that the expectation for the
          difference of paired measurements, or log-ratios, should
          not significantly deviate from <NUMEX TYPE="CARDINAL">zero</NUMEX> anywhere over the
          intensity range. Again, this is the motivation for
          <ENAMEX TYPE="PRODUCT">centering Cy5</ENAMEX> to Cy3 log-ratio distributions of cDNA
          arrays, but now we consider multiple arrays. If the
          log-ratio distributions between arrays or color channels
          are to be centered across the intensity range, then the
          resulting correlation will be linear with intercept zero
          and slope <NUMEX TYPE="CARDINAL">one</NUMEX>. The resulting data correlation will retain
          stochastic noise and, more important, the biological
          variation. This linear data correlation presupposes that
          the distributions of signals be roughly the same. Our
          approach seeks to transform the distribution of <NUMEX TYPE="CARDINAL">one</NUMEX> array
          to the distribution of a target array in order to achieve
          this goal. If the target array is chosen to be the
          geometric mean probe intensities over the arrays in an
          experiment, then each array distribution is fitted to an
          empirical estimate of the signal distribution for the
          experiment. In principle, any measure of central tendency
          may be used, although the geometric mean is a natural
          extension of existing cDNA methodologies. Alternatively,
          each array can be fitted to the theoretical <ENAMEX TYPE="PER_DESC">quantiles</ENAMEX> of
          a known distribution (for example, the log-normal
          distribution). This approach was not chosen here as the
          observed distributions did not fit a theoretical model
          and contained well determined, systematic features. In
          this work we seek only to make the distributions similar
          to each other whatever those distributions may be.
          For <ENAMEX TYPE="ORGANIZATION">Affymetrix</ENAMEX> data, all the arrays of an experiment
          can be used to define a target array and thus a target
          distribution that all arrays are normalized to. As a
          result of the dye effects, data from <NUMEX TYPE="CARDINAL">two</NUMEX>-channel cDNA
          arrays display significantly different <TIMEX TYPE="DATE">Cy3 and Cy5</TIMEX> signal
          <ENAMEX TYPE="PERSON">distributions</ENAMEX>, suggesting that means calculated over both
          <ENAMEX TYPE="ORGANIZATION">signal</ENAMEX> <ENAMEX TYPE="PER_DESC">types</ENAMEX> may not make sense for the definition of a
          target distribution. Instead, either the geometric mean
          of the <NUMEX TYPE="ORDINAL">Cy3</NUMEX> or <NUMEX TYPE="CARDINAL">Cy5</NUMEX> channels are used, and all channels
          from all arrays are normalized to a single Cy3 or Cy5
          distribution. This accomplishes both <TIMEX TYPE="DATE">Cy3</TIMEX> to Cy5
          <ENAMEX TYPE="ORGANIZATION">normalization</ENAMEX> within and between arrays. The approach
          described here can be used to normalize <TIMEX TYPE="DATE">the Cy3</TIMEX> channel
          to the <NUMEX TYPE="ORDINAL">Cy5</NUMEX> <ENAMEX TYPE="ORG_DESC">channel</ENAMEX> within a single array or may also be
          <ENAMEX TYPE="ORGANIZATION">applied</ENAMEX> to pairs of <ENAMEX TYPE="ORGANIZATION">Affymetrix</ENAMEX> arrays.
        
        
          Qspline normalization
          The normalization method described in this work,
          qspline, uses quantiles from array signals and target
          signals, 
          x and 
          <ENAMEX TYPE="PERSON">v</ENAMEX> , to fit smoothing B-splines. The
          splines are then used as signal-dependent normalization
          functions on the signals of 
          x . The target signals can be from
          another array or could be means calculated from multiple
          arrays as just described. Splines are a natural and
          robust choice in that they are capable of representing
          almost any smooth relationship and will also work well if
          <ENAMEX TYPE="ORGANIZATION">data</ENAMEX> is linearly related. Using quantile information
          provides a much easier fitting problem and avoids
          directly fitting the pairwise data which often requires
          robust regression techniques. An example oligonucleotide
          array signal distribution and quantile comparison can be
          seen in Figure <NUMEX TYPE="CARDINAL">1</NUMEX>.
        
        
          Spatial normalization
          Spatial heterogeneity of signal can be observed in
          microarray data and in particular in cDNA microarray
          <ENAMEX TYPE="ORGANIZATION">data</ENAMEX>. <ENAMEX TYPE="ORGANIZATION">Variability</ENAMEX> in <ENAMEX TYPE="CONTACT_INFO">Cy3/Cy5</ENAMEX> ratios has been shown to be
          generated, in part, by the specific print-tip used during
          the spotting of the cDNA probes [ <TIMEX TYPE="DATE">11</TIMEX>]. In fact, an <ENAMEX TYPE="PRODUCT">F-</ENAMEX>test
          found that <NUMEX TYPE="CARDINAL">at least one</NUMEX> print-tip was very significantly
          <ENAMEX TYPE="ORGANIZATION">correlated</ENAMEX> to log-ratio (log( 
          <ENAMEX TYPE="ORGANIZATION">p</ENAMEX> -value) <NUMEX TYPE="PERCENT">less than -20</NUMEX>) in all
          cDNA arrays used in this study. Spatial effects are not
          only caused by the printing device but may also be
          related to; temperature or humidity during the time of
          printing, the batch of cDNA represented by a specific
          microtiter plate, reagent flow during the washing
          procedure after hybridization, or from uneven or tilted
          glass surfaces during scanning. Microtiter plate effects
          can appear as vertical or horizontal bands across the
          array whereas other effects may generate smooth gradients
          of arbitrary orientation. <ENAMEX TYPE="ORGANIZATION">Signal</ENAMEX> gradients can be
          normalized by subtracting local signal estimates (log
          <ENAMEX TYPE="ORGANIZATION">intensities</ENAMEX> or log-ratios) and a preliminary approach for
          this was tested.
          These effects, though not as significant as the Cy3
          Cy5 bias, can be quite pronounced, as will be observed in
          the 
          A. thaliana microarrays.
          Older-<ENAMEX TYPE="PER_DESC">generation</ENAMEX> Affymetrix arrays like those used in
          this study were subject to local signal biases due to the
          adjacent placement of probes for each gene-<ENAMEX TYPE="PRODUCT_DESC">probe</ENAMEX> set.
          This bias has since been corrected in more recent
          oligonucleotide array designs. Other spatial biases can
          be observed for <ENAMEX TYPE="ORGANIZATION">Affymetrix</ENAMEX> arrays and are best described
          as smooth gradients.
        
        
          Normalization comparison
          Log-intensity scaling, lowess and invariant set
          <ENAMEX TYPE="PER_DESC">normalization</ENAMEX> approaches were compared to qspline for the
          reduction of variation between replicate arrays in
          <ENAMEX TYPE="ORGANIZATION">oligonucleotide</ENAMEX> and cDNA array experiments. <NUMEX TYPE="CARDINAL">Six</NUMEX>
          microarrays were used for each of the <ENAMEX TYPE="DISEASE">HIV</ENAMEX> and 
          <ENAMEX TYPE="ORGANIZATION">B.</ENAMEX> <ENAMEX TYPE="SUBSTANCE">subtilis</ENAMEX> studies. <NUMEX TYPE="CARDINAL">Three</NUMEX> control
          <ENAMEX TYPE="PERSON">replicate</ENAMEX> and <NUMEX TYPE="CARDINAL">three</NUMEX> treatment replicate single-channel
          arrays were used in the oligonucleotide array study of
          <ENAMEX TYPE="ORGANIZATION">HIV-infected T</ENAMEX>-cells. <NUMEX TYPE="CARDINAL">Six</NUMEX> replicate <NUMEX TYPE="CARDINAL">two</NUMEX>-channel cDNA
          <ENAMEX TYPE="ORGANIZATION">arrays</ENAMEX> provided <NUMEX TYPE="CARDINAL">six</NUMEX> control and <NUMEX TYPE="CARDINAL">six</NUMEX> treatment channels
          for each 
          <ENAMEX TYPE="ORGANIZATION">B.</ENAMEX> <ENAMEX TYPE="SUBSTANCE">subtilis</ENAMEX> study. In addition, a
          pair of dye-swapped replicate arrays from 
          A. thaliana were also normalized to
          investigate the various normalizations methods versus
          dye-swap normalization.
          The lowess normalization method for cDNA array data
          was taken from the <ENAMEX TYPE="ORGANIZATION">Rarray</ENAMEX> module of the sma package
          (version <NUMEX TYPE="MONEY">0.5.8</NUMEX>) [ <TIMEX TYPE="DATE">16</TIMEX>] and was used for the normalization
          of all cDNA microarray data sets. For oligonucleotide
          array data, a lowess method was adapted from <ENAMEX TYPE="ORGANIZATION">Raffy</ENAMEX> module
          of the sma package. Instead of averaging all pairwise
          array regressions on a single random sample of feature
          <ENAMEX TYPE="PERSON">pairs</ENAMEX>, iterative regressions between an array and the
          target array were averaged using a new random sample for
          each iteration. The former method tended to significantly
          under-normalize whereas the adapted method used
          essentially the same procedure but performed
          significantly better.
          In addition to print-tip normalization for cDNA
          arrays, a spatial gradient normalization was devised
          using a two-dimensional <ENAMEX TYPE="ORGANIZATION">Gaussian</ENAMEX> function. This function
          was used to estimate local background bias over a window
          of probes for the log-ratios of cDNA and oligonucleotide
          array data. Log-ratios for oligonucleotide array data
          were calculated versus the geometric mean of each probe
          across arrays, as will be seen throughout this work.
          Lastly, although it is only a matter of preference, we
          used log base 2 throughout.
        
      
      
        Results
        
          Global assessment of normalization
          The assessment of normalizations was first observed
          for global features such as absolute signal distribution
          and relative signal distribution. Absolute signals result
          from the image analysis and are the values extracted from
          the pixel intensities of each spot, whereas relative
          signals are log-ratios of absolute signals versus
          measured or calculated background probe signals. The
          absolute signal distributions of the <NUMEX TYPE="CARDINAL">six</NUMEX> oligonucleotide
          <ENAMEX TYPE="ORGANIZATION">arrays</ENAMEX> can be seen in Figure <NUMEX TYPE="CARDINAL">2for</NUMEX> the <ENAMEX TYPE="ORGANIZATION">HIV</ENAMEX> (perfect-match
          (<ENAMEX TYPE="ORGANIZATION">PM</ENAMEX>) distributions) and 
          <ENAMEX TYPE="ORGANIZATION">glnA</ENAMEX> (Cy3 
          G and Cy5 
          R distributions) experiments both
          before and after normalization. Distributions for
          replicate arrays or replicated <TIMEX TYPE="DATE">Cy3</TIMEX>, <NUMEX TYPE="CARDINAL">Cy5</NUMEX> channels are
          shown in the same color.
          Figure <TIMEX TYPE="DATE">2shows</TIMEX> that signal-distribution inconsistencies
          between replicate oligonucleotide arrays are comparable
          to those between treatments. For this example,
          distribution discrepancies appear minor though we have
          <ENAMEX TYPE="ORGANIZATION">encountered Affymetrix</ENAMEX> experiments showing dramatically
          disparate distribution profiles. Scaling by the trimmed
          mean of PM-mismatch (MM), as done by the Affymetrix
          GeneChip software (<NUMEX TYPE="MONEY">MAS 4.0</NUMEX>), was observed to separate PM
          intensity distributions more than is observed for
          unnormalized data and was not considered in this study.
          Newer versions of the <ENAMEX TYPE="PRODUCT">Affymetrix</ENAMEX> software (<NUMEX TYPE="MONEY">MAS 5.0</NUMEX>)
          incorporate additional log-intensity scaling routines
          that improve normalization performance but were not
          investigated in this study. Log-intensity scaling used in
          this comparison also did not make signal distributions
          more comparable than the unnormalized case. Both lowess
          and invariant set normalization methods resulted in
          similar array distributions, whereas our version of
          lowess normalization gave more comparable distributions
          than the <ENAMEX TYPE="ORGANIZATION">Raffy</ENAMEX> version. The qspline normalization
          resulted in the most similar array distributions, which
          are indistinguishable from each other in Figure <NUMEX TYPE="CARDINAL">2</NUMEX>.
          Normalized array distributions for the <NUMEX TYPE="CARDINAL">two</NUMEX> cDNA
          experiments showed a similar trend, although cDNA array
          distributions strongly depended on the cyanine dye and in
          all cases, distributions were much less smooth. The dye
          <ENAMEX TYPE="PERSON">bias</ENAMEX> can clearly be seen in the unnormalized <ENAMEX TYPE="PRODUCT">Cy3</ENAMEX> and Cy5
          <ENAMEX TYPE="ORGANIZATION">signal</ENAMEX> distributions shown in green and red respectively
          in Figure <NUMEX TYPE="CARDINAL">2</NUMEX>. Both global and scaled print-tip lowess and
          qspline normalizations showed similar signal-distribution
          comparisons. <ENAMEX TYPE="ORGANIZATION">Lowess</ENAMEX> and qspline normalizations generated
          more comparable <TIMEX TYPE="DATE">Cy3 and Cy5</TIMEX> distributions than scaling
          alone, whereas qspline methods generated the most similar
          <ENAMEX TYPE="ORGANIZATION">signal</ENAMEX> distributions.
          The effects of normalization on the relative signal
          <ENAMEX TYPE="PERSON">distributions</ENAMEX>, log( 
          x 
          
            i 
           <ENAMEX TYPE="CONTACT_INFO">/</ENAMEX> 
          <ENAMEX TYPE="PERSON">v</ENAMEX> ), are shown in Figure <TIMEX TYPE="DATE">3for</TIMEX> both
          <ENAMEX TYPE="ORGANIZATION">oligonucleotide</ENAMEX> and cDNA arrays for the same
          normalizations shown in Figure <NUMEX TYPE="CARDINAL">2</NUMEX>. These <ENAMEX TYPE="PRODUCT_DESC">probe</ENAMEX>-deviation
          distributions show the variability from each 
          v calculated over all the <ENAMEX TYPE="ORG_DESC">channels</ENAMEX> in
          an experiment and therefore show log-intensity deviations
          from the experiments' centroid. The original signal
          intensities are lost in these plots of relative
          information, but global biases can still be seen.
          Comparable decreases in global array bias were observed
          for lowess, qspline and invariant set normalized results.
          Systematic differences between <TIMEX TYPE="DATE">cDNA Cy3 and Cy5</TIMEX> channel
          distributions can be seen before normalization but
          display similar distributions after signal-dependent
          <ENAMEX TYPE="ORGANIZATION">normalization</ENAMEX>. By visual inspection, print-tip scaling
          followed by qspline <ENAMEX TYPE="FAC_DESC">normalization</ENAMEX> resulted in the
          greatest decrease of relative signal bias for the cDNA
          array data. Little if any difference was observed between
          global lowess and scaled print-tip lowess with regard to
          relative signal distributions. The same was observed for
          the <NUMEX TYPE="CARDINAL">two</NUMEX> variants of qspline, suggesting that print-tip
          effects are much smaller than the global biases. The same
          trends were observed for the <NUMEX TYPE="CARDINAL">four</NUMEX> channels of the
          dye-swap replicate cDNA arrays.
          Quantitative results in <ENAMEX TYPE="PRODUCT">Table 1confirm</ENAMEX> the
          observations from the distribution analysis. Variances
          were estimated within each control or treatment <ENAMEX TYPE="ORG_DESC">group</ENAMEX> and
          served as a measure of replicate error. Oligonucleotide
          arrays showed large decreases of from <NUMEX TYPE="PERCENT">50 to 70%</NUMEX> in
          replicate error, for all normalization methods, whereas
          cDNA replicate errors showed decreases of from <NUMEX TYPE="PERCENT">0 to 50%</NUMEX>,
          depending on the normalization. Reductions in variability
          for lowess, qspline and invariant-set methods were
          comparable for both treatment and control replicates of
          oligonucleotide data. The largest decrease in replicate
          variability for the <ENAMEX TYPE="ORGANIZATION">HIV</ENAMEX> experiment was observed for
          <ENAMEX TYPE="ORGANIZATION">qspline</ENAMEX> and invariant-set normalization, where both gave
          decreases of <NUMEX TYPE="PERCENT">59% and 68%</NUMEX> for control and infected,
          respectively. Including spatial normalization after
          <ENAMEX TYPE="ORGANIZATION">qspline</ENAMEX> improved on these decreases by <NUMEX TYPE="PERCENT">an additional 1%</NUMEX>.
          Results for the <ENAMEX TYPE="SUBSTANCE">cDNA</ENAMEX> experiments showed that global and
          print-tip qspline provided greater reduction of replicate
          error versus the lowess methods.
        
        
          <ENAMEX TYPE="ORGANIZATION">Signal</ENAMEX>-dependent assessment of normalization
          To visualize signal-dependent bias, Figure 4shows
          log-signal deviations from 
          v versus signal intensity for each of
          the <NUMEX TYPE="CARDINAL">three</NUMEX> <ENAMEX TYPE="SUBSTANCE">HIV-infected samples</ENAMEX> (that is, log( 
          x 
          
            i 
           )-log( 
          <ENAMEX TYPE="PERSON">v</ENAMEX> ) versus log( 
          <ENAMEX TYPE="PERSON">v</ENAMEX> )). As previously noted [ <TIMEX TYPE="DATE">11</TIMEX>], <ENAMEX TYPE="ORGANIZATION">MA</ENAMEX>
          <ENAMEX TYPE="PERSON">plots</ENAMEX>, where <ENAMEX TYPE="ORGANIZATION">M</ENAMEX>=log(<ENAMEX TYPE="CONTACT_INFO">x/y</ENAMEX>) is plotted versus
          A=log(sqrt(x*y)) for signals x and y, contain the same
          information as 
          xy correlation plots but are much
          better at visualizing deviations from the identity line.
          This representation clearly shows the need for
          <ENAMEX TYPE="ORGANIZATION">signal-dependent</ENAMEX> normalization between replicates, and
          similar results were found for the <NUMEX TYPE="CARDINAL">three</NUMEX> control
          <ENAMEX TYPE="ORGANIZATION">replicates</ENAMEX>. A comparison of normalization curves shows
          differences between all normalization techniques and that
          the signal-dependent methods were able to correct for
          <ENAMEX TYPE="ORGANIZATION">non-linearities</ENAMEX> in the log scale. The comparison of
          normalizing curves shows that the lowess method generated
          smoother curves than the cubic spline methods (qspline
          and invariant set) and that the spline-based curves were
          very similar.
          The signal-dependent biases for the individual
          channels of cDNA array data can be seen for an example 
          glnA microarray in Figure 5after
          print-tip scaling, lowess and qspline normalizations. In
          this case, log( 
          <ENAMEX TYPE="ORGANIZATION">G</ENAMEX> ) and log( 
          R ) signals are compared to mean
          <ENAMEX TYPE="PERSON">log</ENAMEX>( 
          <ENAMEX TYPE="ORGANIZATION">G</ENAMEX> ) signals calculated over the <NUMEX TYPE="CARDINAL">six</NUMEX>
          <ENAMEX TYPE="ORGANIZATION">arrays</ENAMEX>. Although qspline normalized to signals calculated
          from <NUMEX TYPE="CARDINAL">all six</NUMEX> arrays, normalization performance was
          comparable if not better than the lowess method that only
          used <TIMEX TYPE="DATE">the Cy3 and Cy5</TIMEX> signals within each individual
          array. Additional examples can be found in the additional
          <ENAMEX TYPE="ORGANIZATION">data</ENAMEX> files available with this <ENAMEX TYPE="ORG_DESC">paper</ENAMEX> (see Additional data
          files and [ <TIMEX TYPE="DATE">17</TIMEX>]).
          Figure <NUMEX TYPE="CARDINAL">6compares</NUMEX> lowess and qspline normalization to
          dye-swap normalization for replicate arrays A and B,
          where 
          G 
          
            A 
           and 
          R 
          
            A 
           were the control and <ENAMEX TYPE="SUBSTANCE">mutant RNA samples</ENAMEX> on array A
          and 
          G 
          
            B 
           and 
          R 
          
            B 
           were the mutant and control <ENAMEX TYPE="SUBSTANCE">samples</ENAMEX> on array B.
          Dye-swap <ENAMEX TYPE="PER_DESC">normalization</ENAMEX> effectively averages log
          <ENAMEX TYPE="ORGANIZATION">intensities</ENAMEX> within each sample type and is used to
          calculate a single set of log-ratios log(( 
          R 
          
            A 
           
          G 
          
            B 
           )/( 
          G 
          
            A 
           
          R 
          
            B 
           )). From Figure <TIMEX TYPE="DATE">6it</TIMEX> is clear that dye-swap
          <ENAMEX TYPE="ORGANIZATION">normalization</ENAMEX> alone is not enough to account for
          <ENAMEX TYPE="ORGANIZATION">signal</ENAMEX>-dependent biases for this example. Either lowess
          or qspline alone provided more effective normalization
          than dye-swap averaging. This was due to the fact that,
          in this case, the dye bias was not consistent between
          <ENAMEX TYPE="ORGANIZATION">replicates</ENAMEX> and can be seen to be much worse in array B.
          <ENAMEX TYPE="ORGANIZATION">Signal-dependent</ENAMEX> normalization followed by dye-swap
          averaging should provide significantly better results
          than either approach alone.
          When the signal-intensity range was separated into
          quartiles, the median log-ratio versus the probe means v
          was plotted for each array and each quartile. These
          <ENAMEX TYPE="ORGANIZATION">medians</ENAMEX> can be seen in Figure <NUMEX TYPE="CARDINAL">7for</NUMEX> the <ENAMEX TYPE="ORGANIZATION">HIV</ENAMEX>, 
          <ENAMEX TYPE="ORGANIZATION">glnA</ENAMEX> and dye-swap experiments after
          the various normalizations. Separating these
          distributions by quartiles shows the performance of the
          normalization methods relative to signal intensity and
          again confirms the effectiveness of the methods described
          here. The lowess methods used for cDNA data were only
          employed to normalize within individual <ENAMEX TYPE="PER_DESC">arrays</ENAMEX> and thus
          <ENAMEX TYPE="ORGANIZATION">signal</ENAMEX> differences can still be observed between arrays.
          The 
          R/<ENAMEX TYPE="ORGANIZATION">G</ENAMEX> log-ratio variability for each
          array was found to be comparable for both single and
          multiple array normalization strategies. Again, the
          results from global and print-tip methods were not seen
          to differ.
          The distributions of 
          R / 
          <ENAMEX TYPE="ORGANIZATION">G</ENAMEX> log-ratios versus print-tip can
          be compared for an example 
          glnA array in Figure <NUMEX TYPE="CARDINAL">8</NUMEX>. After
          global normalization, a print-tip dependence can still be
          observed in most cases. Scaling the individual Cy3 and
          Cy5 log-signals before qspline normalization is shown to
          correct for some of this effect, although this method
          does not directly scale the 
          R / 
          <ENAMEX TYPE="ORGANIZATION">G</ENAMEX> log-ratios. The scaled print-tip
          <ENAMEX TYPE="ORGANIZATION">lowess</ENAMEX> first performs regressions by print-tip <ENAMEX TYPE="ORG_DESC">group</ENAMEX>,
          followed by tip-group scaling of the log-ratios and, not
          surprisingly, generates the most comparable print-tip
          log-ratio distributions. The preliminary spatial scaling
          <ENAMEX TYPE="PERSON">technique</ENAMEX> also normalizes log-ratio information and can
          be seen to generate comparable print-tip log-ratio
          distributions.
          Spatial effects can be more or less dependent on the
          print-tip <ENAMEX TYPE="ORG_DESC">group</ENAMEX>, depending on the strength of the other
          spatial effects. Figure 9shows an example from the
          dye-swap experiment where gradient effects tended to be
          as large as the print-tip effects. Tip-group
          <ENAMEX TYPE="ORGANIZATION">normalization</ENAMEX> alone can be seen still to contain spatial
          <ENAMEX TYPE="PERSON">bias</ENAMEX> within each tip sector. <ENAMEX TYPE="ORGANIZATION">Spatial</ENAMEX> log-ratio
          <ENAMEX TYPE="ORGANIZATION">normalization</ENAMEX> after global normalization can be seen to
          give the most homogeneous log-ratio signals across the
          surface of the array. An example oligonucleotide array is
          shown before and after spatial normalization, along with
          the values that were used for the normalization in Figure
          <TIMEX TYPE="DATE">10</TIMEX>. The distribution of the log-signal differences used
          for the spatial normalization had a MAD of <NUMEX TYPE="MONEY">0.014</NUMEX> for
          Affymetrix data compared to <NUMEX TYPE="MONEY">0.3</NUMEX> for the cDNA array data
          of the 
          <ENAMEX TYPE="PERSON">glnA</ENAMEX> experiment, suggesting that
          <ENAMEX TYPE="NATIONALITY">spatial</ENAMEX> bias is more than <NUMEX TYPE="CARDINAL">ten</NUMEX> times stronger for cDNA
          array data.
        
        
          Biological assessment of normalization
          A set of <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> was known to be differentially
          regulated in the 
          glnA mutant strain of 
          <ENAMEX TYPE="ORGANIZATION">B.</ENAMEX> <ENAMEX TYPE="SUBSTANCE">subtilis</ENAMEX>. These <NUMEX TYPE="CARDINAL">41</NUMEX> <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> were
          found to rank higher in a 
          <ENAMEX TYPE="ORGANIZATION">t</ENAMEX> -test analysis after
          <ENAMEX TYPE="ORGANIZATION">signal-dependent</ENAMEX> normalization compared to rankings from
          <ENAMEX TYPE="ORGANIZATION">unnormalized</ENAMEX> and scaled log-signals (Figure <NUMEX TYPE="CARDINAL">11</NUMEX>). A paired
          <ENAMEX TYPE="ORGANIZATION">Welch</ENAMEX> 
          <ENAMEX TYPE="ORGANIZATION">t</ENAMEX>- test was performed on the
          individual <TIMEX TYPE="DATE">Cy5 and Cy3</TIMEX> signals for each gene. The top <NUMEX TYPE="CARDINAL">20</NUMEX>
          ranking genes can be seen in Figure <NUMEX TYPE="CARDINAL">12</NUMEX>, where the genes
          known to be differentially regulated are shown in
          <ENAMEX TYPE="ORGANIZATION">parentheses</ENAMEX> and up- or downregulation is shown in red or
          green, respectively. Unnormalized data rankings showed
          <NUMEX TYPE="CARDINAL">only one</NUMEX> of the <NUMEX TYPE="CARDINAL">41</NUMEX> <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> in the top <NUMEX TYPE="CARDINAL">20</NUMEX> and overall these
          genes had an average rank corresponding to the 51st
          percentile, as would be expected from randomly selected
          genes. Log-signal scaling shifted the rankings of these
          genes to an average rank corresponding to the 20th
          percentile, whereas signal-dependent normalizations
          raised the average rank to correspond with <TIMEX TYPE="DATE">the 8th</TIMEX> to 9th
          <ENAMEX TYPE="ORGANIZATION">percentile</ENAMEX> (<NUMEX TYPE="CARDINAL">2nd</NUMEX> to <NUMEX TYPE="CARDINAL">3rd</NUMEX> percentile for the median rank).
          <NUMEX TYPE="CARDINAL">Seven</NUMEX> of the <NUMEX TYPE="CARDINAL">41</NUMEX> <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> can be seen in the top <NUMEX TYPE="CARDINAL">20</NUMEX> after
          scaled print-tip lowess and qspline. The spatial
          <ENAMEX TYPE="ORGANIZATION">normalization</ENAMEX> approach appears to adversely effect the
          top <NUMEX TYPE="CARDINAL">20</NUMEX> ranking genes though the resulting mean and median
          ranks of the <NUMEX TYPE="CARDINAL">41</NUMEX> <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> were comparable or better than the
          other approaches. The lowest average rank was observed
          for the global qspline method (<NUMEX TYPE="MONEY">8.1 percentile</NUMEX>) followed
          closely by global and print-tip lowess both at the <NUMEX TYPE="CARDINAL">8.5</NUMEX>
          <ENAMEX TYPE="ORGANIZATION">percentile</ENAMEX>. The lowest median rank was seen for the
          spatial normalization results (<NUMEX TYPE="MONEY">1.9 percentile</NUMEX>) followed
          by global qspline (<NUMEX TYPE="MONEY">2.4</NUMEX>) and print-tip qspline (<NUMEX TYPE="MONEY">2.7</NUMEX>).
          
          <ENAMEX TYPE="ORGANIZATION">t</ENAMEX> -tests were applied to
          <ENAMEX TYPE="PERSON">gene</ENAMEX>-expression estimates calculated from the <ENAMEX TYPE="PERSON">Li</ENAMEX> and <ENAMEX TYPE="PERSON">Wong</ENAMEX>
          [ <ENAMEX TYPE="LAW">1</ENAMEX>] reduced model for the oligonucleotide array data.
          Unfortunately, the set of <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> believed to be
          differentially regulated due to <ENAMEX TYPE="DISEASE">HIV</ENAMEX> infection was found
          to be randomly distributed throughout the two sample 
          <ENAMEX TYPE="ORGANIZATION">t</ENAMEX> -test rankings both before and
          after different normalizations. The overall effects of
          normalization on the 
          <ENAMEX TYPE="ORGANIZATION">p</ENAMEX> -values can be seen for the <ENAMEX TYPE="ORGANIZATION">HIV</ENAMEX>
          and 
          <ENAMEX TYPE="ORGANIZATION">glnA</ENAMEX> experiments in Figure <NUMEX TYPE="CARDINAL">12</NUMEX>. For
          this comparison, only the relative characteristics
          between normalization methods are of interest. The actual
          
          <ENAMEX TYPE="ORGANIZATION">p</ENAMEX> -values are not correct as a
          result of multiple testing. Log rank versus log 
          <ENAMEX TYPE="ORGANIZATION">p</ENAMEX> -value plots show differing
          trends for oligonucleotide and cDNA array data.
          Unnormalized data show lower 
          <ENAMEX TYPE="ORGANIZATION">p</ENAMEX> -values for <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> in the lower
          half of the ranking in cDNA because of the dye bias and
          lack of dye swapping over the <NUMEX TYPE="CARDINAL">six</NUMEX> replicates, and suggest
          poorer signal-to-noise characteristics. Lack of
          <ENAMEX TYPE="ORGANIZATION">normalization</ENAMEX> in the <ENAMEX TYPE="ORGANIZATION">HIV</ENAMEX> experiment showed less
          significant 
          <ENAMEX TYPE="ORGANIZATION">p</ENAMEX> -values over all genes.
          Log-signal scaling showed slightly higher 
          <ENAMEX TYPE="ORGANIZATION">p</ENAMEX> -values whereas lowess, invariant
          set and qspline showed comparably lower 
          <ENAMEX TYPE="ORGANIZATION">p</ENAMEX> -values.
        
      
      
        Discussion
        <NUMEX TYPE="CARDINAL">Three</NUMEX> important assumptions must hold for
        <ENAMEX TYPE="ORGANIZATION">signal-dependent</ENAMEX> normalization methods. The <NUMEX TYPE="ORDINAL">first</NUMEX> <NUMEX TYPE="CARDINAL">two</NUMEX> were
        suggested by Zien 
        et al. [ <TIMEX TYPE="DATE">18</TIMEX>] in their linear
        <ENAMEX TYPE="ORGANIZATION">centralization</ENAMEX> approach: the majority of genes are not
        differentially regulated (assumption <NUMEX TYPE="CARDINAL">1</NUMEX>); and the number of
        upregulated genes roughly equals the number downregulated
        (assumption <NUMEX TYPE="CARDINAL">2</NUMEX>). The <NUMEX TYPE="ORDINAL">third</NUMEX> assumption is that these two
        assumptions hold across the signal-intensity range.
        <ENAMEX TYPE="CONTACT_INFO">Assumption 1</ENAMEX> was used as a justification for centering
        log-ratio distributions and is likely to hold when an
        unbiased selection of <NUMEX TYPE="CARDINAL">thousands</NUMEX> of genes is measured. If
        <ENAMEX TYPE="CONTACT_INFO">assumption 1</ENAMEX> is true, then assumption <NUMEX TYPE="CARDINAL">2</NUMEX> can be relaxed as
        long as random effects on non-differentially expressed
        genes are equally positive and negative. The <NUMEX TYPE="ORDINAL">third</NUMEX>
        assumption is important for signal-dependent normalizations
        and is supported by the intuition that genes with <NUMEX TYPE="CARDINAL">100</NUMEX> to
        1,000 mRNA copies per <ENAMEX TYPE="FAC_DESC">cell</ENAMEX> will be no more or less biased
        toward up- or downregulation than genes with <NUMEX TYPE="CARDINAL">10,000</NUMEX> to
        <NUMEX TYPE="CARDINAL">100,000</NUMEX> copies per cell. Microarrays with a small number of
        genes may be biased to <NUMEX TYPE="CARDINAL">over</NUMEX>- or underexpression and could
        generate data that do not conform to any of the listed
        assumptions. We believe that future microarrays will only
        include more features and <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX>, making these assumptions
        even more valid. In <TIMEX TYPE="DATE">coming years</TIMEX>, oligonucleotide arrays
        for <ENAMEX TYPE="PER_DESC">humans</ENAMEX> will contain <NUMEX TYPE="CARDINAL">all 35,000</NUMEX> <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> (or however many
        there may be) and therefore will not contain a biased
        selection of genes.
        A potential <NUMEX TYPE="ORDINAL">fourth</NUMEX> assumption motivates spatial- or
        pin-specific normalization and would state that assumption
        <ENAMEX TYPE="PRODUCT">2</ENAMEX> should hold spatially across the surface of the array.
        These effects were observed to be more significant for cDNA
        microarrays, whereas global signal-dependent biases
        dominated over spatial effects for oligonucleotide array
        <ENAMEX TYPE="ORGANIZATION">data</ENAMEX>. The <ENAMEX TYPE="ORGANIZATION">MAD</ENAMEX> for the difference of log(PM) before and
        after global normalization was <NUMEX TYPE="CARDINAL">30</NUMEX> times larger than the <ENAMEX TYPE="ORGANIZATION">MAD</ENAMEX>
        of the difference between globally normalized and spatially
        <ENAMEX TYPE="ORGANIZATION">normalized</ENAMEX> (<NUMEX TYPE="CARDINAL">0.3</NUMEX> versus <NUMEX TYPE="MONEY">0.01</NUMEX>). For the 
        <ENAMEX TYPE="PERSON">glnA</ENAMEX> experiment, the spatial effect
        as measured by a similar MAD was <NUMEX TYPE="CARDINAL">ten</NUMEX> times larger than that
        of the <ENAMEX TYPE="ORGANIZATION">HIV</ENAMEX> experiment but still <NUMEX TYPE="CARDINAL">roughly ten</NUMEX> times smaller
        than the global cDNA effects (<NUMEX TYPE="CARDINAL">1.3</NUMEX> versus <NUMEX TYPE="MONEY">0.1</NUMEX>). Although
        spatial effects may not always be significant,
        probe-specific effects are a significant issue for
        oligonucleotide arrays, and must be addressed by other
        techniques such as the method of <ENAMEX TYPE="PERSON">Li</ENAMEX> and <ENAMEX TYPE="PERSON">Wong</ENAMEX> [ <ENAMEX TYPE="LAW">2</ENAMEX>]. The
        preliminary spatial normalization method presented in this
        work will require further validation and development as the
        current method, by visual inspection, appears to be
        overfitting the cDNA data. Probe placement and microarray
        designs do not always correctly randomize strongly or
        <ENAMEX TYPE="ORGANIZATION">weakly</ENAMEX> expressed genes, and may contain spatial biases that
        should not be removed. That said, the ranking of genes
        known to be regulated did not change significantly as a
        result of this overfitting.
        The process of comparing and validating these methods
        should depend most heavily on the biological assessment.
        Unfortunately, this evidence was found to be the most
        <ENAMEX TYPE="PERSON">unreliable</ENAMEX>. Genes from the list that were known to be
        differentially regulated were found throughout the 
        <ENAMEX TYPE="ORGANIZATION">t</ENAMEX> -test ranking in both the <ENAMEX TYPE="DISEASE">HIV</ENAMEX> and
        the 
        <ENAMEX TYPE="ORGANIZATION">glnA</ENAMEX> experiments. <ENAMEX TYPE="ORGANIZATION">Statistical</ENAMEX>
        measures, such as reproducibility, were less ambiguous, but
        showed similar performance for global and print-tip,
        although clear print-tip biases were present. Each
        <ENAMEX TYPE="ORGANIZATION">microarray</ENAMEX> <ENAMEX TYPE="ORG_DESC">system</ENAMEX> presented different <ENAMEX TYPE="PER_DESC">sources</ENAMEX> of bias and
        in <TIMEX TYPE="DATE">the end</TIMEX>, no one criterion was sufficient for assessing
        whether microarray data was properly normalized. Observing
        global, signal-dependent and spatially dependent
        distributions is recommended in all cases.
      
      
        Conclusions
        Assessments of normalizations were shown globally for
        array signal and relative signal distributions as well as
        for signal-dependent <ENAMEX TYPE="ORGANIZATION">MA</ENAMEX>-style plots and medians of relative
        signals by quartile. In all cases, these analyses showed
        favorable results for lowess, invariant set and qspline
        methods. Certain aspects of the spline-based methods make
        it preferable to the other methods. First, the qspline
        method is computationally more efficient than the lowess
        methods; <NUMEX TYPE="ORDINAL">second</NUMEX>, owing to the random sampling procedure,
        <ENAMEX TYPE="GPE">lowess</ENAMEX>-based methods will give slightly different results
        for each data fitting whereas the spline methods are
        <ENAMEX TYPE="ORGANIZATION">deterministic</ENAMEX>; and <NUMEX TYPE="ORDINAL">third</NUMEX>, the quantile-based approach of
        <ENAMEX TYPE="ORGANIZATION">qspline</ENAMEX> can normalize arrays with different numbers of
        features. Only through <ENAMEX TYPE="PER_DESC">population</ENAMEX>-based methods, such as
        qspline, can arrays with different features be normalized
        for signal dependent bias.
      
      
        Materials and methods
        
          T-cell cultures infected with <ENAMEX TYPE="ORGANIZATION">HIV</ENAMEX>
          <NUMEX TYPE="CARDINAL">Ten million</NUMEX> MT-<NUMEX TYPE="CARDINAL">4</NUMEX> cells were incubated with either <NUMEX TYPE="CARDINAL">1</NUMEX> ml
          virus stock (<NUMEX TYPE="CARDINAL">2</NUMEX> multiplicity of infection (<ENAMEX TYPE="ORGANIZATION">MOI</ENAMEX>) units of
          <ENAMEX TYPE="ORGANIZATION">strain IIIB</ENAMEX>) or <NUMEX TYPE="CARDINAL">1</NUMEX> ml mock virus for <TIMEX TYPE="TIME">3 h</TIMEX> at <TIMEX TYPE="DATE">37°C</TIMEX>. After
          extensive washing the cells were transferred to <NUMEX TYPE="CARDINAL">80</NUMEX> cm
          3Nunclon bottles in <TIMEX TYPE="DATE">20</TIMEX> ml culture medium (RPMI <TIMEX TYPE="DATE">1640</TIMEX> with
          <NUMEX TYPE="PERCENT">10%</NUMEX> fetal calf serum and antibiotics) and cultured at
          37°C, <NUMEX TYPE="PERCENT">5%</NUMEX> <ENAMEX TYPE="ORGANIZATION">CO</ENAMEX> 
          <NUMEX TYPE="CARDINAL">2</NUMEX> for <TIMEX TYPE="DATE">7 days</TIMEX>. <ENAMEX TYPE="SUBSTANCE">Messenger RNA</ENAMEX> was
          extracted using <ENAMEX TYPE="ORGANIZATION">QIAGEN RNeasy Mini</ENAMEX> kit and prepared for
          <ENAMEX TYPE="ORGANIZATION">hybridization</ENAMEX> to <ENAMEX TYPE="ORGANIZATION">Affymetrix HuGeneFL</ENAMEX> chips according to
          protocols provided by <ENAMEX TYPE="ORGANIZATION">Affymetrix</ENAMEX>.
          The <ENAMEX TYPE="ORGANIZATION">Affymetrix HuGeneFL</ENAMEX> arrays contain <NUMEX TYPE="CARDINAL">about 1.4</NUMEX> × <NUMEX TYPE="CARDINAL">10</NUMEX>
          5PM, <ENAMEX TYPE="PRODUCT">MM</ENAMEX> <ENAMEX TYPE="PRODUCT_DESC">probe</ENAMEX> pairs. Probe-based normalization was found
          to work on both <ENAMEX TYPE="ORGANIZATION">PM</ENAMEX> and pooled <ENAMEX TYPE="ORGANIZATION">PM</ENAMEX>, <ENAMEX TYPE="ORGANIZATION">MM</ENAMEX> values, although the
          <ENAMEX TYPE="ORGANIZATION">MM</ENAMEX> values were ignored in this analysis (We believe that
          <ENAMEX TYPE="ORGANIZATION">MM</ENAMEX> values are unreliable indicators of
          <ENAMEX TYPE="ORGANIZATION">cross-hybridization</ENAMEX> and can be shown to have a
          confounding effect on all but the top <NUMEX TYPE="PERCENT">20%</NUMEX> of the signal
          intensity range.) <ENAMEX TYPE="ORGANIZATION">Control</ENAMEX> features designed for grid
          alignment, spiked controls and <ENAMEX TYPE="ORGANIZATION">ALU</ENAMEX> controls ("<ENAMEX TYPE="WORK_OF_ART">AFFX</ENAMEX>",
          "hum_alu") were removed.
        
        
          Bacilluscultures on cDNA microarrays
          Cells were grown at <NUMEX TYPE="ORDINAL">37°C</NUMEX> in a modified Spizizen
          <ENAMEX TYPE="GPE">salt</ENAMEX>-buffered minimal medium as described previously [
          <NUMEX TYPE="CARDINAL">19</NUMEX>] supplemented with <ENAMEX TYPE="PRODUCT">100 μg/ml L</ENAMEX>-tryptophan. Na 
          <TIMEX TYPE="TIME">2 SO</TIMEX> 
          <NUMEX TYPE="CARDINAL">4</NUMEX> was used instead of (<ENAMEX TYPE="ORGANIZATION">NH</ENAMEX> 
          <NUMEX TYPE="CARDINAL">4</NUMEX> ) 
          <TIMEX TYPE="TIME">2 SO</TIMEX> 
          <NUMEX TYPE="CARDINAL">4</NUMEX> and glutamine (<NUMEX TYPE="PERCENT">0.2%</NUMEX>) was added as
          the sole nitrogen <ENAMEX TYPE="PER_DESC">source</ENAMEX>. At an <ENAMEX TYPE="ORGANIZATION">OD</ENAMEX> = <NUMEX TYPE="CARDINAL">1</NUMEX> (<NUMEX TYPE="MONEY">450 nm</NUMEX>),
          <NUMEX TYPE="PERCENT">approximately</NUMEX> <TIMEX TYPE="DATE">100</TIMEX> ml of culture was harvested by
          centrifugation at <NUMEX TYPE="CARDINAL">7,000</NUMEX> rpm for <NUMEX TYPE="CARDINAL">5</NUMEX> min. The pellet was
          <ENAMEX TYPE="ORGANIZATION">resuspended</ENAMEX> in <NUMEX TYPE="QUANTITY">400 μl</NUMEX> water and <ENAMEX TYPE="SUBSTANCE">RNA</ENAMEX> was isolated from
          this by the use of <NUMEX TYPE="CARDINAL">four</NUMEX> tubes from the fastRNA kit blue
          (<NUMEX TYPE="MONEY">BIO 101</NUMEX>, <ENAMEX TYPE="GPE">Carlsbad</ENAMEX>, CA) and as recommended by the
          <ENAMEX TYPE="GPE">supplier</ENAMEX>. cDNA synthesis, dye coupling of <ENAMEX TYPE="PRODUCT_DESC">probe</ENAMEX>, array,
          <ENAMEX TYPE="ORGANIZATION">hybridization</ENAMEX> and scanning were carried out as described
          by <ENAMEX TYPE="ORGANIZATION">DeRisi</ENAMEX> and <ENAMEX TYPE="PER_DESC">co-workers</ENAMEX> (protocol available at [ <TIMEX TYPE="DATE">20</TIMEX>]).
          <ENAMEX TYPE="SUBSTANCE">RNA preparations</ENAMEX> were run in duplicate and each sample
          was hybridized to triplicate arrays. In all cases the
          <ENAMEX TYPE="ORGANIZATION">control</ENAMEX> <ENAMEX TYPE="SUBSTANCE">RNA</ENAMEX> was labeled with <ENAMEX TYPE="PRODUCT">Cy5</ENAMEX> and treatment <ENAMEX TYPE="SUBSTANCE">RNA</ENAMEX> with
          Cy3. Each of the <NUMEX TYPE="CARDINAL">4,100</NUMEX> <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> was spotted on the array
          twice, which gave <NUMEX TYPE="CARDINAL">12</NUMEX> measurements per <ENAMEX TYPE="SUBSTANCE">gene</ENAMEX> per
          experiment.
        
        
          Microarray normalization
          The variance within replicate <ENAMEX TYPE="ORG_DESC">group</ENAMEX> was estimated for
          each <ENAMEX TYPE="PER_DESC">normalization</ENAMEX> described below,
          
          where 
          i is an index over 
          <ENAMEX TYPE="ORGANIZATION">n</ENAMEX> probe signals, and 
          <ENAMEX TYPE="PERSON">j</ENAMEX> is an index over 
          <ENAMEX TYPE="ORGANIZATION">m</ENAMEX> replicates.
        
        
          Global scaling of log intensities
          As a comparison with the signal-dependent qspline and
          <ENAMEX TYPE="PER_DESC">lowess</ENAMEX> approaches, a scaling of log intensities was
          carried out as follows. <ENAMEX TYPE="PRODUCT_DESC">Probe intensities</ENAMEX> were
          log-transformed (in all cases, we used log base <NUMEX TYPE="CARDINAL">2</NUMEX> on
          <ENAMEX TYPE="ORGANIZATION">signal</ENAMEX>-intensity data) and a measure of central tendency,
          
          c 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           , was calculated for each array and for the entire
          <ENAMEX TYPE="ORGANIZATION">matrix</ENAMEX> ( 
          c ). The mean of the log values was
          used but the median was found to work just as well. Each
          array was then scaled in the log-space to the global
          mean, log( 
          x 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           )( 
          c / 
          c 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           ). This simple transformation often accounted for
          much of the variability between oligonucleotide arrays.
          The approach used on cDNA array data scaled <TIMEX TYPE="DATE">each Cy3</TIMEX> and
          Cy5 <ENAMEX TYPE="ORG_DESC">channel</ENAMEX> to the same central tendency with the
          additional constraint that each print-tip <ENAMEX TYPE="ORG_DESC">group</ENAMEX> also had
          the same <ENAMEX TYPE="SUBSTANCE">Cy3</ENAMEX> and <ENAMEX TYPE="PRODUCT">Cy5</ENAMEX> central tendency.
        
        
          Lowess normalizations
          The <ENAMEX TYPE="ORGANIZATION">Affymetrix</ENAMEX> normalization method found in the Raffy
          module of the sma package uses the lowess function
          ('loess') with a robust local linear regression mode
          ('symmetric'). The <ENAMEX TYPE="ORGANIZATION">Raffy</ENAMEX> method performed all pairwise
          normalizations between the <NUMEX TYPE="CARDINAL">six</NUMEX> <ENAMEX TYPE="ORGANIZATION">HIV</ENAMEX> arrays and averaged
          the <NUMEX TYPE="CARDINAL">five</NUMEX> results ( 
          <ENAMEX TYPE="CONTACT_INFO">m -1</ENAMEX>) for each array. The process
          was then repeated on the new data, which resulted in <TIMEX TYPE="DATE">30</TIMEX>
          total fits for the <NUMEX TYPE="CARDINAL">six</NUMEX> arrays. Instead of averaging all
          pairwise array regressions on a single random sample of
          feature pairs, the modified version averaged iterative
          regressions between each array and the target array using
          a new random sample on each iteration. This resulted in
          <NUMEX TYPE="CARDINAL">18</NUMEX> total fits for the <NUMEX TYPE="CARDINAL">six</NUMEX> arrays. The former method
          tended to undernormalize and did not perform as well as
          simple log-intensity scaling. The adapted method used
          essentially the same procedure and code but performed
          significantly better when used in this scheme.
          The <NUMEX TYPE="CARDINAL">six</NUMEX> replicates for each 
          <ENAMEX TYPE="ORGANIZATION">glnA</ENAMEX> and 
          <ENAMEX TYPE="PERSON">tnrA</ENAMEX> experiment were normalized to
          a prototype, 
          <ENAMEX TYPE="PERSON">v</ENAMEX> , denned by the median or geometric
          mean of the <NUMEX TYPE="CARDINAL">six</NUMEX> Cy3 <ENAMEX TYPE="ORG_DESC">channels</ENAMEX> used to measure the control
          <ENAMEX TYPE="ORGANIZATION">mRNA</ENAMEX> (wild type). By this method, all <NUMEX TYPE="CARDINAL">12</NUMEX> channels from
          the <NUMEX TYPE="CARDINAL">six</NUMEX> <ENAMEX TYPE="PER_DESC">arrays</ENAMEX> were normalized to each other and at the
          same time the <NUMEX TYPE="ORDINAL">Cy5</NUMEX> <ENAMEX TYPE="ORG_DESC">channels</ENAMEX> were normalized to the Cy3
          channels. The cDNA normalization method found in the
          Rarray module of the sma package uses the lowess function
          ('lowess') with analogous settings as described for
          oligonucleotide array normalization. Both global and
          scaled print-tip <ENAMEX TYPE="ORG_DESC">group</ENAMEX> lowess normalization were
          performed (norm = 'l' and norm = 's', respectively). The
          scaled print-tip mode performed lowess normalization for
          within each print-tip <ENAMEX TYPE="ORG_DESC">group</ENAMEX> and then scaled the
          log-ratios of each group by its respective MAD [ <TIMEX TYPE="DATE">11</TIMEX>].
        
        
          Cubic spline normalization using quantiles
          For this approach, all signal channels are normalized
          to a target array. The same method was used for cDNA and
          oligonucleotide array data.
          The geometric mean of each <ENAMEX TYPE="PRODUCT_DESC">probe</ENAMEX> was calculated over
          all arrays, 
          x 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           , in the experiment,
          
          where 
          j indexed over the 
          <ENAMEX TYPE="ORGANIZATION">m</ENAMEX> = <NUMEX TYPE="CARDINAL">6</NUMEX> arrays and 
          i indexed over the 
          <ENAMEX TYPE="ORGANIZATION">n</ENAMEX> probes.
          From each array and the vector 
          <ENAMEX TYPE="PERSON">v</ENAMEX> , <NUMEX TYPE="CARDINAL">100</NUMEX> quantiles were taken, 
          q 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           and 
          q 
          
            v 
           (<NUMEX TYPE="MONEY">percentiles</NUMEX>). The size of the quantile sample
          represented < <NUMEX TYPE="PERCENT">0.1%</NUMEX> of 
          <ENAMEX TYPE="ORGANIZATION">n</ENAMEX> . Figure 1shows an example
          comparison of array signal distributions 
          x 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           and 
          v along with <NUMEX TYPE="QUANTITY">a quantile-quantile</NUMEX> plot
          showing the correlation between the corresponding 
          q 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           and 
          q 
          
            v 
           . Each 
          q 
          
            v 
           , 
          q 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           pair was used to fit a <NUMEX TYPE="QUANTITY">cubic spline</NUMEX> function, 
          <ENAMEX TYPE="ORGANIZATION">s</ENAMEX> 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           = 
          f ( 
          q 
          
            v 
           , 
          q 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           ), where 
          f was a spline function generator
          that fits the parameters of a natural cubic spline
          (B-spline). The splinefun function in the <ENAMEX TYPE="NATIONALITY">R</ENAMEX> base package
          was used for this purpose. Spline parameters were fit for
          each interval <TIMEX TYPE="DATE">between consecutive quantiles</TIMEX>. The
          interpolating spline function defined over the 
          <ENAMEX TYPE="ORGANIZATION">k th</ENAMEX> interval, is defined for the
          parameters 
          a 
          
            jk 
           and 
          <ENAMEX TYPE="ORGANIZATION">y</ENAMEX> 
          
            jk 
           in <ENAMEX TYPE="FAC">Equation 3</ENAMEX>. For <NUMEX TYPE="QUANTITY">an unsmoothed cubic spline</NUMEX>, 
          <ENAMEX TYPE="ORGANIZATION">y</ENAMEX> 
          
            jk 
           = 
          q 
          
            vk 
           ,
          
          <ENAMEX TYPE="ORGANIZATION">s</ENAMEX> 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           ( 
          x ) = 
          a 
          
          jk <NUMEX TYPE="CARDINAL">1</NUMEX> + 
          a 
          
          <ENAMEX TYPE="ORGANIZATION">jk</ENAMEX> 2 ( 
          x - 
          <ENAMEX TYPE="ORGANIZATION">y</ENAMEX> 
          
            jk 
           ) + 
          a 
          
          <ENAMEX TYPE="ORGANIZATION">jk</ENAMEX> 3 ( 
          x - 
          <ENAMEX TYPE="ORGANIZATION">y</ENAMEX> 
          
            jk 
           ) <NUMEX TYPE="CARDINAL">2</NUMEX>+ 
          a 
          
          <ENAMEX TYPE="ORGANIZATION">jk</ENAMEX> 4 ( 
          x - 
          <ENAMEX TYPE="ORGANIZATION">y</ENAMEX> 
          
            jk 
           ) <ENAMEX TYPE="PRODUCT">3   </ENAMEX> (<ENAMEX TYPE="CONTACT_INFO">3</ENAMEX>)
          In an iterative approach, quantiles were resampled
          from <ENAMEX TYPE="ORG_DESC">percentiles</ENAMEX> shifted by a small offset 
          <ENAMEX TYPE="ORGANIZATION">np</ENAMEX> 
          <ENAMEX TYPE="CONTACT_INFO">0 /</ENAMEX> 
          <ENAMEX TYPE="ORGANIZATION">k</ENAMEX> where 
          p 
          <NUMEX TYPE="CARDINAL">0</NUMEX> was the <NUMEX TYPE="ORDINAL">first</NUMEX> percentile and 
          <ENAMEX TYPE="ORGANIZATION">k</ENAMEX> the number of iterations (defines
          the difference in rank <TIMEX TYPE="DATE">between consecutive quantiles</TIMEX>).
          This provided a different set of evenly spaced quantiles
          for each curve fitting. For the normalizations performed
          here, the results from <NUMEX TYPE="CARDINAL">five</NUMEX> <ENAMEX TYPE="PER_DESC">interpolations</ENAMEX> were averaged.
          The qspline method was implemented in <ENAMEX TYPE="NATIONALITY">R</ENAMEX> and included in
          the <ENAMEX TYPE="GPE">Bioconductor</ENAMEX> package, which will be described
          elsewhere and is available from the web [ <TIMEX TYPE="DATE">21</TIMEX>].
          <ENAMEX TYPE="ORGANIZATION">Data</ENAMEX> for <ENAMEX TYPE="SUBSTANCE">cDNA</ENAMEX> experiments were qspline normalized with
          percentile <ENAMEX TYPE="SUBSTANCE">samples</ENAMEX> and fitted in an iterative approach as
          described for the oligonucleotide arrays. The signal
          distributions were found to contain many non-smooth
          features not common for both <ENAMEX TYPE="ORG_DESC">channels</ENAMEX>. To account for the
          print-tip effect, an additional normalization was
          performed where <ENAMEX TYPE="SUBSTANCE">Cy3</ENAMEX> and <ENAMEX TYPE="PRODUCT">Cy5</ENAMEX> signals were scaled within
          each print-tip <ENAMEX TYPE="ORG_DESC">group</ENAMEX>, as described in global scaling of
          log intensities, before qspline normalization as just
          described.
        
        
          Spatial normalization
          Local signal (log-ratio) was estimated for each probe
          using a weighted mean of neighboring probe signals. A
          sliding square window centered on the each <ENAMEX TYPE="PRODUCT_DESC">probe</ENAMEX> (<NUMEX TYPE="CARDINAL">50 × 50</NUMEX>
          for oligonucleotide arrays, and <NUMEX TYPE="MONEY">10 × 10</NUMEX> for cDNA) was
          used to define the local neighborhood. Weights were
          defined by their Euclidean distance to the center probe
          using a <ENAMEX TYPE="ORGANIZATION">Gaussian</ENAMEX> function (standard deviation <NUMEX TYPE="CARDINAL">19</NUMEX> for <NUMEX TYPE="CARDINAL">50</NUMEX> ×
          <NUMEX TYPE="CARDINAL">50</NUMEX> neighborhood and <NUMEX TYPE="CARDINAL">3</NUMEX> for the <NUMEX TYPE="CARDINAL">10 × 10</NUMEX> neighborhood). For
          both oligonucleotide and cDNA array data, this adjustment
          was made after global qspline normalization.
        
      
      
        Additional data files
        Additional data files showing <ENAMEX TYPE="SUBSTANCE">MA plots</ENAMEX> and signal
        distributions from all the <ENAMEX TYPE="ORGANIZATION">HIV</ENAMEX>, glnA, tnrAarrays for the
        different normalizations are available with the online
        version of this paper and at [ <TIMEX TYPE="DATE">17</TIMEX>].
        Additional data file 1
        <ENAMEX TYPE="ORGANIZATION">MA</ENAMEX> plots and signal distributions from all the <ENAMEX TYPE="ORGANIZATION">HIV</ENAMEX>
        arrays
        <ENAMEX TYPE="ORGANIZATION">MA</ENAMEX> plots and signal distributions from all the <ENAMEX TYPE="ORGANIZATION">HIV</ENAMEX>
        arrays
        Click here for additional data file
        Additional data file 2
        <ENAMEX TYPE="ORGANIZATION">MA</ENAMEX> plots and signal distributions from all the glnA
        arrays
        <ENAMEX TYPE="ORGANIZATION">MA</ENAMEX> plots and signal distributions from all the glnA
        arrays
        Click here for additional data file
        Additional data file 3
        <ENAMEX TYPE="ORGANIZATION">MA</ENAMEX> plots and signal distributions from all the tnrA
        arrays
        <ENAMEX TYPE="ORGANIZATION">MA</ENAMEX> plots and signal distributions from all the tnrA
        arrays
        Click here for additional data file
      
    
  
