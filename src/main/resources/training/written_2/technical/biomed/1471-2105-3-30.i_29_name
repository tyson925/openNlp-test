
  
    
      
        Background
        In higher eukaryotes, many genes feature differential
        spatial-temporal expression during development and
        throughout the life cycle of the <ENAMEX TYPE="SUBSTANCE">organism</ENAMEX>. Their complex
        transcription regulation is thought to be achieved by the
        <ENAMEX TYPE="ORGANIZATION">combinatorial</ENAMEX> action of multiple transcription factors
        which bind to 
        cis- regulatory <ENAMEX TYPE="SUBSTANCE">DNA sequences</ENAMEX>. Here,
        transcription factors are defined as <ENAMEX TYPE="SUBSTANCE">proteins</ENAMEX> which
        recognize and bind regulatory sites and have a potential to
        modulate directly or indirectly through the recruitment of
        cofactors the activity of the basal transcriptional
        apparatus of <ENAMEX TYPE="SUBSTANCE">proximal genes</ENAMEX>. The number of transcription
        factors is a substantial part of the total number of genes
        in any <ENAMEX TYPE="SUBSTANCE">organism</ENAMEX>, for example <NUMEX TYPE="CARDINAL">about 700</NUMEX> out of <NUMEX TYPE="CARDINAL">13,500</NUMEX> <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX>
        in <ENAMEX TYPE="GPE">Drosophila</ENAMEX> [ <ENAMEX TYPE="LAW">1</ENAMEX> ] .
        Although combinatorial action of transcription factors
        has been studied throughout the life cycle of <ENAMEX TYPE="ANIMAL">organisms</ENAMEX> [ <NUMEX TYPE="CARDINAL">2</NUMEX>
        ] , perhaps the most coherent picture has emerged in the
        context of developmental processes [ <NUMEX TYPE="CARDINAL">3 4</NUMEX> ] . Here, a great
        number of experiments suggest that a major part of the gene
        regulatory apparatus is organized in the form of separable 
        cis- regulatory <ENAMEX TYPE="ORG_DESC">modules</ENAMEX> [ <ENAMEX TYPE="LAW">3</ENAMEX> ] . A
        given <ENAMEX TYPE="ORG_DESC">module</ENAMEX> defines specific aspects of the
        spatio-temporal pattern of gene expression by the
        <ENAMEX TYPE="ORGANIZATION">combinatorial</ENAMEX> action of multiple transcription factors
        which together define the rate of transcription. Modules
        thus integrate inputs from several <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> and regulate
        another gene to form developmental networks. <ENAMEX TYPE="ORGANIZATION">Modules</ENAMEX> seem
        to share several architectural features [ <ENAMEX TYPE="LAW">5</ENAMEX> ] : They are
        typically only <NUMEX TYPE="CARDINAL">hundreds</NUMEX> of nucleotides in length and
        contain multiple binding sites for <NUMEX TYPE="CARDINAL">as many as 4</NUMEX>-<NUMEX TYPE="CARDINAL">5</NUMEX> different
        transcription factors. The frequent occurence of multiple
        copies of the same motif as well as the enrichment of
        certain combinations of motifs in a module in comparison
        with the genome at large provide the basis for our
        computational strategies to predict genes which are part of
        the same regulatory <ENAMEX TYPE="ORG_DESC">network</ENAMEX>. Existing algorithms for
        discovering modules [ <NUMEX TYPE="CARDINAL">6 7 8</NUMEX> ] are based on counting the
        number of matches of a certain minimal strength to known
        <ENAMEX TYPE="PERSON">motifs</ENAMEX> and thus require ad-hoc parameters for each motif,
        resulting in <TIMEX TYPE="DATE">parameter</TIMEX> dependent predictions. These
        algorithms are also bound to miss multiple weak binding
        sites which are known to be present in many modules. We
        demonstrate a novel algorithm, <ENAMEX TYPE="GPE">Ahab</ENAMEX>, which overcomes these
        problems.
        However, the binding sites (motifs) which reside in
        modules are often not known. A recent paper [ <ENAMEX TYPE="LAW">9</ENAMEX> ] proposed
        an algorithm for identfying these <ENAMEX TYPE="FAC_DESC">sites</ENAMEX>; here we show that
        a standard method is capable of identifying typically half
        of the known binding sites in a module. Its entire output
        can then be used as input to <ENAMEX TYPE="PERSON">Ahab</ENAMEX> (Figure <NUMEX TYPE="CARDINAL">1</NUMEX>). Finally, we
        ask if the redundancy of <ENAMEX TYPE="FAC_DESC">sites</ENAMEX> inside modules is strong
        enough to predict modules using only genomic sequence. To
        our knowledge, our <ENAMEX TYPE="PER_DESC">algorithm</ENAMEX> <ENAMEX TYPE="PERSON">Argos</ENAMEX> is the first successful
        attempt to do this for a metazoan genome.
        Our system of choice is the body patterning of the early
        Drosophila embryo which is established by a multi-tiered
        hierarchy of transcription factors [ <TIMEX TYPE="DATE">10</TIMEX> ] . Broadly
        distributed maternal factors trigger zygotic gap gene
        expression in discrete domains along the anterior-posterior
        axis of the embryo. <ENAMEX TYPE="ORGANIZATION">Maternal</ENAMEX> and gap gene factors together
        trigger pair rule gene expression in <NUMEX TYPE="CARDINAL">7</NUMEX> alternating stripes,
        which in turn regulate <ENAMEX TYPE="ORG_DESC">segment</ENAMEX> polarity and homeotic gene
        expression in <TIMEX TYPE="DATE">14</TIMEX> stripes. Many of these factors are known,
        their binding sites have been studied, and <NUMEX TYPE="CARDINAL">more than 20</NUMEX>
        modules have been identified. For this system, we show by
        comparing our predictions to literature results that we can
        predict regulatory <ENAMEX TYPE="ORG_DESC">modules</ENAMEX> using different levels of input
        - binding sites, regulatory sequence identified by
        'promoter bashing'/sufficiency tests, and genomic sequence
        itself. Altogether, we predict <NUMEX TYPE="CARDINAL">roughly 200</NUMEX> new modules and
        <NUMEX TYPE="CARDINAL">7</NUMEX> new sequence motifs and we analyze and validate the
        performance of each of the <NUMEX TYPE="CARDINAL">three</NUMEX> algorithms.
        Figure <NUMEX TYPE="CARDINAL">1summarizes</NUMEX> the input/output levels and serves as
        a reference for what follows.
      
      
        Results
        
          Using known binding sites, <ENAMEX TYPE="PERSON">Ahab</ENAMEX> finds <NUMEX TYPE="CARDINAL">135</NUMEX>
          significant new modules in the genome
          There are a sufficient number of binding sites in the
          <ENAMEX TYPE="PERSON">literature</ENAMEX> (see additional File 1and <NUMEX TYPE="CARDINAL">2</NUMEX>) for us to
          construct frequency weight matrices for the maternal
          transription factors <ENAMEX TYPE="PERSON">Bicoid</ENAMEX> (<ENAMEX TYPE="ORGANIZATION">Bcd</ENAMEX>), <ENAMEX TYPE="PERSON">Caudal</ENAMEX> (<ENAMEX TYPE="ORGANIZATION">Cad</ENAMEX>) and
          <ENAMEX TYPE="ORGANIZATION">Dorsal</ENAMEX> (<ENAMEX TYPE="ORGANIZATION">Dl</ENAMEX>), as well as the zygotic gap gene factors
          <ENAMEX TYPE="ORGANIZATION">Hunchback</ENAMEX> (<ENAMEX TYPE="ORGANIZATION">Hb</ENAMEX>), <ENAMEX TYPE="PERSON">Kruppel</ENAMEX> (<ENAMEX TYPE="ORGANIZATION">Kr</ENAMEX>), <ENAMEX TYPE="PERSON">Knirps</ENAMEX> (<ENAMEX TYPE="ORGANIZATION">Kni</ENAMEX>), and Tailless
          (<ENAMEX TYPE="ORGANIZATION">Tll</ENAMEX>), and the torso response element (torRE). With the
          exception of <ENAMEX TYPE="ORG_DESC">giant</ENAMEX>, which is too ill-defined to model,
          these are all the <ENAMEX TYPE="PER_DESC">maternal</ENAMEX>/gap genes at the top of the
          segmentation gene hierarchy.
          <ENAMEX TYPE="ORGANIZATION">Modules</ENAMEX> can be located by scanning the genome in
          windows, counting the number of matches to each matrix
          with a score better than some value, and then combining
          scores and ranking [ <NUMEX TYPE="CARDINAL">6 7</NUMEX> ] . We have designed an
          algorithm, <ENAMEX TYPE="GPE">Ahab</ENAMEX>, which eliminates all parameters other
          than a final rank, and, following the logic of the
          mobydick algorithm [ <TIMEX TYPE="DATE">11</TIMEX> ] , computes via maximum
          likelihood the probability that the window sequence is
          made up by sampling from the known weight matrices or
          background. Mobydick was designed to find overrepresented
          "words" in noncoding <ENAMEX TYPE="SUBSTANCE">DNA</ENAMEX>, and applied to <ENAMEX TYPE="SUBSTANCE">yeast</ENAMEX>. However,
          in the genomes of higher eukaryotes, binding <ENAMEX TYPE="FAC_DESC">sites</ENAMEX> are
          much fuzzier than in <ENAMEX TYPE="SUBSTANCE">yeast</ENAMEX> and simple motif <ENAMEX TYPE="PRODUCT_DESC">models</ENAMEX> are
          unlikely to yield meaningful results. Therefore, Ahab
          generalizes the motif model to positional weightmatrices.
          Furthermore, we introduce a 
          local background model to cut down
          the number of false positives arising from local
          variations in sequence composition and degeneracy of
          <ENAMEX TYPE="PERSON">motifs</ENAMEX> (for example motifs that contain a poly A string).
          Finally, the maximum likelihood fit has to be done
          separately for each window and thus <NUMEX TYPE="MONEY">hundreds of millions</NUMEX>
          of times for the genomes of higher eukaryotes, thus
          requiring an efficient implementation of the numerical
          procedures. Ahab tallies all possible segmentations of
          the sequence into binding sites (also called parsings).
          Thus motif overlaps are allowed and weighted according to
          how well they explain the data, and multiple weak copies
          of a factor are all counted [ <ENAMEX TYPE="LAW">5 12</ENAMEX> ] . Our background
          model is a <ENAMEX TYPE="PRODUCT">Markov</ENAMEX> model fit to all triples of <ENAMEX TYPE="FAC_DESC">bases</ENAMEX> in
          the window and accounts for local compositional variation
          which could otherwise push up the representation of any
          <ENAMEX TYPE="ORGANIZATION">matrix</ENAMEX> that matched one of the high copy number base
          <ENAMEX TYPE="PERSON">triples</ENAMEX> (eg hb matches poly A tracts).
          Additional file 1
          
          Click here for file
          Additional file 2
          
          Click here for file
          Additional file 3
          
          Click here for file
          Additional file 4
          
          Click here for file
          Additional file 5
          
          Click here for file
          Additional file 6
          
          Click here for file
          Additional file 7
          
          Click here for file
          We used <ENAMEX TYPE="PRODUCT">Ahab</ENAMEX> with a <NUMEX TYPE="CARDINAL">500</NUMEX> bp window to scan the
          Drosophila genome. As a <ENAMEX TYPE="PER_DESC">representative</ENAMEX>/typical example we
          show the hairy locus, <ENAMEX TYPE="PERSON">Fig</ENAMEX>. <NUMEX TYPE="CARDINAL">2</NUMEX>, a pair-rule gene expressed
          in <NUMEX TYPE="CARDINAL">7</NUMEX> stripes. <NUMEX TYPE="CARDINAL">Five</NUMEX> modules driving individual stripes and
          stripe pairs have been identified experimentally. Ahab
          predicts <NUMEX TYPE="CARDINAL">four</NUMEX> of them (stripes <ENAMEX TYPE="CONTACT_INFO">1, 5, 6, 7</ENAMEX>), only the
          stripe <NUMEX TYPE="CARDINAL">3</NUMEX>+<NUMEX TYPE="CARDINAL">4</NUMEX> element is not recovered. Note that two
          modules, stripes <NUMEX TYPE="CARDINAL">1 and 7</NUMEX>, were not used as training data.
          The support for each local maximum corresponds nicely to
          the experimentally estimated sizes of the modules. Ahab
          also reports scores for putative binding sites in each
          window as defined by (<ENAMEX TYPE="CONTACT_INFO">4</ENAMEX>). As an example, we show the
          even-skipped stripe <NUMEX TYPE="CARDINAL">3</NUMEX>+<NUMEX TYPE="CARDINAL">7</NUMEX> module, one of the best studied
          cases in the literature (<ENAMEX TYPE="PERSON">Fig</ENAMEX>. <NUMEX TYPE="CARDINAL">3</NUMEX>). Most of the known sites
          are recovered and some new ones predicted.
          <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> finds <NUMEX TYPE="CARDINAL">146</NUMEX> highly significant modules in the
          genome, most located in the non-transcribed regions. 27
          modules are inside introns, <NUMEX TYPE="CARDINAL">only 6</NUMEX> overlap with exons. It
          recovers the <NUMEX TYPE="CARDINAL">11</NUMEX> modules used to construct our weight
          <ENAMEX TYPE="ORGANIZATION">matrices</ENAMEX> and predicts <NUMEX TYPE="CARDINAL">6</NUMEX> other known modules with
          maternal/gap gene input. Thus, <NUMEX TYPE="CARDINAL">17</NUMEX> out of <NUMEX TYPE="CARDINAL">27</NUMEX> known modules
          (see additional File <NUMEX TYPE="CARDINAL">1</NUMEX>) are found. <NUMEX TYPE="CARDINAL">Three</NUMEX> of the missing
          <TIMEX TYPE="TIME">10 modules</TIMEX> (<ENAMEX TYPE="PRODUCT">kni64</ENAMEX>, <ENAMEX TYPE="ANIMAL">snail</ENAMEX>, sog) are very high in score
          (<ENAMEX TYPE="CONTACT_INFO">< rank 100</ENAMEX>) but lost when filtering for the presence
          of <NUMEX TYPE="CARDINAL">at least three</NUMEX> different factors. <NUMEX TYPE="CARDINAL">Three</NUMEX> <ENAMEX TYPE="PER_DESC">modules</ENAMEX> are
          lost because they contain only dorsal sites (rho, twist,
          <ENAMEX TYPE="ORGANIZATION">zen</ENAMEX>) and we do not have matrices for the other factors
          known to bind (such as <ENAMEX TYPE="ANIMAL">snail</ENAMEX> and twist), however
          searching with only the dorsal weight matrix does recover
          them. The <NUMEX TYPE="CARDINAL">four</NUMEX> remaining missing modules are low in score
          (rank <NUMEX TYPE="MONEY">> 700</NUMEX>), but <ENAMEX TYPE="ORGANIZATION">Kruppel</ENAMEX> <ENAMEX TYPE="PRODUCT">CD2</ENAMEX> is recovered for a
          window size of <NUMEX TYPE="CARDINAL">700</NUMEX>; the others are evidently low in
          maternal/gap gene binding sites.
          To determine whether any of the <NUMEX TYPE="CARDINAL">129</NUMEX> novel module
          predictions were correct, we asked whether any of the
          <ENAMEX TYPE="SUBSTANCE">adjacent genes</ENAMEX> were patterned in the blastoderm. For <NUMEX TYPE="CARDINAL">15</NUMEX>
          <ENAMEX TYPE="ORG_DESC">modules</ENAMEX> patterned expression has been reported for one of
          the adjacent <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX>; the patterns are either gap or pair
          rule like. An additional <NUMEX TYPE="CARDINAL">11</NUMEX> modules are suggestive, since
          they are clustered with another, nonoverlapping
          <ENAMEX TYPE="PERSON">prediction</ENAMEX> (<ENAMEX TYPE="PRODUCT">Table 1</ENAMEX>). Interestingly, <NUMEX TYPE="CARDINAL">two</NUMEX> predicted
          modules are in proximity to well studied segmentation
          genes (<ENAMEX TYPE="ORG_DESC">giant</ENAMEX>, runt) but still outside known regulatory
          regions.
          We tested the stability of <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> against unspecific
          input weight matrices by eliminating the least specific
          <ENAMEX TYPE="ORGANIZATION">matrix</ENAMEX> in our list (<ENAMEX TYPE="ORGANIZATION">Tailless</ENAMEX>). <ENAMEX TYPE="ORGANIZATION">Tailless</ENAMEX> has ~<NUMEX TYPE="CARDINAL">600</NUMEX>
          predicted sites in the <NUMEX TYPE="CARDINAL">146</NUMEX> modules (<ENAMEX TYPE="PRODUCT">Table 2</ENAMEX>), twice as
          much as any other factor. However, we found that roughly
          <NUMEX TYPE="PERCENT">75 %</NUMEX> of the predictions without using tailless (but with
          the same significance cutoff) were also present in the
          list of <NUMEX TYPE="CARDINAL">146</NUMEX>. Thus, although <ENAMEX TYPE="ORGANIZATION">Tailless</ENAMEX> is rather
          unspecific, it makes a contribution to the predictions
          without dominating them.
          We also varied the window size to <NUMEX TYPE="QUANTITY">700 bp</NUMEX> and masked
          out the repeats genome wide, before running <ENAMEX TYPE="GPE">Ahab</ENAMEX>, (see
          web site). Our top <NUMEX TYPE="CARDINAL">150</NUMEX> predictions now included <NUMEX TYPE="CARDINAL">11</NUMEX> out of
          the <NUMEX TYPE="CARDINAL">27</NUMEX> known modules (see additional File 1and <NUMEX TYPE="CARDINAL">3</NUMEX>).
          Lowering the cutoff value in the module score did not
          help, <NUMEX TYPE="CARDINAL">only one</NUMEX> additional known module was recovered when
          including ranks <ENAMEX TYPE="CONTACT_INFO">151-250</ENAMEX>. Overall, <NUMEX TYPE="CARDINAL">84</NUMEX> modules or <NUMEX TYPE="PERCENT">58 %</NUMEX> of
          the window <NUMEX TYPE="CARDINAL">500</NUMEX> dataset are also among the top <NUMEX TYPE="CARDINAL">200</NUMEX> of the
          window <NUMEX TYPE="CARDINAL">700</NUMEX> set, and thus might be accorded more
          significance. Although some known <ENAMEX TYPE="PER_DESC">modules</ENAMEX> disappeared,
          some very interesting new modules are predicted, in
          window <NUMEX TYPE="CARDINAL">700</NUMEX> runs, including modules for key genes in the
          segmentation process such as caudal, grainyhead, odd
          <ENAMEX TYPE="PERSON">skipped</ENAMEX> (<TIMEX TYPE="TIME">odd</TIMEX>), and sloppy paired <NUMEX TYPE="MONEY">1,2</NUMEX> (<NUMEX TYPE="MONEY">slp1,2</NUMEX>) (see
          additional File <NUMEX TYPE="CARDINAL">3</NUMEX>). Thus <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> could be improved by
          allowing for variable window lengths.
          We estimated the false positive rate by scrambling the
          columns (positions) in the input frequency matrices. The
          new matrices are thus unlikely to be functional, but
          retain the same specificity. <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> found <NUMEX TYPE="CARDINAL">roughly half</NUMEX> as
          many "modules" for the same score cutoff as for the
          original set ie a <NUMEX TYPE="PERCENT">50%</NUMEX> false positive rate. Note that this
          is a conservative estimate because part of the consensus
          motif recognized by hunchback and caudal is largely a
          <ENAMEX TYPE="ORGANIZATION">poly T</ENAMEX> motif, and thus preserved by scrambling. Moreover,
          only very few known patterned gene are predicted by the
          scrambled matrices.
          Another perhaps more straightforward estimate of
          statistical significance and our true positive rate is to
          use the experimental result (see footnote in [ <ENAMEX TYPE="LAW">6</ENAMEX> ] ) that
          less than <NUMEX TYPE="PERCENT">2%</NUMEX> of the genome or <NUMEX TYPE="MONEY">~300</NUMEX> genes are patterned
          during the blastoderm. Since we can not tell which of <NUMEX TYPE="CARDINAL">two</NUMEX>
          neighboring genes is regulated by each of the <NUMEX TYPE="CARDINAL">102</NUMEX>
          intergenic modules we predict, we are obliged to label
          <NUMEX TYPE="CARDINAL">237</NUMEX> <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> (adding the <NUMEX TYPE="CARDINAL">33</NUMEX> <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> with intragenic modules)
          as potentially patterned. For <NUMEX TYPE="CARDINAL">237</NUMEX> random predictions one
          expects <NUMEX TYPE="PERCENT">2%</NUMEX> or <NUMEX TYPE="CARDINAL">five</NUMEX> <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> to be patterned, and the
          probability to get <NUMEX TYPE="CARDINAL">21</NUMEX> or more <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> (see additional File
          <NUMEX TYPE="CARDINAL">3</NUMEX>) by chance (<ENAMEX TYPE="PRODUCT_DESC">p</ENAMEX>-value) is ~<NUMEX TYPE="PERCENT">10 -10</NUMEX>. It should be stressed
          that the true success rate of <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> will be much higher
          since the number of <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> for which blastoderm expression
          is demonstrated is (<NUMEX TYPE="MONEY">< 100</NUMEX>) or <NUMEX TYPE="MONEY">1/3</NUMEX> of the total. Thus
          we expect an additional <NUMEX TYPE="CARDINAL">50</NUMEX> <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> in our set to be
          <ENAMEX TYPE="PERSON">patterned</ENAMEX>, so a <NUMEX TYPE="PERCENT">50%</NUMEX> overall positive rate for our module
          predictions.
        
        
          The <ENAMEX TYPE="ORGANIZATION">Gibbs</ENAMEX> <ENAMEX TYPE="PER_DESC">sampler</ENAMEX> finds binding sites within
          experimentally characterized modules
          Binding site information for most of the transcription
          factors relevant to any developmental process is only
          rarely available. More common are modules obtained by
          'promoter bashing' from several genes with similar
          expression. Thus it is natural to ask, in view of the
          site repetition within <TIMEX TYPE="DATE">modules</TIMEX>, whether standard motif
          finders are able to recover good weight matrices from
          <ENAMEX TYPE="ORGANIZATION">modules</ENAMEX> and if so can these be used as input to <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> to
          find genes with similar regulatory inputs.
          We have tailored the <ENAMEX TYPE="ORGANIZATION">Gibbs</ENAMEX> algorithm (see methods) to
          this problem by searching for <NUMEX TYPE="CARDINAL">only one</NUMEX> site at a time,
          and then masking only the central <NUMEX TYPE="CARDINAL">1</NUMEX>-<NUMEX TYPE="CARDINAL">2</NUMEX> <ENAMEX TYPE="FAC_DESC">bases</ENAMEX> of each
          sequence motif found before iterating. The results were
          thereby much more reproducible between runs. Most
          <ENAMEX TYPE="PERSON">importantly</ENAMEX>, motifs were allowed to overlap, a very
          common occurrance in modules and arguably important for
          their function [ <ENAMEX TYPE="LAW">3</ENAMEX> ] .
          To gain confidence in the capabilities of the Gibbs
          algorithm, we prepared two synthetic data sets
          <ENAMEX TYPE="PER_DESC">representative</ENAMEX> of the data we wanted to examine (eg
          several kb long, <NUMEX TYPE="PERCENT">30-50%</NUMEX> of the sequence covered by
          <ENAMEX TYPE="PERSON">motifs</ENAMEX>, the remaining sequence random and <NUMEX TYPE="PERCENT">60%</NUMEX> A/T). <ENAMEX TYPE="ORGANIZATION">Data</ENAMEX>
          <ENAMEX TYPE="PRODUCT">set 1</ENAMEX> was made by equally sampling our <ENAMEX TYPE="ORGANIZATION">Hb, Cad, Kr</ENAMEX> and
          Tll matrices. <ENAMEX TYPE="ORGANIZATION">Data</ENAMEX> set <TIMEX TYPE="DATE">2</TIMEX> was generated from <NUMEX TYPE="CARDINAL">four</NUMEX>
          synthetic frequency matrices of specificity equal to the
          known ones. The customized Gibbs virtually perfectly
          recovers all the synthetic weight matrices from dataset
          <NUMEX TYPE="CARDINAL">2</NUMEX>. By contrast, <NUMEX TYPE="CARDINAL">only half</NUMEX> of the natural <ENAMEX TYPE="FAC_DESC">sites</ENAMEX> were
          recovered from dataset <NUMEX TYPE="CARDINAL">1</NUMEX>. The <ENAMEX TYPE="FAC_DESC">sites overlapped</ENAMEX> and their
          delineation was imperfect. Thus <ENAMEX TYPE="ORGANIZATION">Gibbs</ENAMEX> detects sequence
          correlations among the factors we chose, but probably
          exaggerates them, because it computes significance based
          on single base frequencies.
          We then ran the <ENAMEX TYPE="ORGANIZATION">Gibbs</ENAMEX> algorithm on several modules
          with extensive binding site data, <ENAMEX TYPE="PRODUCT">Table 3</ENAMEX>. In accord with
          experiment, <ENAMEX TYPE="PERSON">Gibbs</ENAMEX> predicts that <NUMEX TYPE="PERCENT">about 30-50%</NUMEX> of the
          <ENAMEX TYPE="PERSON">sequence</ENAMEX> is covered by motifs. The specificity of the
          Gibbs motifs is typically higher than for the
          experimental ones, presumably because a smaller number of
          sites is sampled. Even when the majority of the sequences
          composing the <ENAMEX TYPE="ORGANIZATION">Gibbs</ENAMEX> motif match a single factor, there
          are a few other strong factor matches generally in
          different positions and perhaps the other orientation.
          Nevertheless the <ENAMEX TYPE="ORGANIZATION">Gibbs</ENAMEX> motifs are largely reproducible
          between runs. Generally, we recover <NUMEX TYPE="CARDINAL">about half</NUMEX> the
          factors known to influence the module, and interestingly
          predict several new motifs. The lack of a <ENAMEX TYPE="CONTACT_INFO">1:1</ENAMEX>
          correspondence between the experimental motifs (generally
          composed from a wider range of data then presented to
          <ENAMEX TYPE="ORGANIZATION">Gibbs</ENAMEX>) and those we find, points to a real ambiguity, we
          believe, in how to parse a sequence into binding
          sites.
        
        
          Using <NUMEX TYPE="CARDINAL">only three</NUMEX> modules as input, <ENAMEX TYPE="PERSON">Ahab</ENAMEX> finds <NUMEX TYPE="CARDINAL">63</NUMEX>
          significant modules in the genome
          Next we tested whether <ENAMEX TYPE="SUBSTANCE">Gibbs</ENAMEX> derived matrices can be
          <ENAMEX TYPE="ORGANIZATION">fed</ENAMEX> to <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> for a genome-wide search for modules. As
          samples, we used <NUMEX TYPE="CARDINAL">three</NUMEX> known modules that drive
          expression of the <ENAMEX TYPE="PER_DESC">pair</ENAMEX> rule gene hairy in stripes <ENAMEX TYPE="CONTACT_INFO">5, 6,</ENAMEX>
          and <NUMEX TYPE="CARDINAL">7</NUMEX>, which are known to receive input from <ENAMEX TYPE="ORGANIZATION">Bcd, Cad</ENAMEX>,
          Hb, <ENAMEX TYPE="ORGANIZATION">Kni, Kr</ENAMEX>, and <ENAMEX TYPE="PERSON">Tll</ENAMEX> (see additional File <NUMEX TYPE="CARDINAL">1</NUMEX>).
          <ENAMEX TYPE="PERSON">Customized Gibbs</ENAMEX> finds <NUMEX TYPE="CARDINAL">6</NUMEX> highly significant weight
          <ENAMEX TYPE="ORGANIZATION">matrices</ENAMEX> within the <ENAMEX TYPE="PRODUCT">2</ENAMEX> <ENAMEX TYPE="PRODUCT_DESC">kb</ENAMEX> composite module (see additional
          <ENAMEX TYPE="CONTACT_INFO">File 4</ENAMEX>). <NUMEX TYPE="CARDINAL">One</NUMEX> matches the <ENAMEX TYPE="ORGANIZATION">Kr</ENAMEX> weight matrix with high
          quality, another <ENAMEX TYPE="PERSON">Kni</ENAMEX>, and a <NUMEX TYPE="ORDINAL">third</NUMEX> represents a mixture of
          <ENAMEX TYPE="ORGANIZATION">Hb</ENAMEX> and <ENAMEX TYPE="PERSON">Cad</ENAMEX>, whose matrices are indeed quite similar due
          to a poly T motif. The other <NUMEX TYPE="CARDINAL">three</NUMEX> motifs are new. Using
          these <NUMEX TYPE="CARDINAL">6</NUMEX> weight matrices as input, <ENAMEX TYPE="PERSON">Ahab</ENAMEX> finds <NUMEX TYPE="CARDINAL">63</NUMEX> highly
          significant modules genome-wide (<ENAMEX TYPE="PRODUCT">Table 4</ENAMEX>, additional File
          <NUMEX TYPE="CARDINAL">5</NUMEX>).
          The top <NUMEX TYPE="CARDINAL">four</NUMEX> modules overlap with those used in the
          Gibbs sampling. In addition, <NUMEX TYPE="CARDINAL">13</NUMEX> new modules were
          <ENAMEX TYPE="PERSON">contiguous</ENAMEX> to genes that are known to be patterned in the
          blastoderm, and <TIMEX TYPE="DATE">two fall</TIMEX> close to a single gene of
          unknown function. <NUMEX TYPE="CARDINAL">One</NUMEX> of the top scoring modules is the
          <ENAMEX TYPE="PRODUCT">hunchback</ENAMEX> central stripe module, other particularly
          interesting hits are in the intron of knirps and <NUMEX TYPE="CARDINAL">18</NUMEX> kb
          upstream of hairy outside the known regulatory region,
          and proximal to emc, a known transcriptional
          <ENAMEX TYPE="ORGANIZATION">co</ENAMEX>-repressor. Compared to the <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> predictions, we find
          more modules near homeotic <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> (<ENAMEX TYPE="ORGANIZATION">Abd-A</ENAMEX>, abd-B, <ENAMEX TYPE="GPE">Ubx</ENAMEX>,
          <ENAMEX TYPE="ORGANIZATION">hth</ENAMEX>), due to the presence of the novel Gibbs motifs. The
          statistical significance of our predictions and the
          inferred true positive rate are comparable to the
          segmentation gene results.
        
        
          Argos: prediction of regulatory modules from raw
          genomic sequence
          As a final generalization, we ask whether there is
          enough repetition of sequence motifs within a module for
          its discovery using no information other than the
          noncoding sequence in the genome. To determine whether a
          given motif is locally overrepresented, its frequency of
          <ENAMEX TYPE="PERSON">occurrence</ENAMEX> has to be scored against some statistical
          model. Both <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> and <ENAMEX TYPE="PERSON">Gibbs</ENAMEX>, use counts of short strings
          or single <ENAMEX TYPE="FAC_DESC">bases</ENAMEX>, within the window of interest to compute
          the significance of longer motifs. We attempted running
          Gibbs on successive windows of sequence and scoring the
          resulting motifs with <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX>, but were not able to
          discriminate the known modules from the remainder of the
          upstream region.
          We therefore devised an alternative strategy that uses
          the information available in all the noncoding sequence
          and thus extrinsic to the window of interest. We
          enumerate all motifs in a class (a consensus of length 8
          and <NUMEX TYPE="CARDINAL">2</NUMEX> mutations worked best), and use their frequency to
          assign a probability for observing an overrepresentation
          of any one of them in the window of interest. The actual
          binding motifs may be longer, we only need to capture the
          most significant region. Typically <NUMEX TYPE="CARDINAL">several hundred</NUMEX> motifs
          are significant for each window. They heavily overlap so
          the individual motif scores can not be simply added for
          an overall score. Although we tried using <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> to
          eliminate redundant motifs, we got better results with a
          greedy algorithm that looks only at the motifs without
          placing them on the sequence. The <ENAMEX TYPE="PER_DESC">greedy</ENAMEX> algorithm
          winnows the list of motifs down by starting with the
          highest scoring <NUMEX TYPE="CARDINAL">one</NUMEX> and eliminates any motif related to
          it under shifts and a limited number of mutations. The
          next remaining motif is retained and overlaps with it are
          eliminated, until <NUMEX TYPE="MONEY">~5</NUMEX> quasi independent motifs are
          obtained whose scores can be added (details in additional
          <ENAMEX TYPE="CONTACT_INFO">File 7</ENAMEX>).
          We evaluated the results of <ENAMEX TYPE="ORGANIZATION">Argos</ENAMEX> for the the modules
          in additional File <NUMEX TYPE="CARDINAL">1</NUMEX>. Log probability scores > <NUMEX TYPE="CARDINAL">70</NUMEX> were
          taken as significant, since they are found very rarely
          using randomized noncoding sequence <NUMEX TYPE="CARDINAL">1</NUMEX>. With this
          threshold and at least l00 bp overlap, <NUMEX TYPE="CARDINAL">half</NUMEX> of the
          modules were recovered, indicating a <NUMEX TYPE="PERCENT">50%</NUMEX> false negative
          rate. The number of false positives is difficult to
          assess, because the code looks for 
          any regulatory <ENAMEX TYPE="ORG_DESC">module</ENAMEX>. However for
          several well studied segmentation <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> (specifically
          even-skipped, <ENAMEX TYPE="ORG_DESC">giant</ENAMEX>, hairy, hunchback, knirps, <ENAMEX TYPE="GPE">Kruppel</ENAMEX>,
          and tailless), with <NUMEX TYPE="CARDINAL">15</NUMEX> known modules, we squarely hit <NUMEX TYPE="CARDINAL">7</NUMEX>
          when looking over the entire <NUMEX TYPE="QUANTITY">10 kb</NUMEX> upstream of
          translation start (gt, kni, <ENAMEX TYPE="PRODUCT">Kr-730</ENAMEX>, <ENAMEX TYPE="PRODUCT">Kr-CD2</ENAMEX>, <ENAMEX TYPE="PRODUCT">eve3-7</ENAMEX>, <TIMEX TYPE="TIME">eve</TIMEX>
          autoregulatory element, <ENAMEX TYPE="SUBSTANCE">h-7</ENAMEX>), <ENAMEX TYPE="PERSON">Fig</ENAMEX>. <NUMEX TYPE="CARDINAL">4</NUMEX>, but only three
          predictions are outside of known modules (one for
          <ENAMEX TYPE="ORGANIZATION">tailless</ENAMEX> and <NUMEX TYPE="CARDINAL">two</NUMEX> for hunchback). This indicates a low
          false positive rate. Genome wide we are predicting about
          <NUMEX TYPE="CARDINAL">one</NUMEX> module per <NUMEX TYPE="CARDINAL">5</NUMEX> kb of noncoding sequence averaged over
          the genome (with a strong bias for <TIMEX TYPE="DATE">noncoding</TIMEX> vs <ENAMEX TYPE="ORGANIZATION">coding</ENAMEX>),
          which corresponds to <NUMEX TYPE="QUANTITY">roughly one module</NUMEX> per gene.
        
      
      
        Discussion
        We have demonstrated algorithms that exploit <NUMEX TYPE="CARDINAL">three</NUMEX> very
        different levels of prior information and lead to
        statistically highly significant predictions for early
        developmental modules in the fly. The <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> algorithm is
        perhaps closest to the 'calculation' actually performed by
        the <ENAMEX TYPE="FAC_DESC">cell</ENAMEX>. The weight matrix match is a surrogate for the
        energetic preference of a transcription factor for a
        particular sequence, and <ENAMEX TYPE="PRODUCT">Ahab</ENAMEX> models the competition of
        several factors and their binding energies for a stretch of
        <ENAMEX TYPE="PERSON">DNA (a</ENAMEX> module). Ahab ignores distances between binding
        sites and the actual factor concentrations. Thus, the
        <ENAMEX TYPE="ORGANIZATION">success of Ahab</ENAMEX> suggests that just modeling the binding
        energies is already predictive. It will be interesting to
        see how well <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> performs in situations where the
        concerted binding of cofactors constrains the spacing of
        binding sites [ <NUMEX TYPE="CARDINAL">13 14</NUMEX> ] .
        Finding overrepresented weight matrices is a well
        studied problem for which <ENAMEX TYPE="ORGANIZATION">Gibbs</ENAMEX> sampling constitutes a
        reasonable solution if the data consists of distinct motifs
        separated by random bases. The difficulty we have
        encountered with this algorithm in dissecting regulatory
        modules for binding <ENAMEX TYPE="FAC_DESC">sites</ENAMEX> is not rare or diffuse motifs but
        rather too much signal, namely the overlay of motifs of
        different sizes and specificities. The <ENAMEX TYPE="ORGANIZATION">Gibbs</ENAMEX> statistical
        model is not strictly correct for our data. A more adequate
        <ENAMEX TYPE="ORGANIZATION">algorithm</ENAMEX> would allow competition among motifs of different
        lengths [ <TIMEX TYPE="DATE">15</TIMEX> ] . Irrespective of technical problems, the
        discovery of binding motifs by site repetition is
        qualitatively a more difficult task than their recognition
        by transcription factors [ <TIMEX TYPE="DATE">16</TIMEX> ] . Thus our ability to
        recover plausible motifs for <NUMEX TYPE="CARDINAL">about half</NUMEX> the known factors
        was not obvious in advance and is another manifestation of
        the redundancy in module design.
        Reference [ <ENAMEX TYPE="LAW">6</ENAMEX> ] describes another approach to locating
        modules from clusters of known weight matrices. They count
        the number of matches of each weight matrix in an interval
        with a score above some empirically defined cutoff, and
        then score a <NUMEX TYPE="CARDINAL">700</NUMEX> bp window as significant when the total
        number of matches for all factors is large enough.
        Information about the background is implicitly encoded in
        their choice of threshold. We do not have factor specific
        cutoffs, and use a locally defined background model, which
        renders our algorithm more automatic and less sensitive to
        local variation in sequence composition, eg poly A
        runs.
        Although we are predicting many more modules than in [ <NUMEX TYPE="CARDINAL">6</NUMEX>
        ] , the positive hit rates are comparable between the two
        methods (<NUMEX TYPE="PERCENT">50%</NUMEX> vs <NUMEX TYPE="CARDINAL">10</NUMEX> positives out of <NUMEX TYPE="CARDINAL">28</NUMEX> predictions [ <ENAMEX TYPE="LAW">6</ENAMEX> ] ).
        A more detailed comparison of both data sets reveals,
        however, that the <NUMEX TYPE="CARDINAL">28</NUMEX> <ENAMEX TYPE="PER_DESC">modules</ENAMEX> predicted by [ <ENAMEX TYPE="LAW">6</ENAMEX> ] , with the
        exception of the giant <NUMEX TYPE="CARDINAL">one</NUMEX>, do not overlap with any of the
        top <NUMEX TYPE="CARDINAL">137</NUMEX> <ENAMEX TYPE="PER_DESC">modules</ENAMEX> predicted by <ENAMEX TYPE="PERSON">Ahab</ENAMEX>, although there are <NUMEX TYPE="CARDINAL">4</NUMEX>
        genes in common to our <ENAMEX TYPE="PRODUCT_DESC">sets</ENAMEX>. More strikingly, the <NUMEX TYPE="CARDINAL">10</NUMEX>
        modules for which experimental results in [ <ENAMEX TYPE="LAW">6</ENAMEX> ] suggest
        <ENAMEX TYPE="ORGANIZATION">functionality</ENAMEX> based on blastoderm expression of a
        neighboring gene fall below <NUMEX TYPE="CARDINAL">500</NUMEX> in our ranking with
        exception of <ENAMEX TYPE="ORG_DESC">giant</ENAMEX> and one of the hairy derived modules for
        nub, <ENAMEX TYPE="PRODUCT">Table 4</ENAMEX>. Presumably due to the difference in
        background model, their modules are dominated by <ENAMEX TYPE="ORGANIZATION">Hb</ENAMEX> <ENAMEX TYPE="FAC_DESC">sites</ENAMEX>,
        while ours are not, which contributes considerably to the
        divergence of the predictions. Clearly, only direct
        experimental validation of predicted modules through
        <ENAMEX TYPE="PER_DESC">reporter</ENAMEX> gene fusions will help to compare the different
        methods. In this fashion, we plan to test a number of the
        new <ENAMEX TYPE="PER_DESC">modules</ENAMEX> predicted for key genes in the segmentation
        system such as h, run, gt, odd, prd, <NUMEX TYPE="CARDINAL">slpl/2</NUMEX> and cad.
        In order to understand regulatory <ENAMEX TYPE="ORG_DESC">networks</ENAMEX> of genes, it
        is useful to generalize from a few <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> or modules with
        common functions to new <ENAMEX TYPE="PER_DESC">candidates</ENAMEX>. When control is
        combinatoric, a purely experimental approach tends to be
        more tedious than screening a modest list of <ENAMEX TYPE="PER_DESC">candidates</ENAMEX>.
        Thus a potentially important aspect of our work is the
        combination of motif discovery from modules via <ENAMEX TYPE="ORGANIZATION">Gibbs</ENAMEX>
        <ENAMEX TYPE="ORGANIZATION">sampling</ENAMEX> and generalization to the entire genome with <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX>.
        We have demonstrated the feasibility of this procedure when
        we worked from the hairy stripe <ENAMEX TYPE="PRODUCT">5-7</ENAMEX> <ENAMEX TYPE="PRODUCT_DESC">modules</ENAMEX>. Interestingly,
        the <ENAMEX TYPE="PER_DESC">candidate</ENAMEX> list of similar modules genome wide was quite
        small, but had little overlap with the top scoring modules
        predicted from the full set of gap gene weight matrices.
        Hopefully some of the new motifs discovered by Gibbs
        sampling are real; perhaps they are binding sites for
        <ENAMEX TYPE="ORGANIZATION">corepressors</ENAMEX>. Clearly the <NUMEX TYPE="ORDINAL">first</NUMEX> step is to confirm a
        striped expression for some of the genes in <ENAMEX TYPE="PRODUCT">Table 4</ENAMEX>.
        Our algorithm <ENAMEX TYPE="ORGANIZATION">Argos</ENAMEX> for predicting enhancers from raw
        genomic sequence works astonishingly well. It will be most
        interesting to use this approach together in conjunction
        with the customized <ENAMEX TYPE="PERSON">Gibbs</ENAMEX> sampler and <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> in situations
        where nothing is known experimentally about the
        transcriptional regulation of genes of interest to identify
        <ENAMEX TYPE="ORGANIZATION">co</ENAMEX>-regulated genes. Namely, following the hierarchical
        structure in Figure <NUMEX TYPE="CARDINAL">1</NUMEX>, <ENAMEX TYPE="PERSON">Argos</ENAMEX> could be used to predict
        modules, then the customized <ENAMEX TYPE="PERSON">Gibbs</ENAMEX> sampler to predict
        binding sites (weight matrices) and finally Ahab to
        predict, genome wide, <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> in the same regulatory
        network.
        Several recent papers [ <NUMEX TYPE="CARDINAL">6 7 9</NUMEX> ] as well as ours have
        taken only the very <NUMEX TYPE="ORDINAL">first</NUMEX> steps in applying computational
        approaches to the <TIMEX TYPE="DATE">the elucidation</TIMEX> of 
        cis- regulatory <ENAMEX TYPE="ORG_DESC">modules</ENAMEX>. For body
        <ENAMEX TYPE="ORGANIZATION">patterning</ENAMEX> in the fly, it is very encouraging that such
        limited information as we have used works so well. It
        remains to be seen if the same approaches work on systems
        where a single <ENAMEX TYPE="PER_DESC">master</ENAMEX> regulatory gene initiates a
        developmental cascade, or where integration of
        developmental cues occurs partly at the level of signal
        <ENAMEX TYPE="ORGANIZATION">transduction</ENAMEX>.
      
      
        Conclusions
        Predicting and understanding transcriptional regulation
        is a fundamental problem in biology. We have designed new
        algorithms for the detection of 
        cis- regulatory <ENAMEX TYPE="ORG_DESC">modules</ENAMEX> in the
        genomes of higher eukaryotes which is a <NUMEX TYPE="ORDINAL">first</NUMEX> step in
        unraveling transcriptional regulatory <ENAMEX TYPE="ORG_DESC">networks</ENAMEX>. We have
        demonstrated, in the case of body patterning in the 
        Drosophila <ENAMEX TYPE="PER_DESC">embryo</ENAMEX>, that our
        algorithms allow the genome-wide identification of
        regulatory modules when the motifs for the transcription
        factors are known (algorithm <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX>), or when only related
        modules are known (customized <ENAMEX TYPE="PERSON">Gibbs</ENAMEX> sampler in conjunction
        with <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX>), or when only genomic sequence is analyzed with
        <ENAMEX TYPE="ORGANIZATION">Argos</ENAMEX>. We believe that <ENAMEX TYPE="SUBSTANCE">Ahab</ENAMEX> overcomes many problems of
        recent studies and we estimated the false positive rate to
        be <NUMEX TYPE="PERCENT">about 50%</NUMEX>. <ENAMEX TYPE="ORGANIZATION">Argos</ENAMEX> is the first successful attempt to
        predict regulatory <ENAMEX TYPE="ORG_DESC">modules</ENAMEX> using only the genome without
        training data. All our results and module predictions
        across the 
        Drosophila genome are available at
        <ENAMEX TYPE="CONTACT_INFO">http://uqbar.</ENAMEX><ENAMEX TYPE="ORGANIZATION">rockefeller</ENAMEX>.<ENAMEX TYPE="CONTACT_INFO">edu/~siggia/.</ENAMEX> The <ENAMEX TYPE="LAW">Ahab code</ENAMEX> is
        available upon request from the <ENAMEX TYPE="PER_DESC">authors</ENAMEX>.
      
      
        Methods
        
          Genomic data
          We downloaded the <ENAMEX TYPE="PRODUCT">Release 2</ENAMEX> genomic sequence and
          annotation for 
          Drosophila melanogaster from
          "Gadfly" (<ENAMEX TYPE="ORGANIZATION">Genome Annotation Database of</ENAMEX> 
          
          Drosophila, <ENAMEX TYPE="CONTACT_INFO">http://www.</ENAMEX><ENAMEX TYPE="ORGANIZATION">fruitfly</ENAMEX>.<ENAMEX TYPE="CONTACT_INFO">org/</ENAMEX>(<TIMEX TYPE="DATE">Oct 2000</TIMEX>)).
          Using a map provided by <ENAMEX TYPE="PERSON">Chris Mungall</ENAMEX> (private
          <ENAMEX TYPE="ORGANIZATION">communication</ENAMEX>) we mapped the annotation, which was done
          on separate contigs, to chromosomal coordinates.
          "Flybase" <ENAMEX TYPE="CONTACT_INFO">http://flybase.</ENAMEX><ENAMEX TYPE="ORGANIZATION">bio</ENAMEX>.<ENAMEX TYPE="GPE">Indiana</ENAMEX>.<ENAMEX TYPE="CONTACT_INFO">edu/</ENAMEX>provides a
          <ENAMEX TYPE="GPE">curated</ENAMEX> assembly of genetic and molecular data from the
          existing literature. Our web sites links this database to
          the <ENAMEX TYPE="ORGANIZATION">Gadfly</ENAMEX> annotation using a map provided by <ENAMEX TYPE="ORGANIZATION">David</ENAMEX>
          <ENAMEX TYPE="ORGANIZATION">Emmert</ENAMEX> (private communication). Since our algorithms are
          based on searching for clusters of common sites,
          <ENAMEX TYPE="ORGANIZATION">microsatellites</ENAMEX> can score high, but tend not to be
          <ENAMEX TYPE="PERSON">functional</ENAMEX> (for an exception see [ <ENAMEX TYPE="LAW">9</ENAMEX> ] ). We used the
          <ENAMEX TYPE="ORGANIZATION">Tandem Repeat Remover</ENAMEX> [ <TIMEX TYPE="DATE">17</TIMEX> ] to mask microsatellites,
          with scoring parameters (<NUMEX TYPE="CARDINAL">2 5 5 75 20 20 500</NUMEX>)
          (respectively; match, mismatch, indel scores; percentage
          priors for mismatch and indels; minimum score, and
          maximum length) which are as promiscuous as possible yet
          did not detect appreciable microsatellites in random
          <ENAMEX TYPE="ORGANIZATION">sequences</ENAMEX>. With these settings, ~<NUMEX TYPE="PERCENT">5.7%</NUMEX> of all non coding
          sequences are masked.
          We collected from the experimental literature modules
          that drive blastoderm specific expression of a <ENAMEX TYPE="PER_DESC">reporter</ENAMEX>
          gene in response to several of the factors in our list.
          In many cases the module was shown to be the minimal
          element. The modules mapped to chromosomal coordinates
          are reported in the additional File 1.
          We collected a total of <NUMEX TYPE="CARDINAL">199</NUMEX> experimentally
          characterized sites for the factors bicoid (<NUMEX TYPE="CARDINAL">30</NUMEX> sites),
          <ENAMEX TYPE="ORGANIZATION">caudal</ENAMEX> (<NUMEX TYPE="MONEY">21</NUMEX>), dorsal (<NUMEX TYPE="MONEY">32</NUMEX>), hunchback (<NUMEX TYPE="MONEY">43</NUMEX>), knirps (<NUMEX TYPE="MONEY">27</NUMEX>),
          <ENAMEX TYPE="ORGANIZATION">kruppel</ENAMEX> (<NUMEX TYPE="MONEY">20</NUMEX>), tailless (<NUMEX TYPE="MONEY">20</NUMEX>), and torRE (<ENAMEX TYPE="CONTACT_INFO">6</ENAMEX>). Giant sites
          are too few in number and ill defined to be useable. Each
          binding site was mapped to the genome and padded with <NUMEX TYPE="CARDINAL">six</NUMEX>
          bases on both sides. The multiple alignment program
          <ENAMEX TYPE="ORGANIZATION">WCONSENSUS</ENAMEX> [ <TIMEX TYPE="DATE">18</TIMEX> ] (options, <ENAMEX TYPE="PRODUCT">-f -d -sl -a</ENAMEX> and background
          <ENAMEX TYPE="ORGANIZATION">frequencies</ENAMEX> <ENAMEX TYPE="PER_DESC">representative</ENAMEX> of noncoding sequence (<NUMEX TYPE="PERCENT">60%</NUMEX>
          A/T)) was used to align and orient the <ENAMEX TYPE="FAC_DESC">sites</ENAMEX> and create a
          weight matrix for each factor. Results and references are
          in the additonal File 2.
        
        
          <ENAMEX TYPE="PERSON">Algorithm Ahab</ENAMEX>: fitting multiple weightmatrices to
          sequence
          Ahab computes an optimal probabilistic segmentation of
          a sequence 
          <ENAMEX TYPE="ORGANIZATION">S</ENAMEX> into binding <ENAMEX TYPE="FAC_DESC">sites</ENAMEX> and background
          for a fixed set 
          <ENAMEX TYPE="ORGANIZATION">W</ENAMEX> of sequence motifs modelled by
          weight matrices. <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> is related to the mobydick
          <ENAMEX TYPE="ORGANIZATION">algorithm</ENAMEX> [ <TIMEX TYPE="DATE">11</TIMEX> ] , but has several novel key features
          described in detail in the results section and the
          additional File <NUMEX TYPE="CARDINAL">6</NUMEX>. It fits the probabilities 
          p 
          
            <ENAMEX TYPE="ORGANIZATION">w</ENAMEX> 
           of the (fixed) matrices 
          <ENAMEX TYPE="ORGANIZATION">w</ENAMEX> and background 
          p 
          
            B 
           , so as to maximize the likelihood of generating 
          <ENAMEX TYPE="ORGANIZATION">S</ENAMEX> under a certain explicit model.
          Namely, select a weight matrix or background according to
          its probability 
          p 
          
            <ENAMEX TYPE="ORGANIZATION">w</ENAMEX> 
           , 
          p 
          
            B 
           , sample according to the predetermined frequencies,
          and add the resulting bases to the sequence under
          construction. The fit of the <ENAMEX TYPE="PRODUCT_DESC">model</ENAMEX> to 
          <ENAMEX TYPE="ORGANIZATION">S</ENAMEX> is accomplished by defining the
          probability of a particular segmentation T of 
          S as
          
          where 
          <ENAMEX TYPE="ORGANIZATION">k</ENAMEX> = <NUMEX TYPE="CARDINAL">1</NUMEX>, <NUMEX TYPE="CARDINAL">2,...</NUMEX>, 
          <ENAMEX TYPE="ORGANIZATION">N</ENAMEX> ( 
          <ENAMEX TYPE="ORGANIZATION">T</ENAMEX> ) labels the weight matrices (or
          background) which were used in segmentation 
          <ENAMEX TYPE="ORGANIZATION">T</ENAMEX> . The quality of the match
          between the weight matrix 
          <ENAMEX TYPE="ORGANIZATION">w</ENAMEX> 
          
            <ENAMEX TYPE="ORGANIZATION">k</ENAMEX> 
           and the subsequence 
          s = ( 
          <ENAMEX TYPE="ORGANIZATION">n</ENAMEX> 
          <NUMEX TYPE="CARDINAL">1</NUMEX> ,... 
          <ENAMEX TYPE="ORGANIZATION">n</ENAMEX> 
          
            <ENAMEX TYPE="ORGANIZATION">l</ENAMEX> 
           ) is incorporated in 
          <ENAMEX TYPE="ORGANIZATION">m</ENAMEX> ( 
          s | 
          <ENAMEX TYPE="ORGANIZATION">w</ENAMEX> 
          
            <ENAMEX TYPE="ORGANIZATION">k</ENAMEX> 
           ) = , where 
          f 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           ( 
          <ENAMEX TYPE="ORGANIZATION">n |</ENAMEX> 
          <ENAMEX TYPE="ORGANIZATION">w</ENAMEX> 
          
            <ENAMEX TYPE="ORGANIZATION">k</ENAMEX> 
           ) are the normalized frequencies of nucleotide 
          <ENAMEX TYPE="ORGANIZATION">n</ENAMEX> at position 
          <ENAMEX TYPE="PRODUCT">j</ENAMEX> for weight matrix 
          <ENAMEX TYPE="ORGANIZATION">w</ENAMEX> 
          
            <ENAMEX TYPE="ORGANIZATION">k</ENAMEX> 
           .
          An important consequence of equation (<ENAMEX TYPE="CONTACT_INFO">1</ENAMEX>) is that
          multiple binding <ENAMEX TYPE="FAC_DESC">sites</ENAMEX> with weak matches to the weight
          <ENAMEX TYPE="ORGANIZATION">matrix</ENAMEX> for the same factor ( large, 
          <ENAMEX TYPE="ORGANIZATION">m</ENAMEX> ( 
          s | 
          <ENAMEX TYPE="ORGANIZATION">w</ENAMEX> 
          
            <ENAMEX TYPE="ORGANIZATION">k</ENAMEX> 
           ) small) may make an important contribution to 
          <ENAMEX TYPE="ORGANIZATION">P</ENAMEX> ( 
          <ENAMEX TYPE="ORGANIZATION">T</ENAMEX> ). In many cases these redundant
          sites with low weight matrix scores have been observed in
          experimentally known modules. Any algorithm that would
          just count matches of sequences to a weight matrix above
          a certain threshold would have to use ad-hoc measures to
          incorporate these <ENAMEX TYPE="FAC_DESC">sites</ENAMEX> into the score. Note also that
          the weight matrix only captures the sequence dependent
          part of the binding energy, so 'weak' binding could
          equally well be termed 'nonspecific'. We know too little
          about the physical binding energies of transcription
          factors, and their cofactors and protein concentrations
          in vivo, to calculate whether any modules are actually
          occupied by factors.
          <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> uses a 
          local <ENAMEX TYPE="LOCATION">Markov</ENAMEX> model of order 
          q for background sequence, that is,
          a single base 
          <ENAMEX TYPE="ORGANIZATION">n</ENAMEX> at site 
          <ENAMEX TYPE="PERSON">j</ENAMEX> is segmented with probability 
          p 
          
            B 
           
          f 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           ( 
          <ENAMEX TYPE="ORGANIZATION">n |</ENAMEX> 
          B ), where ∑ 
          
            <ENAMEX TYPE="ORGANIZATION">n</ENAMEX> 
           
          f 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           ( 
          <ENAMEX TYPE="ORGANIZATION">n |</ENAMEX> 
          B ) = <NUMEX TYPE="CARDINAL">1</NUMEX>, and 
          f 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           ( 
          <ENAMEX TYPE="ORGANIZATION">n |</ENAMEX> 
          B ) is contingent on the 
          q preceding bases following the
          <ENAMEX TYPE="PRODUCT">usual Markov</ENAMEX> model definitions. The 
          f 
          
            <ENAMEX TYPE="CONTACT_INFO">j</ENAMEX> 
           are computed by enumerating all 
          q + <NUMEX TYPE="CARDINAL">1</NUMEX> tuples of <ENAMEX TYPE="FAC_DESC">bases</ENAMEX> in 
          <ENAMEX TYPE="ORGANIZATION">S</ENAMEX>, which has the effect of
          suppressing the number of copies of any 
          w which match frequent triples of
          bases, eg poly A tracts (we typically use 
          <ENAMEX TYPE="CONTACT_INFO">q = 2</ENAMEX>).
          The likelihood 
          Z to observe 
          <ENAMEX TYPE="ORGANIZATION">S</ENAMEX> is then
          
          Dynamic programming allows the calculation of 
          Z ( 
          <ENAMEX TYPE="ORGANIZATION">S</ENAMEX> ) in a time proportional to the
          sequence length and the number of weight matrices. The
          maximization of 
          Z ( 
          <ENAMEX TYPE="ORGANIZATION">S</ENAMEX> ) then determines 
          p 
          
            <ENAMEX TYPE="ORGANIZATION">w</ENAMEX>,B 
           (see additional File <NUMEX TYPE="CARDINAL">6</NUMEX>). The likelihood 
          Z 
          
            B 
           that 
          <ENAMEX TYPE="ORGANIZATION">S</ENAMEX> comes from background only (ie 
          p 
          
            B 
           <ENAMEX TYPE="CONTACT_INFO">== 1</ENAMEX>) is trivially computed from the <ENAMEX TYPE="PRODUCT">Markov</ENAMEX> <ENAMEX TYPE="PRODUCT_DESC">model</ENAMEX>.
          The score 
          R that 
          <ENAMEX TYPE="ORGANIZATION">S</ENAMEX> is a regulatory <ENAMEX TYPE="ORG_DESC">module</ENAMEX> is then in
          log-odds units
          
          At each position 
          i = <NUMEX TYPE="CARDINAL">1</NUMEX>, ..., 
          <ENAMEX TYPE="ORGANIZATION">L</ENAMEX> in 
          S the probability 
          P 
          
            i 
           ( 
          w | 
          <ENAMEX TYPE="ORGANIZATION">S</ENAMEX> ) to observe the start of weight
          <ENAMEX TYPE="ORGANIZATION">matrix</ENAMEX> 
          <ENAMEX TYPE="ORGANIZATION">w</ENAMEX> of length 
          <ENAMEX TYPE="ORGANIZATION">l</ENAMEX> 
          
            <ENAMEX TYPE="ORGANIZATION">w</ENAMEX> 
           is computed by standard posterior decoding. Let 
          Z ( 
          i, j ) denote the likelihood for
          the sequence 
          S from position 
          i up to 
          <ENAMEX TYPE="PERSON">j.</ENAMEX> (The symbol 
          Z ( 
          <ENAMEX TYPE="ORGANIZATION">S</ENAMEX> ) used above, is just 
          Z (<ENAMEX TYPE="CONTACT_INFO">1,</ENAMEX> 
          <ENAMEX TYPE="ORGANIZATION">L</ENAMEX> ).)
          
          using the optimized 
          p 
          
            <ENAMEX TYPE="ORGANIZATION">w</ENAMEX> 
           's. The sum of equation (<ENAMEX TYPE="CONTACT_INFO">4</ENAMEX>) over all <ENAMEX TYPE="PER_DESC">positions</ENAMEX> is
          the average copy number of 
          <ENAMEX TYPE="ORGANIZATION">w</ENAMEX> in the data. Summing over all
          <ENAMEX TYPE="ORGANIZATION">segmentations</ENAMEX> (<ENAMEX TYPE="CONTACT_INFO">1</ENAMEX>) naturally allows for overlapping sites
          and the <ENAMEX TYPE="FAC">'profile'</ENAMEX> (<ENAMEX TYPE="CONTACT_INFO">4</ENAMEX>) quantifies the competition between
          different factors for the same <ENAMEX TYPE="FAC_DESC">bases</ENAMEX>.
          It takes a modern <ENAMEX TYPE="ORGANIZATION">LINUX</ENAMEX> workstation <TIMEX TYPE="DATE">about 2 days</TIMEX> to
          <ENAMEX TYPE="PERSON">run Ahab</ENAMEX> over the entire genome with a <NUMEX TYPE="CARDINAL">500</NUMEX> bp window
          moved in <TIMEX TYPE="DATE">20</TIMEX> bp steps, fitting the gap gene weight
          matrices we collected. We enumerated all local maxima in
          the score 
          R larger than <TIMEX TYPE="DATE">15</TIMEX> and eliminated
          those within <NUMEX TYPE="QUANTITY">500 bp of a higher</NUMEX> scoring peak and obtained
          <NUMEX TYPE="CARDINAL">216</NUMEX> disjoint regions. If we insist that <NUMEX TYPE="CARDINAL">at least 3</NUMEX>
          different factors contribute to the module with
          individual average copy numbers of <NUMEX TYPE="CARDINAL">at least 1</NUMEX> the number
          of modules reduces to <NUMEX TYPE="CARDINAL">169</NUMEX>, and eliminating all candidates
          with <NUMEX TYPE="CARDINAL">80</NUMEX> or more basepairs masked by the <ENAMEX TYPE="ORGANIZATION">Tandem Repeat</ENAMEX>
          <ENAMEX TYPE="ORGANIZATION">Remover</ENAMEX> gave a final list of <NUMEX TYPE="CARDINAL">146</NUMEX> modules. Predictions
          with <NUMEX TYPE="CARDINAL">more than 200</NUMEX> bases overlap with a known module or
          with an overlap of <NUMEX TYPE="PERCENT">at least 50%</NUMEX> of the length of the
          known module were considered to be a recovered known
          <ENAMEX TYPE="ORGANIZATION">module</ENAMEX>.
        
        
          Determination of motifs from modules
          We ran locally the <ENAMEX TYPE="ORGANIZATION">Gibbs</ENAMEX> sampler algorithm provided by
          <ENAMEX TYPE="PERSON">C. Lawrence</ENAMEX>'s <ENAMEX TYPE="PER_DESC">group</ENAMEX> at
          <ENAMEX TYPE="CONTACT_INFO">http://www.</ENAMEX><ENAMEX TYPE="PERSON">wadsworth</ENAMEX>.<ENAMEX TYPE="CONTACT_INFO">org/resnres/bioinfo/</ENAMEX>, as described
          in Results. We generally used a motif length of <NUMEX TYPE="QUANTITY">11 bp</NUMEX> and
          allowed the algorithm to vary this by +-<NUMEX TYPE="CARDINAL">2</NUMEX> if the data
          <ENAMEX TYPE="PERSON">warranted</ENAMEX>, and took a prior copy number of <NUMEX TYPE="CARDINAL">7</NUMEX> when fitting
          <ENAMEX TYPE="PRODUCT">1-2</ENAMEX> kb of data (again the algorithm will adjust this
          number). Other parameters were taken as default, and
          under these conditions typically <NUMEX TYPE="CARDINAL">5</NUMEX> distinct motifs were
          fit.
          To decide whether <ENAMEX TYPE="SUBSTANCE">Gibbs</ENAMEX> derived motifs matched known
          ones we ran the known weight matrices in both
          orientations over the individual sequences composing the
          motif plus <NUMEX TYPE="CARDINAL">five</NUMEX> flanking <ENAMEX TYPE="FAC_DESC">bases</ENAMEX> and computed the position
          that maximized the information score. The <ENAMEX TYPE="ORGANIZATION">Gibbs</ENAMEX> motif was
          deemed to match a known factor if:
          <NUMEX TYPE="CARDINAL">1</NUMEX>) a single known matrix was the top match to a
          majority of the sequences,
          <NUMEX TYPE="CARDINAL">2</NUMEX>) the optimal match occurred at the same position
          (with some variability allowed for factors such as hb,
          with poly-A regions),
          <NUMEX TYPE="CARDINAL">3</NUMEX>) the information score of the match was comparable
          to the score of the sequences which define the matrix to
          the <ENAMEX TYPE="FAC_DESC">matrix</ENAMEX> itself and not dominated by the flanking
          bases.
          <NUMEX TYPE="CARDINAL">4</NUMEX>) the preceding conditions were met in two
          independent runs (with typically <NUMEX TYPE="CARDINAL">2</NUMEX>-<NUMEX TYPE="CARDINAL">4</NUMEX> runs done for each
          <ENAMEX TYPE="ORGANIZATION">data</ENAMEX> set).
        
        
          Algorithm Argos
          <ENAMEX TYPE="ORGANIZATION">Argos</ENAMEX> is described in detail in the results section
          and additional File 7.
        
        
          Genome-wide display of our results
          Our webpage
          <ENAMEX TYPE="CONTACT_INFO">http://uqbar.</ENAMEX><ENAMEX TYPE="ORGANIZATION">rockefeller</ENAMEX>.<ENAMEX TYPE="CONTACT_INFO">edu/~siggia/</ENAMEX>contains all our
          predictions. For each module, all nearby <ENAMEX TYPE="SUBSTANCE">genes</ENAMEX> were
          extracted from the annotation, their position relative to
          the module (ie up/down stream, intronic), and Flybase
          links for gene function were collected into a table. The
          number of binding sites for each factor in the module is
          listed and their position and score along with known
          binding <ENAMEX TYPE="FAC_DESC">sites</ENAMEX> can be viewed in graphs which were produced
          with "gff2ps" [ <TIMEX TYPE="DATE">19</TIMEX> ] .
          To view our results interactively on a larger scale
          together with the current fly annotation we installed the
          Gbrowse software from <ENAMEX TYPE="PERSON">L. Stein</ENAMEX>'s <ENAMEX TYPE="PRODUCT">Generic Model Organism</ENAMEX>
          <ENAMEX TYPE="ORGANIZATION">Systems Database</ENAMEX> Project <ENAMEX TYPE="CONTACT_INFO">http://www.</ENAMEX><ENAMEX TYPE="ORGANIZATION">gmod</ENAMEX>.<ENAMEX TYPE="CONTACT_INFO">org</ENAMEX>. Our modules
          (predicted and experimental), binding sites, and
          restriction <ENAMEX TYPE="FAC_DESC">sites</ENAMEX> are included in the display. A function
          was added that allows to plot the <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> score (equation <NUMEX TYPE="QUANTITY">3</NUMEX>)
          along the genome. Thus, the <ENAMEX TYPE="PER_DESC">user</ENAMEX> can explore where
          additional putative modules fall relative to any gene of
          interest.
        
      
      
        Contributions
        <ENAMEX TYPE="CONTACT_INFO">Authors 1, 2</ENAMEX> and <NUMEX TYPE="CARDINAL">4</NUMEX> carried out the computional part of
        this study, author <NUMEX TYPE="CARDINAL">3</NUMEX> annotated the <ENAMEX TYPE="ORGANIZATION">Ahab</ENAMEX> results. All
        <ENAMEX TYPE="PER_DESC">authors</ENAMEX> read and approved the final manuscript.
      
      
        Note
        1Randomized sequence was produced by randomly pooling
        and concatenating <NUMEX TYPE="CARDINAL">100</NUMEX> basepair chunks from genomic
        noncoding sequence
      
    
  
